<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Power analysis | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Power analysis | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Power analysis | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2020-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="power-analysis.html"/>
<link rel="next" href="mediation-moderation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a><ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="visualization-1.html"><a href="visualization-1.html#how-not-to-visualize-data"><i class="fa fa-check"></i><b>2.3.1</b> How <em>not</em> to visualize data</a></li>
<li class="chapter" data-level="2.3.2" data-path="visualization-1.html"><a href="visualization-1.html#how-to-make-it-better"><i class="fa fa-check"></i><b>2.3.2</b> How to make it better</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.5</b> Getting help</a></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization-using-ggplot2"><i class="fa fa-check"></i><b>2.6</b> Data visualization using <code>ggplot2</code></a><ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.6.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.6.2</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.6.3</b> Scatter plot</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.6.4</b> Line plot</a></li>
<li class="chapter" data-level="2.6.5" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.6.5</b> Adding error bars</a></li>
<li class="chapter" data-level="2.6.6" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.6.6</b> Grouping data</a></li>
<li class="chapter" data-level="2.6.7" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.6.7</b> Making facets</a></li>
<li class="chapter" data-level="2.6.8" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.6.8</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.7</b> Additional resources</a><ul>
<li class="chapter" data-level="2.7.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.7.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.7.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.7.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.7.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.7.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a><ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a><ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a><ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a><ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a><ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-2"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#install-packages"><i class="fa fa-check"></i><b>4.2</b> Install packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.3</b> Load packages</a></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.4</b> Some R basics</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.4.1</b> Modes</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.4.2</b> Data types</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.4.3</b> Operators</a></li>
<li class="chapter" data-level="4.4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.4.4</b> Control flow</a></li>
<li class="chapter" data-level="4.4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.4.5</b> Functions</a></li>
<li class="chapter" data-level="4.4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.4.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
<li class="chapter" data-level="4.5.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.5.7</b> A quick note on naming things</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a><ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.4</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.5</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.7</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a><ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="4.7.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#misc-2"><i class="fa fa-check"></i><b>4.7.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a><ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-3"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.3</b> Wrangling data (continued)</a><ul>
<li class="chapter" data-level="5.3.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.3.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.3.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.3.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.3.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.3.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.4</b> Reading in data</a><ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.4.1</b> csv</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.4.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.5</b> Saving data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.6</b> Additional resources</a><ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.6.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.6.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.6.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.6.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a><ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#learning-goals-4"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#install-and-load-packages-load-data-set-theme-1"><i class="fa fa-check"></i><b>6.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.3</b> Counting</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.5</b> The random secretary</a></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.6</b> Clue guide to probability</a><ul>
<li class="chapter" data-level="6.6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.6.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.6.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.7</b> Probability operations</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.8</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-networks"><i class="fa fa-check"></i><b>6.9</b> Bayesian networks</a><ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#sprinkler-example"><i class="fa fa-check"></i><b>6.9.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a><ul>
<li class="chapter" data-level="6.10.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.10.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.10.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-3"><i class="fa fa-check"></i><b>6.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a><ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#learning-goals-5"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.3</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.5</b> Computing probabilities</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a><ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#working-with-samples"><i class="fa fa-check"></i><b>7.5</b> Working with samples</a><ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.5.1</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="simulation-1.html"><a href="simulation-1.html#the-quantile-function"><i class="fa fa-check"></i><b>7.5.2</b> The <code>quantile()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#comparing-probability-distributions"><i class="fa fa-check"></i><b>7.6</b> Comparing probability distributions</a></li>
<li class="chapter" data-level="7.7" data-path="simulation-1.html"><a href="simulation-1.html#relationship-between-probability-and-likelihood"><i class="fa fa-check"></i><b>7.7</b> Relationship between probability and likelihood</a></li>
<li class="chapter" data-level="7.8" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.8</b> Additional resources</a><ul>
<li class="chapter" data-level="7.8.1" data-path="simulation-1.html"><a href="simulation-1.html#cheatsheets-5"><i class="fa fa-check"></i><b>7.8.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="7.8.2" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.8.2</b> Datacamp</a></li>
<li class="chapter" data-level="7.8.3" data-path="simulation-1.html"><a href="simulation-1.html#tutorials-1"><i class="fa fa-check"></i><b>7.8.3</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a><ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#learning-goals-6"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>8.3</b> The central limit theorem</a><ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.3.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.3.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.3.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.3.3</b> The sampling distribution</a></li>
<li class="chapter" data-level="8.3.4" data-path="simulation-2.html"><a href="simulation-2.html#exploring-the-clt"><i class="fa fa-check"></i><b>8.3.4</b> Exploring the CLT</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.4</b> Understanding p-values</a><ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.4.1</b> Permutation test</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.6</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a><ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#learning-goals-7"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.3</b> Modeling data</a><ul>
<li class="chapter" data-level="9.3.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.3.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.3.2" data-path="modeling-data.html"><a href="modeling-data.html#error-definitions-and-best-estimators"><i class="fa fa-check"></i><b>9.3.2</b> Error definitions and best estimators</a></li>
<li class="chapter" data-level="9.3.3" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.3.3</b> Sampling distributions for median and mean</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.4</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.5</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6</b> Additional resources</a><ul>
<li class="chapter" data-level="9.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.6.1</b> Reading</a></li>
<li class="chapter" data-level="9.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-1"><i class="fa fa-check"></i><b>9.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-7"><i class="fa fa-check"></i><b>9.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a><ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#learning-goals-8"><i class="fa fa-check"></i><b>10.1</b> Learning goals</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.3</b> Correlation</a></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.4</b> Regression</a><ul>
<li class="chapter" data-level="10.4.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.4.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.4.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.5</b> Credit example</a></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.6</b> Additional resources</a><ul>
<li class="chapter" data-level="10.6.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-2"><i class="fa fa-check"></i><b>10.6.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.6.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-4"><i class="fa fa-check"></i><b>10.6.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-8"><i class="fa fa-check"></i><b>10.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a><ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-9"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a><ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a><ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a><ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a><ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a><ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-3"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-5"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-9"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a><ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-10"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a><ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
<li class="chapter" data-level="12.5.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.5.5</b> Two-way ANOVA (with interaction)</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>12.6</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.7</b> Additional resources</a><ul>
<li class="chapter" data-level="12.7.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-4"><i class="fa fa-check"></i><b>12.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.7.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-6"><i class="fa fa-check"></i><b>12.7.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-10"><i class="fa fa-check"></i><b>12.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a><ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#learning-goals-11"><i class="fa fa-check"></i><b>13.1</b> Learning goals</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.3</b> Load data sets</a></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#planned-contrasts"><i class="fa fa-check"></i><b>13.4</b> Planned contrasts</a><ul>
<li class="chapter" data-level="13.4.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.4.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.4.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.4.2</b> Visualization</a></li>
<li class="chapter" data-level="13.4.3" data-path="linear-model-4.html"><a href="linear-model-4.html#constrasts"><i class="fa fa-check"></i><b>13.4.3</b> Constrasts</a></li>
<li class="chapter" data-level="13.4.4" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.4.4</b> Post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-11"><i class="fa fa-check"></i><b>13.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a></li>
<li class="chapter" data-level="15" data-path="power-analysis-1.html"><a href="power-analysis-1.html"><i class="fa fa-check"></i><b>15</b> Power analysis</a><ul>
<li class="chapter" data-level="15.1" data-path="power-analysis-1.html"><a href="power-analysis-1.html#learning-goals-12"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="power-analysis-1.html"><a href="power-analysis-1.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>15.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.3" data-path="power-analysis-1.html"><a href="power-analysis-1.html#load-data-sets-3"><i class="fa fa-check"></i><b>15.3</b> Load data sets</a></li>
<li class="chapter" data-level="15.4" data-path="power-analysis-1.html"><a href="power-analysis-1.html#decision-making"><i class="fa fa-check"></i><b>15.4</b> Decision-making</a></li>
<li class="chapter" data-level="15.5" data-path="power-analysis-1.html"><a href="power-analysis-1.html#effect-sizes"><i class="fa fa-check"></i><b>15.5</b> Effect sizes</a><ul>
<li class="chapter" data-level="15.5.1" data-path="power-analysis-1.html"><a href="power-analysis-1.html#eta-squared-and-partial-eta-squared"><i class="fa fa-check"></i><b>15.5.1</b> eta-squared and partial eta-squared</a></li>
<li class="chapter" data-level="15.5.2" data-path="power-analysis-1.html"><a href="power-analysis-1.html#cohens-d"><i class="fa fa-check"></i><b>15.5.2</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="power-analysis-1.html"><a href="power-analysis-1.html#determining-sample-size"><i class="fa fa-check"></i><b>15.6</b> Determining sample size</a><ul>
<li class="chapter" data-level="15.6.1" data-path="power-analysis-1.html"><a href="power-analysis-1.html#pwr-package"><i class="fa fa-check"></i><b>15.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="15.6.2" data-path="power-analysis-1.html"><a href="power-analysis-1.html#power-analysis-via-simulation"><i class="fa fa-check"></i><b>15.6.2</b> Power analysis via simulation</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="power-analysis-1.html"><a href="power-analysis-1.html#additional-resources-11"><i class="fa fa-check"></i><b>15.7</b> Additional resources</a><ul>
<li class="chapter" data-level="15.7.1" data-path="power-analysis-1.html"><a href="power-analysis-1.html#datacamp-5"><i class="fa fa-check"></i><b>15.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="15.7.2" data-path="power-analysis-1.html"><a href="power-analysis-1.html#cheatsheets-6"><i class="fa fa-check"></i><b>15.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="15.7.3" data-path="power-analysis-1.html"><a href="power-analysis-1.html#misc-7"><i class="fa fa-check"></i><b>15.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="power-analysis-1.html"><a href="power-analysis-1.html#session-info-12"><i class="fa fa-check"></i><b>15.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="mediation-moderation.html"><a href="mediation-moderation.html"><i class="fa fa-check"></i><b>16</b> Mediation &amp; Moderation</a><ul>
<li class="chapter" data-level="16.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#learning-goals-13"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#recommended-reading"><i class="fa fa-check"></i><b>16.2</b> Recommended reading</a></li>
<li class="chapter" data-level="16.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>16.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#mediation"><i class="fa fa-check"></i><b>16.4</b> Mediation</a><ul>
<li class="chapter" data-level="16.4.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data"><i class="fa fa-check"></i><b>16.4.1</b> Generate data</a></li>
<li class="chapter" data-level="16.4.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>16.4.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="16.4.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>16.4.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="16.4.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>16.4.4</b> Method 3: Bootstrapping</a></li>
<li class="chapter" data-level="16.4.5" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-4-bayesian-approach"><i class="fa fa-check"></i><b>16.4.5</b> Method 4: Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation"><i class="fa fa-check"></i><b>16.5</b> Moderation</a><ul>
<li class="chapter" data-level="16.5.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data-1"><i class="fa fa-check"></i><b>16.5.1</b> Generate data</a></li>
<li class="chapter" data-level="16.5.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation-analysis"><i class="fa fa-check"></i><b>16.5.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="mediation-moderation.html"><a href="mediation-moderation.html#additional-resources-12"><i class="fa fa-check"></i><b>16.6</b> Additional resources</a><ul>
<li class="chapter" data-level="16.6.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#books"><i class="fa fa-check"></i><b>16.6.1</b> Books</a></li>
<li class="chapter" data-level="16.6.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#tutorials-2"><i class="fa fa-check"></i><b>16.6.2</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="mediation-moderation.html"><a href="mediation-moderation.html#session-info-13"><i class="fa fa-check"></i><b>16.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>17</b> Model comparison</a><ul>
<li class="chapter" data-level="17.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-14"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="model-comparison.html"><a href="model-comparison.html#determining-sample-size-1"><i class="fa fa-check"></i><b>17.3</b> Determining sample size</a><ul>
<li class="chapter" data-level="17.3.1" data-path="model-comparison.html"><a href="model-comparison.html#pwr-package-1"><i class="fa fa-check"></i><b>17.3.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="17.3.2" data-path="model-comparison.html"><a href="model-comparison.html#map"><i class="fa fa-check"></i><b>17.3.2</b> <code>map()</code></a></li>
<li class="chapter" data-level="17.3.3" data-path="model-comparison.html"><a href="model-comparison.html#via-simulation"><i class="fa fa-check"></i><b>17.3.3</b> via simulation</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>17.4</b> Model comparison</a><ul>
<li class="chapter" data-level="17.4.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>17.4.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="17.4.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>17.4.2</b> F-test</a></li>
<li class="chapter" data-level="17.4.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>17.4.3</b> Cross-validation</a></li>
<li class="chapter" data-level="17.4.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>17.4.4</b> Bootstrap</a></li>
<li class="chapter" data-level="17.4.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>17.4.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>17.5</b> Additional resources</a><ul>
<li class="chapter" data-level="17.5.1" data-path="model-comparison.html"><a href="model-comparison.html#cheatsheet"><i class="fa fa-check"></i><b>17.5.1</b> Cheatsheet</a></li>
<li class="chapter" data-level="17.5.2" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>17.5.2</b> Datacamp course</a></li>
<li class="chapter" data-level="17.5.3" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>17.5.3</b> Reading</a></li>
<li class="chapter" data-level="17.5.4" data-path="model-comparison.html"><a href="model-comparison.html#misc-8"><i class="fa fa-check"></i><b>17.5.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="model-comparison.html"><a href="model-comparison.html#session-info-14"><i class="fa fa-check"></i><b>17.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 1</a><ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-15"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#things-that-came-up-in-class"><i class="fa fa-check"></i><b>18.3</b> Things that came up in class</a><ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#comparing-t-test-with-f-test-in-lm"><i class="fa fa-check"></i><b>18.3.1</b> Comparing t-test with F-test in <code>lm()</code></a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>18.4</b> Dependence</a></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>18.5</b> Additional resources</a><ul>
<li class="chapter" data-level="18.5.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>18.5.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-15"><i class="fa fa-check"></i><b>18.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 2</a><ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-16"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#things-that-came-up-in-class-1"><i class="fa fa-check"></i><b>19.3</b> Things that came up in class</a><ul>
<li class="chapter" data-level="19.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#difference-between-replicate-and-map"><i class="fa fa-check"></i><b>19.3.1</b> Difference between <code>replicate()</code> and <code>map()</code></a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>19.4</b> Simulating a linear mixed effects model</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>19.5</b> The effect of outliers</a></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>19.6</b> Different slopes</a></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>19.7</b> Simpson’s paradox</a></li>
<li class="chapter" data-level="19.8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>19.8</b> Additional resources</a><ul>
<li class="chapter" data-level="19.8.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>19.8.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-16"><i class="fa fa-check"></i><b>19.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>20</b> Linear mixed effects models 3</a><ul>
<li class="chapter" data-level="20.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-17"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-set"><i class="fa fa-check"></i><b>20.3</b> Load data set</a></li>
<li class="chapter" data-level="20.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#things-that-came-up-in-class-2"><i class="fa fa-check"></i><b>20.4</b> Things that came up in class</a><ul>
<li class="chapter" data-level="20.4.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#one-tailed-vs.-two-tailed-tests"><i class="fa fa-check"></i><b>20.4.1</b> One-tailed vs. two-tailed tests</a></li>
<li class="chapter" data-level="20.4.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixtures-of-participants"><i class="fa fa-check"></i><b>20.4.2</b> Mixtures of participants</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#pooling-and-shrinkage"><i class="fa fa-check"></i><b>20.5</b> Pooling and shrinkage</a><ul>
<li class="chapter" data-level="20.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#complete-pooling"><i class="fa fa-check"></i><b>20.5.1</b> Complete pooling</a></li>
<li class="chapter" data-level="20.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#no-pooling"><i class="fa fa-check"></i><b>20.5.2</b> No pooling</a></li>
<li class="chapter" data-level="20.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#partial-pooling"><i class="fa fa-check"></i><b>20.5.3</b> Partial pooling</a></li>
<li class="chapter" data-level="20.5.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#compare-results"><i class="fa fa-check"></i><b>20.5.4</b> Compare results</a></li>
<li class="chapter" data-level="20.5.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#coefficients"><i class="fa fa-check"></i><b>20.5.5</b> Coefficients</a></li>
<li class="chapter" data-level="20.5.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#shrinkage"><i class="fa fa-check"></i><b>20.5.6</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#bootstrapping"><i class="fa fa-check"></i><b>20.6</b> Bootstrapping</a><ul>
<li class="chapter" data-level="20.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#linear-model"><i class="fa fa-check"></i><b>20.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#getting-p-values"><i class="fa fa-check"></i><b>20.7</b> Getting p-values</a></li>
<li class="chapter" data-level="20.8" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>20.8</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="20.9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-17"><i class="fa fa-check"></i><b>20.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>21</b> Generalized linear model</a><ul>
<li class="chapter" data-level="21.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-18"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set-1"><i class="fa fa-check"></i><b>21.3</b> Load data set</a></li>
<li class="chapter" data-level="21.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>21.4</b> Logistic regression</a><ul>
<li class="chapter" data-level="21.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>21.4.1</b> Interpreting the parameters</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>21.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="21.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>21.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="21.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>21.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="21.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>21.8</b> Additional information</a><ul>
<li class="chapter" data-level="21.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-6"><i class="fa fa-check"></i><b>21.8.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-18"><i class="fa fa-check"></i><b>21.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 1</a><ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#learning-goals-19"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#things-that-came-up"><i class="fa fa-check"></i><b>22.3</b> Things that came up</a><ul>
<li class="chapter" data-level="22.3.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bias-in-cosyne-2019-conference-admission"><i class="fa fa-check"></i><b>22.3.1</b> Bias in Cosyne 2019 conference admission?</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#session-info-19"><i class="fa fa-check"></i><b>22.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 2</a><ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-20"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>23.3</b> Doing Bayesian inference “by hand”</a><ul>
<li class="chapter" data-level="23.3.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>23.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="23.3.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#coin-flip-example"><i class="fa fa-check"></i><b>23.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="23.3.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>23.3.3</b> Bayesian inference by discretization</a></li>
<li class="chapter" data-level="23.3.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-prior"><i class="fa fa-check"></i><b>23.3.4</b> Effect of the prior</a></li>
<li class="chapter" data-level="23.3.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-likelihood"><i class="fa fa-check"></i><b>23.3.5</b> Effect of the likelihood</a></li>
<li class="chapter" data-level="23.3.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-sample-size"><i class="fa fa-check"></i><b>23.3.6</b> Effect of the sample size</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#distributions"><i class="fa fa-check"></i><b>23.4</b> Distributions</a><ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#normal-vs-student-t-distribution"><i class="fa fa-check"></i><b>23.4.1</b> Normal vs Student-t distribution</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#beta-distributions"><i class="fa fa-check"></i><b>23.4.2</b> Beta distributions</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#normal-distributions"><i class="fa fa-check"></i><b>23.4.3</b> Normal distributions</a></li>
<li class="chapter" data-level="23.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#distributions-for-non-negative-parameters"><i class="fa fa-check"></i><b>23.4.4</b> Distributions for non-negative parameters</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#inference-via-sampling"><i class="fa fa-check"></i><b>23.5</b> Inference via sampling</a></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#greta"><i class="fa fa-check"></i><b>23.6</b> Greta</a><ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#attitude-data-set"><i class="fa fa-check"></i><b>23.6.1</b> Attitude data set</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#frequentist-analysis"><i class="fa fa-check"></i><b>23.6.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="23.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#bayesian-regression"><i class="fa fa-check"></i><b>23.6.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-20"><i class="fa fa-check"></i><b>23.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>24</b> Bayesian data analysis 3</a><ul>
<li class="chapter" data-level="24.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-21"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-data-set-2"><i class="fa fa-check"></i><b>24.3</b> Load data set</a></li>
<li class="chapter" data-level="24.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#poker"><i class="fa fa-check"></i><b>24.4</b> Poker</a><ul>
<li class="chapter" data-level="24.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualization-7"><i class="fa fa-check"></i><b>24.4.1</b> Visualization</a></li>
<li class="chapter" data-level="24.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#linear-model-5"><i class="fa fa-check"></i><b>24.4.2</b> Linear model</a></li>
<li class="chapter" data-level="24.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-model"><i class="fa fa-check"></i><b>24.4.3</b> Bayesian model</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>24.5</b> Dealing with heteroscedasticity</a></li>
<li class="chapter" data-level="24.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>24.6</b> Ordinal regression</a></li>
<li class="chapter" data-level="24.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-16"><i class="fa fa-check"></i><b>24.7</b> Additional resources</a></li>
<li class="chapter" data-level="24.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-21"><i class="fa fa-check"></i><b>24.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>25</b> Reporting statistics</a><ul>
<li class="chapter" data-level="25.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>25.1</b> General advice</a><ul>
<li class="chapter" data-level="25.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>25.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="25.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>25.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="25.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>25.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="25.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>25.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="25.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>25.1.5</b> Frequentist statistics</a></li>
<li class="chapter" data-level="25.1.6" data-path="reporting-statistics.html"><a href="reporting-statistics.html#bayesian-statistics"><i class="fa fa-check"></i><b>25.1.6</b> Bayesian statistics –&gt;</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-22"><i class="fa fa-check"></i><b>25.2</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html"><i class="fa fa-check"></i><b>26</b> Cheatsheets</a><ul>
<li class="chapter" data-level="26.1" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#statistics"><i class="fa fa-check"></i><b>26.1</b> Statistics</a></li>
<li class="chapter" data-level="26.2" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#r"><i class="fa fa-check"></i><b>26.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="power-analysis-1" class="section level1">
<h1><span class="header-section-number">Chapter 15</span> Power analysis</h1>
<div id="learning-goals-12" class="section level2">
<h2><span class="header-section-number">15.1</span> Learning goals</h2>
<ul>
<li>Making decisions based on statistical inference.</li>
<li>The concept of statistical power.</li>
<li>Calculating power.</li>
<li>Common effect size measures.</li>
<li>Determining sample size via simulation.
<ul>
<li>Understanding <code>map()</code> and its children.</li>
<li>Understanding <code>nest()</code> and <code>unnest()</code>.</li>
</ul></li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-7" class="section level2">
<h2><span class="header-section-number">15.2</span> Load packages and set plotting theme</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(<span class="st">&quot;knitr&quot;</span>)      <span class="co"># for knitting RMarkdown </span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>) <span class="co"># for making nice tables</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)      <span class="co"># for tidying up model fits</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(<span class="st">&quot;magrittr&quot;</span>)   <span class="co"># for going all in with the pipe</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(<span class="st">&quot;lsr&quot;</span>)        <span class="co"># for computing effect size measures</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(<span class="st">&quot;effectsize&quot;</span>) <span class="co"># for computing effect size measures</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(<span class="st">&quot;pwr&quot;</span>)        <span class="co"># for power calculations</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)  <span class="co"># for wrangling, plotting, etc. </span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">theme_set</span>(<span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="co">#set the theme </span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></a></code></pre></div>
</div>
<div id="load-data-sets-3" class="section level2">
<h2><span class="header-section-number">15.3</span> Load data sets</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">df.poker =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/poker.csv&quot;</span>)</a></code></pre></div>
</div>
<div id="decision-making" class="section level2">
<h2><span class="header-section-number">15.4</span> Decision-making</h2>
<p>Figures to illustrate power:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">mu0 =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb4-2" title="2">mu1 =<span class="st"> </span><span class="dv">18</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co"># mu0 = 8</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># mu1 = 20</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co"># sd0 = 3</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co"># sd1 = 3</span></a>
<a class="sourceLine" id="cb4-7" title="7">sd0 =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb4-8" title="8">sd1 =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb4-9" title="9">alpha =<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co"># alpha = 0.01</span></a>
<a class="sourceLine" id="cb4-11" title="11"></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">30</span>)),</a>
<a class="sourceLine" id="cb4-13" title="13">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</a>
<a class="sourceLine" id="cb4-15" title="15">                <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb4-16" title="16">                <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb4-17" title="17">                <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu0,</a>
<a class="sourceLine" id="cb4-18" title="18">                            <span class="dt">sd =</span> sd0)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</a>
<a class="sourceLine" id="cb4-20" title="20">                <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb4-21" title="21">                <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb4-22" title="22">                <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu1,</a>
<a class="sourceLine" id="cb4-23" title="23">                            <span class="dt">sd =</span> sd1)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-24" title="24"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</a>
<a class="sourceLine" id="cb4-25" title="25">                <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>,</a>
<a class="sourceLine" id="cb4-26" title="26">                <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb4-27" title="27">                <span class="dt">fill =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb4-28" title="28">                <span class="dt">alpha =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb4-29" title="29">                <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu0,</a>
<a class="sourceLine" id="cb4-30" title="30">                            <span class="dt">sd =</span> sd0),</a>
<a class="sourceLine" id="cb4-31" title="31">                <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">mean =</span> mu0, <span class="dt">sd =</span> sd0), <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb4-32" title="32">                ) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</a>
<a class="sourceLine" id="cb4-34" title="34">                <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>,</a>
<a class="sourceLine" id="cb4-35" title="35">                <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb4-36" title="36">                <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb4-37" title="37">                <span class="dt">alpha =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb4-38" title="38">                <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu1,</a>
<a class="sourceLine" id="cb4-39" title="39">                            <span class="dt">sd =</span> sd1),</a>
<a class="sourceLine" id="cb4-40" title="40">                <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">c</span>(<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">mean =</span> mu0, <span class="dt">sd =</span> sd0)))</a>
<a class="sourceLine" id="cb4-41" title="41">                ) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-42" title="42"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">mean =</span> mu0, <span class="dt">sd =</span> sd0),</a>
<a class="sourceLine" id="cb4-43" title="43">             <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-44" title="44"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> F)</a></code></pre></div>
<p><img src="psych252_files/figure-html/power-analysis-05-1.png" width="672" /></p>
</div>
<div id="effect-sizes" class="section level2">
<h2><span class="header-section-number">15.5</span> Effect sizes</h2>
<div id="eta-squared-and-partial-eta-squared" class="section level3">
<h3><span class="header-section-number">15.5.1</span> eta-squared and partial eta-squared</h3>
<p>One-way ANOVA:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">fit =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> balance <span class="op">~</span><span class="st"> </span>hand, </a>
<a class="sourceLine" id="cb5-2" title="2">         <span class="dt">data =</span> df.poker)</a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co"># use function</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw">etaSquared</span>(fit)</a></code></pre></div>
<pre><code>##         eta.sq eta.sq.part
## hand 0.3311076   0.3311076</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># compute by hand </span></a>
<a class="sourceLine" id="cb7-2" title="2">fit <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span>anova <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st">  </span><span class="kw">pull</span>(sumsq) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="st">  </span><span class="kw">divide_by</span>(<span class="kw">sum</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw">extract</span>(<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.3311076</code></pre>
<p>Two-way ANOVA:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">fit =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> balance <span class="op">~</span><span class="st"> </span>hand <span class="op">*</span><span class="st"> </span>skill, </a>
<a class="sourceLine" id="cb9-2" title="2">         <span class="dt">data =</span> df.poker)</a>
<a class="sourceLine" id="cb9-3" title="3"></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co"># use function</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="kw">etaSquared</span>(fit)</a></code></pre></div>
<pre><code>##                 eta.sq eta.sq.part
## hand       0.331107585 0.343119717
## skill      0.005191225 0.008123029
## hand:skill 0.029817351 0.044925866</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># compute by hand </span></a>
<a class="sourceLine" id="cb11-2" title="2">eta_squared =<span class="st"> </span>fit <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">  </span>anova <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="st">  </span><span class="kw">pull</span>(sumsq) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="st">  </span><span class="kw">divide_by</span>(<span class="kw">sum</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw">extract</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-8" title="8"></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co"># compute partial eta squared by hand</span></a>
<a class="sourceLine" id="cb11-10" title="10">eta_partial_squared =<span class="st"> </span>fit <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="st">  </span>anova <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="st">  </span><span class="kw">filter</span>(term <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;hand&quot;</span>,<span class="st">&quot;Residuals&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="st">  </span><span class="kw">select</span>(term, sumsq) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="st">  </span><span class="kw">spread</span>(term, sumsq) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">eta_partial_squared =</span> hand <span class="op">/</span><span class="st"> </span>(hand <span class="op">+</span><span class="st"> </span>Residuals)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="st">  </span><span class="kw">pull</span>(eta_partial_squared)</a></code></pre></div>
</div>
<div id="cohens-d" class="section level3">
<h3><span class="header-section-number">15.5.2</span> Cohen’s d</h3>
<p>Cohen’s <span class="math inline">\(d\)</span> is defined as:</p>
<p><span class="math display">\[
d = \frac{\overline y_1 - \overline y_2}{s_p}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
s_p = \sqrt\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}
\]</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># use function from &quot;lsr&quot; package</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">cohensD</span>(<span class="dt">x =</span> balance <span class="op">~</span><span class="st"> </span>skill,</a>
<a class="sourceLine" id="cb12-3" title="3">        <span class="dt">data =</span> df.poker)</a></code></pre></div>
<pre><code>## [1] 0.1439934</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># compute by hand</span></a>
<a class="sourceLine" id="cb14-2" title="2">df.cohen =<span class="st"> </span>df.poker <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(skill) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(balance),</a>
<a class="sourceLine" id="cb14-5" title="5">            <span class="dt">var =</span> <span class="kw">var</span>(balance),</a>
<a class="sourceLine" id="cb14-6" title="6">            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb14-8" title="8"></a>
<a class="sourceLine" id="cb14-9" title="9">n1 =<span class="st"> </span>df.cohen<span class="op">$</span>n[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb14-10" title="10">n2 =<span class="st"> </span>df.cohen<span class="op">$</span>n[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb14-11" title="11">var1 =<span class="st"> </span>df.cohen<span class="op">$</span>var[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb14-12" title="12">var2 =<span class="st"> </span>df.cohen<span class="op">$</span>var[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb14-13" title="13">mean1 =<span class="st"> </span>df.cohen<span class="op">$</span>mean[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb14-14" title="14">mean2 =<span class="st"> </span>df.cohen<span class="op">$</span>mean[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb14-15" title="15"></a>
<a class="sourceLine" id="cb14-16" title="16">sp =<span class="st"> </span><span class="kw">sqrt</span>(((n1 <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>var1 <span class="op">+</span><span class="st"> </span>(n2 <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>var2) <span class="op">/</span><span class="st"> </span>(n1 <span class="op">+</span><span class="st"> </span>n2 <span class="op">-</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb14-17" title="17"></a>
<a class="sourceLine" id="cb14-18" title="18">d =<span class="st"> </span><span class="kw">abs</span>(mean1 <span class="op">-</span><span class="st"> </span>mean2) <span class="op">/</span><span class="st"> </span>sp</a>
<a class="sourceLine" id="cb14-19" title="19"><span class="kw">print</span>(d)</a></code></pre></div>
<pre><code>## [1] 0.1439934</code></pre>
</div>
</div>
<div id="determining-sample-size" class="section level2">
<h2><span class="header-section-number">15.6</span> Determining sample size</h2>
<p>One way to deterime sample size is by using the <code>pwr</code> package. While this packages is very convenient, we cannot compute power for all the hypotheses that we might be interested in testing.</p>
<div id="pwr-package" class="section level3">
<h3><span class="header-section-number">15.6.1</span> <code>pwr</code> package</h3>
<p>The <code>pwr</code> package has a number of functions that we can use do determine the desired sample size for different experimental designs. Check out this vignette <a href="https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html">here</a> for more information.</p>
<div id="binomial-test" class="section level4">
<h4><span class="header-section-number">15.6.1.1</span> Binomial test</h4>
<p>We can determine what sample size we need for a Binomal test that compares two different proportions like so:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">pwr.p.test</span>(<span class="dt">h =</span> <span class="kw">ES.h</span>(<span class="dt">p1 =</span> <span class="fl">0.75</span>, <span class="dt">p2 =</span> <span class="fl">0.50</span>), </a>
<a class="sourceLine" id="cb16-2" title="2">           <span class="dt">sig.level =</span> <span class="fl">0.05</span>, </a>
<a class="sourceLine" id="cb16-3" title="3">           <span class="dt">power =</span> <span class="fl">0.80</span>, </a>
<a class="sourceLine" id="cb16-4" title="4">           <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)</a></code></pre></div>
<pre><code>## 
##      proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.5235988
##               n = 22.55126
##       sig.level = 0.05
##           power = 0.8
##     alternative = greater</code></pre>
<p>The <code>pwr.p.test()</code> function wants the effect size h as an argument which we can compute via the <code>ES.h()</code> function that takes two proportions as arguments. I then further defined the desired significance level, power, and whether the test is one-sided or two-sided.</p>
<p>To have an 80% chance of detecting a difference between a proportion of <code>p1 = 0.75</code> and <code>p2 = 0.50</code>, we would need to run a study with 23 participants.</p>
<p>We can use the <code>plot()</code> function to illustrate what power we would get for different sample sizes.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">pwr.p.test</span>(<span class="dt">h =</span> <span class="kw">ES.h</span>(<span class="dt">p1 =</span> <span class="fl">0.75</span>, <span class="dt">p2 =</span> <span class="fl">0.50</span>), </a>
<a class="sourceLine" id="cb18-2" title="2">           <span class="dt">sig.level =</span> <span class="fl">0.05</span>, </a>
<a class="sourceLine" id="cb18-3" title="3">           <span class="dt">power =</span> <span class="fl">0.80</span>, </a>
<a class="sourceLine" id="cb18-4" title="4">           <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/power-analysis-10-1.png" width="672" /></p>
<p>Notice that this is a ggplot object, so we could tweak it further if we’d like to, like so:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">pwr.p.test</span>(<span class="dt">h =</span> <span class="kw">ES.h</span>(<span class="dt">p1 =</span> <span class="fl">0.75</span>, <span class="dt">p2 =</span> <span class="fl">0.50</span>), </a>
<a class="sourceLine" id="cb19-2" title="2">           <span class="dt">sig.level =</span> <span class="fl">0.05</span>, </a>
<a class="sourceLine" id="cb19-3" title="3">           <span class="dt">power =</span> <span class="fl">0.80</span>, </a>
<a class="sourceLine" id="cb19-4" title="4">           <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="st">  </span><span class="kw">plot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb19-7" title="7">             <span class="dt">linetype =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb19-8" title="8">             <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>))</a></code></pre></div>
<p><img src="psych252_files/figure-html/power-analysis-11-1.png" width="672" /></p>
</div>
<div id="t-test-two-independent-samples" class="section level4">
<h4><span class="header-section-number">15.6.1.2</span> t-test (two independent samples)</h4>
<p>Here is how we could calculate the desired sample size for a t-test with two independent samples.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">0.3</span>,</a>
<a class="sourceLine" id="cb20-2" title="2">           <span class="dt">power =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb20-3" title="3">           <span class="dt">type =</span> <span class="st">&quot;two.sample&quot;</span>,</a>
<a class="sourceLine" id="cb20-4" title="4">           <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</a></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 175.3847
##               d = 0.3
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
<p>So, to achieve a power of 0.8 for an effect size of d = 0.3, we would need to have 176 participants in each condition!</p>
</div>
</div>
<div id="power-analysis-via-simulation" class="section level3">
<h3><span class="header-section-number">15.6.2</span> Power analysis via simulation</h3>
<p>While the <code>pwr</code> package works great for relatively simple designs, it quickly reaches its limits. For example, you may be interested in the sample size required to achieve adequate power for detecting an interaction, or for a specific linear contrast.</p>
<p>Luckily, there is a very flexible approach to determining sample size: via simulation!</p>
<div id="the-general-recipe" class="section level4">
<h4><span class="header-section-number">15.6.2.1</span> The general recipe</h4>
<ul>
<li>assume: significance level, n, effect size</li>
<li>simulate a large number of data sets of size n with the specified effect size</li>
<li>for each data set, run a statistical test to calculate the p-value</li>
<li>determine the probability of rejecting the H0 (given that H1 is true)</li>
</ul>
</div>
<div id="understanding-map" class="section level4">
<h4><span class="header-section-number">15.6.2.2</span> Understanding <code>map()</code></h4>
<p><code>map()</code> is a powerful family of functions that’s part of the <code>purrr</code> package (which is included in the <code>tidyverse</code>, so we don’t have to load it separately). Using <code>map()</code> allows us to avoid nasty for-loops!</p>
<p>Let’s take a look at the help function.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">help</span>(map)</a></code></pre></div>
<p>As the help function says, <code>map()</code> allows us to apply a function to each element of a vector. Here is a simple example:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">map</span>(<span class="dt">.x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>.x<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 4
## 
## [[3]]
## [1] 9</code></pre>
<p>I’ve passed the vector of numbers <code>.x = 1:3</code> to <code>map()</code>, and then applied the anonymous function <code>.f = ~ .x^2</code> to each of the elements in that vector.</p>
<blockquote>
<p>Always make sure to use the <code>~</code> for defining anonymous functions!</p>
</blockquote>
<p>As with many R functions, you can achieve the same outcome in many different ways. Here are a number of ways to do the same thing:</p>
<pre><code>## [1] &quot;Is tmp1 identical to tmp2? TRUE&quot;</code></pre>
<pre><code>## [1] &quot;Is tmp2 identical to tmp3? TRUE&quot;</code></pre>
<div id="understanding-maps-children" class="section level5">
<h5><span class="header-section-number">15.6.2.2.1</span> Understanding <code>map()</code>’s children</h5>
<p>Notice that the output of <code>map()</code> is a list.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">map</span>(<span class="dt">.x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>.x<span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">  </span><span class="kw">str</span>()</a></code></pre></div>
<pre><code>## List of 3
##  $ : num 1
##  $ : num 4
##  $ : num 9</code></pre>
<p>The <code>map()</code> function has many children that differ in what they output. For example, <code>map_dbl()</code> outputs a numeric vector instead of a list.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">map_dbl</span>(<span class="dt">.x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>.x<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 1 4 9</code></pre>
<p>And <code>map_lgl()</code> returns logical values.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">map_lgl</span>(<span class="dt">.x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span>.x <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1]  TRUE FALSE FALSE</code></pre>
<p>We can also return data frames by using either <code>map_dfr()</code> which binds data frames by row, or <code>map_dfc()</code> which binds data frames by column. Here is an example:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-2" title="2"></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="co"># function to create a data frame </span></a>
<a class="sourceLine" id="cb33-4" title="4">fun_make_df =<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb33-5" title="5">  <span class="kw">tibble</span>(<span class="dt">number =</span> x,</a>
<a class="sourceLine" id="cb33-6" title="6">         <span class="dt">group =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</a>
<a class="sourceLine" id="cb33-7" title="7">                        <span class="dt">size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb33-8" title="8">                        <span class="dt">replace =</span> T),</a>
<a class="sourceLine" id="cb33-9" title="9">         <span class="dt">value =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb33-10" title="10">}</a>
<a class="sourceLine" id="cb33-11" title="11"></a>
<a class="sourceLine" id="cb33-12" title="12"><span class="co"># bind data frames by row </span></a>
<a class="sourceLine" id="cb33-13" title="13"><span class="kw">map_dfr</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="op">~</span><span class="st"> </span><span class="kw">fun_make_df</span>(.))</a></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   number group  value
##    &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
## 1      1 A      1.33 
## 2      1 B      1.27 
## 3      1 A      0.415
## 4      2 B      0.487
## 5      2 A      0.738
## 6      2 A      0.576
## 7      3 B     -0.799
## 8      3 A     -1.15 
## 9      3 A     -0.289</code></pre>
<p>A nice use-case of the <code>map_dfr()</code> function can be to read in a number of csv files from individual participants into one larger data frame. Let’s simulate some data first, and save the data of each participant as a separate csv file (using <code>map()</code> of course).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb35-2" title="2"></a>
<a class="sourceLine" id="cb35-3" title="3">fun_simulate_csv =<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb35-4" title="4">  n_observations =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb35-5" title="5">  df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">age =</span> <span class="kw">sample</span>(<span class="dv">18</span><span class="op">:</span><span class="dv">99</span>, <span class="dt">size =</span> n_observations),</a>
<a class="sourceLine" id="cb35-6" title="6">              <span class="dt">responses =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n_observations, <span class="dt">mean =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb35-7" title="7">  <span class="kw">write_csv</span>(df, <span class="dt">path =</span> <span class="kw">str_c</span>(<span class="st">&quot;data/participant&quot;</span>, x, <span class="st">&quot;.csv&quot;</span>))</a>
<a class="sourceLine" id="cb35-8" title="8">}</a>
<a class="sourceLine" id="cb35-9" title="9"></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="kw">map</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, fun_simulate_csv)</a></code></pre></div>
<pre><code>## [[1]]
## # A tibble: 3 x 2
##     age responses
##   &lt;int&gt;     &lt;dbl&gt;
## 1    85      91.6
## 2    56     116. 
## 3    18     103. 
## 
## [[2]]
## # A tibble: 5 x 2
##     age responses
##   &lt;int&gt;     &lt;dbl&gt;
## 1    68     115. 
## 2    38     104. 
## 3    71      93.8
## 4    91      77.9
## 5    24     111. 
## 
## [[3]]
## # A tibble: 4 x 2
##     age responses
##   &lt;int&gt;     &lt;dbl&gt;
## 1    61      106.
## 2    96      109.
## 3    50      108.
## 4    52      101.</code></pre>
<p>Now, let’s read in the data from the three participants and combine it into a single data frame.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">map_dfr</span>(<span class="dt">.x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="op">~</span><span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">str_c</span>(<span class="st">&quot;data/participant&quot;</span>, .x, <span class="st">&quot;.csv&quot;</span>)))</a></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##      age responses
##    &lt;dbl&gt;     &lt;dbl&gt;
##  1    85      91.6
##  2    56     116. 
##  3    18     103. 
##  4    68     115. 
##  5    38     104. 
##  6    71      93.8
##  7    91      77.9
##  8    24     111. 
##  9    61     106. 
## 10    96     109. 
## 11    50     108. 
## 12    52     101.</code></pre>
<p>One problem is that I now don’t know which data is coming from which participant. <code>mutate()</code> comes to our rescue here:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">map_dfr</span>(<span class="dt">.x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb39-2" title="2">        <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">str_c</span>(<span class="st">&quot;data/participant&quot;</span>, .x, <span class="st">&quot;.csv&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="st">            </span><span class="kw">mutate</span>(<span class="dt">participant =</span> .x)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="st">  </span><span class="kw">select</span>(participant, age, responses)</a></code></pre></div>
<pre><code>## # A tibble: 12 x 3
##    participant   age responses
##          &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1           1    85      91.6
##  2           1    56     116. 
##  3           1    18     103. 
##  4           2    68     115. 
##  5           2    38     104. 
##  6           2    71      93.8
##  7           2    91      77.9
##  8           2    24     111. 
##  9           3    61     106. 
## 10           3    96     109. 
## 11           3    50     108. 
## 12           3    52     101.</code></pre>
<p>Another neat way to achieve the same thing (same same but different) is to use the <code>.id</code> argument of the <code>map_dfr()</code> function.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">map_dfr</span>(<span class="dt">.x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb41-2" title="2">        <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">str_c</span>(<span class="st">&quot;data/participant&quot;</span>, .x, <span class="st">&quot;.csv&quot;</span>)),</a>
<a class="sourceLine" id="cb41-3" title="3">        <span class="dt">.id =</span> <span class="st">&quot;participant&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="st">  </span><span class="kw">select</span>(participant, age, responses)</a></code></pre></div>
<pre><code>## # A tibble: 12 x 3
##    participant   age responses
##    &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
##  1 1              85      91.6
##  2 1              56     116. 
##  3 1              18     103. 
##  4 2              68     115. 
##  5 2              38     104. 
##  6 2              71      93.8
##  7 2              91      77.9
##  8 2              24     111. 
##  9 3              61     106. 
## 10 3              96     109. 
## 11 3              50     108. 
## 12 3              52     101.</code></pre>
</div>
<div id="use-map2-for-functions-with-more-than-one-input" class="section level5">
<h5><span class="header-section-number">15.6.2.2.2</span> Use <code>map2()</code> for functions with more than one input</h5>
<p>If you have a function with more than one input, <code>map2()</code> is your friend. Here is a silly example:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">map2_dbl</span>(<span class="dt">.x =</span> <span class="kw">c</span>(<span class="fl">1.23</span>, <span class="fl">2.13</span>, <span class="fl">5.32</span>),</a>
<a class="sourceLine" id="cb43-2" title="2">         <span class="dt">.y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb43-3" title="3">         <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="kw">round</span>(.x, <span class="dt">digits =</span> .y))</a></code></pre></div>
<pre><code>## [1] 1.00 2.10 5.32</code></pre>
<p>Here, I took the vector of numbers <code>.x</code> and rounded it to a different number of digits according to what I’ve specified it <code>.y</code>.
The same works with data frames, too, like so:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="fl">1.23</span>, <span class="fl">2.13</span>, <span class="fl">5.32</span>),</a>
<a class="sourceLine" id="cb45-2" title="2">       <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rounded =</span> <span class="kw">map2_dbl</span>(<span class="dt">.x =</span> x,</a>
<a class="sourceLine" id="cb45-4" title="4">                            <span class="dt">.y =</span> n,</a>
<a class="sourceLine" id="cb45-5" title="5">                            <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="kw">round</span>(.x, <span class="dt">digits =</span> .y)))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##       x     n rounded
##   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1  1.23     0    1   
## 2  2.13     1    2.1 
## 3  5.32     2    5.32</code></pre>
</div>
<div id="use-pmap-to-go-all-out-i.e.-for-functions-with-more-than-two-arguments" class="section level5">
<h5><span class="header-section-number">15.6.2.2.3</span> Use pmap() to go all out (i.e. for functions with more than two arguments)</h5>
<p><code>pmap()</code> is your friend for functions that have more than two arguments. Here is an example:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb47-2" title="2">       <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">12</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb47-3" title="3">       <span class="dt">z =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">result =</span> <span class="kw">pmap_dbl</span>(<span class="dt">.l =</span> ., <span class="op">~</span><span class="st"> </span>..<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>..<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>..<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##       x     y     z result
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1     1    23     4     27
## 2     2    12     5     29
## 3     3     1     4      7</code></pre>
<p>Notice than when using more than two arguments, we refer to each function argument with ..1, ..2, ..3, etc.</p>
</div>
<div id="practice-1-having-fun-with-map" class="section level5">
<h5><span class="header-section-number">15.6.2.2.4</span> Practice 1 – Having fun with <code>map()</code></h5>
<p>Use the <code>map2_dbl()</code> function to create a new variable in this data frame that’s the maximum of each row across columns <code>a</code> and <code>b</code>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">a =</span> <span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">52</span>, <span class="dv">23</span>, <span class="dv">23</span>),</a>
<a class="sourceLine" id="cb49-2" title="2">            <span class="dt">b =</span> <span class="kw">c</span>(<span class="dv">29</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">48</span>, <span class="dv">37</span>))</a>
<a class="sourceLine" id="cb49-3" title="3"><span class="co"># write your code here </span></a></code></pre></div>
<p>For the fast ones: For each row in the data frame, write a function that calculates the mean of columns <code>a</code> and <code>b</code>, and the rounds to the number of digits specified in column <code>d</code>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">a =</span> <span class="kw">c</span>(<span class="fl">12.123</span>, <span class="fl">53.234</span>, <span class="fl">23.324</span>, <span class="fl">54.232</span>, <span class="fl">12.454</span>),</a>
<a class="sourceLine" id="cb50-2" title="2">            <span class="dt">b =</span> <span class="kw">c</span>(<span class="fl">12.456</span>, <span class="fl">23.234</span>, <span class="fl">6.736</span>, <span class="fl">3.346</span>, <span class="fl">7.232</span>),</a>
<a class="sourceLine" id="cb50-3" title="3">            <span class="dt">d =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb50-4" title="4"><span class="co"># write your code here</span></a></code></pre></div>
</div>
</div>
<div id="list-columns" class="section level4">
<h4><span class="header-section-number">15.6.2.3</span> List columns</h4>
<p><code>map()</code> becomes particularly powerful when combined with list columns. List columns allow you to put data frames into a column of your data frame. For example, you can do something like this:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">participant =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb51-2" title="2">            <span class="dt">age =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb51-3" title="3">            <span class="dt">data =</span> <span class="kw">list</span>(<span class="kw">tibble</span>(<span class="dt">trial =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb51-4" title="4">                               <span class="dt">response =</span> <span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">95</span>, <span class="dv">37</span>))))</a>
<a class="sourceLine" id="cb51-5" title="5"></a>
<a class="sourceLine" id="cb51-6" title="6"><span class="kw">print</span>(df)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   participant   age data            
##         &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;          
## 1           1    23 &lt;tibble [3 × 2]&gt;</code></pre>
<p>We could access what’s in this data column like so</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">df<span class="op">$</span>data[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   trial response
##   &lt;dbl&gt;    &lt;dbl&gt;
## 1     1       23
## 2     2       95
## 3     3       37</code></pre>
<div id="unnest" class="section level5">
<h5><span class="header-section-number">15.6.2.3.1</span> <code>unnest()</code></h5>
<p>For getting data frames out of list columns, we can use the <code>unnest()</code> function.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="st">  </span><span class="kw">unnest</span>(<span class="dt">cols =</span> data)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   participant   age trial response
##         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
## 1           1    23     1       23
## 2           1    23     2       95
## 3           1    23     3       37</code></pre>
<p>Notice how the data frame from the list column</p>
</div>
<div id="nest" class="section level5">
<h5><span class="header-section-number">15.6.2.3.2</span> <code>nest()</code></h5>
<p>We can use the <code>nest()</code> function to create list columns. <code>nest()</code> works particularly well in combination with <code>group_by()</code>. For example, here I’m created three separate data sets where the size of each data set is determined by the <code>x</code> column.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co"># original data frame </span></a>
<a class="sourceLine" id="cb57-2" title="2">df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb57-3" title="3">            <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,</a>
<a class="sourceLine" id="cb57-4" title="4">            <span class="dt">z =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb57-5" title="5"><span class="kw">print</span>(df)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##       x     y     z
##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt;
## 1     1     1     6
## 2     1     2     5
## 3     1     3     4
## 4     2     4     3
## 5     2     5     2
## 6     3     6     1</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co"># nested data frame </span></a>
<a class="sourceLine" id="cb59-2" title="2">df =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(x) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="st">  </span><span class="kw">nest</span>()</a>
<a class="sourceLine" id="cb59-5" title="5"><span class="kw">print</span>(df)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
## # Groups:   x [3]
##       x data            
##   &lt;dbl&gt; &lt;list&gt;          
## 1     1 &lt;tibble [3 × 2]&gt;
## 2     2 &lt;tibble [2 × 2]&gt;
## 3     3 &lt;tibble [1 × 2]&gt;</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># and back to the original data frame  </span></a>
<a class="sourceLine" id="cb61-2" title="2">df =<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-3" title="3"><span class="st">  </span><span class="kw">unnest</span>(<span class="dt">cols =</span> data)</a>
<a class="sourceLine" id="cb61-4" title="4"><span class="kw">print</span>(df)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
## # Groups:   x [3]
##       x     y     z
##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt;
## 1     1     1     6
## 2     1     2     5
## 3     1     3     4
## 4     2     4     3
## 5     2     5     2
## 6     3     6     1</code></pre>
<p>And, of course, I can use unnest() to get back to my original data frame.</p>
</div>
</div>
<div id="combining-nest-and-map" class="section level4">
<h4><span class="header-section-number">15.6.2.4</span> Combining <code>nest()</code> and <code>map()</code></h4>
<p><code>nest()</code> and <code>map()</code> unfold their power together when it comes to fitting models. For example, consider that you want to fit a separate linear to subests of your data. Here is how you can do that using <code>nest()</code> and <code>map()</code>.</p>
<p>I’ll demonstrate via the infamous <code>mtcars</code> data set that comes with R.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>)</a></code></pre></div>
<pre><code>##                    mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Duster 360        14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Merc 240D         24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Merc 230          22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Merc 280          19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4</code></pre>
<p>What I want to do is to fit separate regression models predicting <code>mpg</code> (miles per gallon) as a function of <code>wt</code> (the car’s weight) for cars with different numbers of cylinders. Here is how that works.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(cyl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-3" title="3"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>wt, <span class="dt">data =</span> .x)))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
## # Groups:   cyl [3]
##     cyl data               fit   
##   &lt;dbl&gt; &lt;list&gt;             &lt;list&gt;
## 1     6 &lt;tibble [7 × 10]&gt;  &lt;lm&gt;  
## 2     4 &lt;tibble [11 × 10]&gt; &lt;lm&gt;  
## 3     8 &lt;tibble [14 × 10]&gt; &lt;lm&gt;</code></pre>
<p>I first grouped by the <code>cyl</code> (the number of cylinders), used <code>nest()</code> to put the rest of the data into a list column, and then used <code>mutate()</code> to run a separate linear model on each data set and saved the modle result into the <code>fit</code> column.</p>
<p>With some more wrangling, I could, for example, extract the coefficients of each model like so:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(cyl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-3" title="3"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>wt, <span class="dt">data =</span> .x)),</a>
<a class="sourceLine" id="cb67-5" title="5">         <span class="dt">coef =</span> <span class="kw">map</span>(fit, tidy)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-6" title="6"><span class="st">  </span><span class="kw">unnest</span>(<span class="dt">cols =</span> coef) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-7" title="7"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(data, fit))</a></code></pre></div>
<pre><code>## # A tibble: 6 x 6
## # Groups:   cyl [3]
##     cyl term        estimate std.error statistic    p.value
##   &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1     6 (Intercept)    28.4      4.18       6.79 0.00105   
## 2     6 wt             -2.78     1.33      -2.08 0.0918    
## 3     4 (Intercept)    39.6      4.35       9.10 0.00000777
## 4     4 wt             -5.65     1.85      -3.05 0.0137    
## 5     8 (Intercept)    23.9      3.01       7.94 0.00000405
## 6     8 wt             -2.19     0.739     -2.97 0.0118</code></pre>
<p>Voila! A data frame that contains the coefficients for each of the three models.</p>
<p>Base R has a number of functions like <code>apply()</code>, <code>sapply()</code>, <code>lapply()</code>, etc. that do similar things to <code>map()</code>. However, the <code>map()</code> family of functions works very well with the rest of the <code>tidyverse</code>, that’s why we’ll use it.</p>
<div id="practice-2-mapping-out-the-nest" class="section level5">
<h5><span class="header-section-number">15.6.2.4.1</span> Practice 2 – <code>map()</code>ping out the <code>nest()</code></h5>
<p>In the <code>mtcars</code> data set, run separate linear models with <code>cyl</code> (number of cylinders) and <code>am</code> (whether the car has automatic or manual transmission) as predictors (including their interaction), and <code>mpg</code> (miles per galon), and <code>hp</code> (horse power) as dependent variables. Create a data frame that contains one column with the names of the dependent variables, one column with the names of the predictors, and one column with the p-value for each predictor.</p>
<p>Here is the general strategy for how to go about this:</p>
<ul>
<li>Make a data frame that only contains the dependent variables.</li>
<li>Pass that data frame as a first argument to the <code>map()</code> function.</li>
<li>The second argument in the <code>map()</code> function (the formula <code>f. =</code>) should be a linear model (<code>lm()</code>) for which you should use <code>.x</code> as the dependent variable (this will )</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co"># write your code here </span></a></code></pre></div>
</div>
</div>
<div id="power-analysis-via-simulation-1" class="section level4">
<h4><span class="header-section-number">15.6.2.5</span> Power analysis via simulation</h4>
<p>So, after this long detour via <code>map()</code>, list columns, <code>nest()</code>, and <code>unnest()</code>, we can finally start doing some power analysis via simulation, yay!</p>
<div id="simulating-the-binomial-test" class="section level5">
<h5><span class="header-section-number">15.6.2.5.1</span> Simulating the Binomial test</h5>
<p>Let’s start with the Binomial test that we played around with above. We want to use simulation to determine the sample size we need to have an 80% of detecting a difference between two proportions p = 0.75 and p = 0.5.</p>
<p>Here is how we would go about this. First, I’ll set up a simulation grid.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co"># make reproducible </span></a>
<a class="sourceLine" id="cb70-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb70-3" title="3"></a>
<a class="sourceLine" id="cb70-4" title="4"><span class="co"># number of simulations</span></a>
<a class="sourceLine" id="cb70-5" title="5">n_simulations =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb70-6" title="6"></a>
<a class="sourceLine" id="cb70-7" title="7"><span class="co"># set up simulation grid </span></a>
<a class="sourceLine" id="cb70-8" title="8">df.power =<span class="st"> </span><span class="kw">crossing</span>(<span class="dt">n =</span> <span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb70-9" title="9">                    <span class="dt">simulation =</span> <span class="dv">1</span><span class="op">:</span>n_simulations,</a>
<a class="sourceLine" id="cb70-10" title="10">                    <span class="dt">p =</span> <span class="fl">0.75</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">index =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="co"># add an index column</span></a>
<a class="sourceLine" id="cb70-12" title="12"></a>
<a class="sourceLine" id="cb70-13" title="13">df.power</a></code></pre></div>
<pre><code>## # A tibble: 160 x 4
##        n simulation     p index
##    &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
##  1    10          1  0.75     1
##  2    10          2  0.75     2
##  3    10          3  0.75     3
##  4    10          4  0.75     4
##  5    10          5  0.75     5
##  6    10          6  0.75     6
##  7    10          7  0.75     7
##  8    10          8  0.75     8
##  9    10          9  0.75     9
## 10    10         10  0.75    10
## # … with 150 more rows</code></pre>
<p>The <code>crossing()</code> function creates a data frame that contains all the combinations of the variables.</p>
<p>Now, let’s generate data according to our hypothesis.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">df.power =<span class="st"> </span>df.power <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(index, n, simulation) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb72-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">response =</span> <span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dt">size =</span> n, <span class="dt">prob =</span> p))</a>
<a class="sourceLine" id="cb72-4" title="4"></a>
<a class="sourceLine" id="cb72-5" title="5">df.power</a></code></pre></div>
<pre><code>## # A tibble: 160 x 5
## # Groups:   index, n, simulation [160]
##        n simulation     p index response
##    &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt; &lt;int&gt;    &lt;int&gt;
##  1    10          1  0.75     1        8
##  2    10          2  0.75     2        8
##  3    10          3  0.75     3        7
##  4    10          4  0.75     4        6
##  5    10          5  0.75     5        9
##  6    10          6  0.75     6        6
##  7    10          7  0.75     7        5
##  8    10          8  0.75     8        7
##  9    10          9  0.75     9        7
## 10    10         10  0.75    10        9
## # … with 150 more rows</code></pre>
<p>The <code>response</code> variable now contains samples from the sample size <code>n</code> according to the probability specified in <code>p</code>. Now it’s time for <code>group_by()</code> and <code>nest()</code> because we want to calculate the p-value for observing this reponse if in fact the null hypothesis was true (i.e. p = 0.5).</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">df.power =<span class="st"> </span>df.power <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># generate random data</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(index, simulation, p) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-3" title="3"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># put data in list column</span></a>
<a class="sourceLine" id="cb74-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(data, </a>
<a class="sourceLine" id="cb74-5" title="5">                   <span class="op">~</span><span class="st"> </span><span class="kw">binom.test</span>(<span class="dt">x =</span> .<span class="op">$</span>response, <span class="co"># define formula</span></a>
<a class="sourceLine" id="cb74-6" title="6">                          <span class="dt">n =</span> .<span class="op">$</span>n,</a>
<a class="sourceLine" id="cb74-7" title="7">                          <span class="dt">p =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb74-8" title="8">                          <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)))</a>
<a class="sourceLine" id="cb74-9" title="9">df.power</a></code></pre></div>
<pre><code>## # A tibble: 160 x 5
## # Groups:   simulation, p, index [160]
##    simulation     p index data             fit    
##         &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;list&gt;           &lt;list&gt; 
##  1          1  0.75     1 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
##  2          2  0.75     2 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
##  3          3  0.75     3 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
##  4          4  0.75     4 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
##  5          5  0.75     5 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
##  6          6  0.75     6 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
##  7          7  0.75     7 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
##  8          8  0.75     8 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
##  9          9  0.75     9 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
## 10         10  0.75    10 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
## # … with 150 more rows</code></pre>
<p>Now that we’ve fitted a bunch of binomial models, we only need to get at the p-values. Again, we can use the <code>tidy()</code> function from the <code>broom</code> package for help, like so:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">df.power =<span class="st"> </span>df.power <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">coef =</span> <span class="kw">map</span>(fit, tidy)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="st">  </span><span class="kw">select</span>(simulation, p, index, coef) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-4" title="4"><span class="st">  </span><span class="kw">unnest</span>(<span class="dt">cols =</span> coef) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-5" title="5"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">n =</span> parameter)</a>
<a class="sourceLine" id="cb76-6" title="6">df.power</a></code></pre></div>
<pre><code>## # A tibble: 160 x 11
## # Groups:   simulation, p, index [160]
##    simulation     p index estimate statistic p.value     n conf.low conf.high
##         &lt;int&gt; &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
##  1          1  0.75     1      0.8         8  0.109     10    0.444     0.975
##  2          2  0.75     2      0.8         8  0.109     10    0.444     0.975
##  3          3  0.75     3      0.7         7  0.344     10    0.348     0.933
##  4          4  0.75     4      0.6         6  0.754     10    0.262     0.878
##  5          5  0.75     5      0.9         9  0.0215    10    0.555     0.997
##  6          6  0.75     6      0.6         6  0.754     10    0.262     0.878
##  7          7  0.75     7      0.5         5  1         10    0.187     0.813
##  8          8  0.75     8      0.7         7  0.344     10    0.348     0.933
##  9          9  0.75     9      0.7         7  0.344     10    0.348     0.933
## 10         10  0.75    10      0.9         9  0.0215    10    0.555     0.997
## # … with 150 more rows, and 2 more variables: method &lt;chr&gt;, alternative &lt;chr&gt;</code></pre>
<p>Finally, all that’s left is to calculate power by looking at the proportion of times in which we rejected the null hypothesis.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">df.power <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">power =</span> <span class="kw">sum</span>(p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</a></code></pre></div>
<pre><code>## # A tibble: 16 x 2
##        n power
##    &lt;dbl&gt; &lt;dbl&gt;
##  1    10   0.2
##  2    12   0.4
##  3    14   0.4
##  4    16   0.2
##  5    18   0.2
##  6    20   0.8
##  7    22   0.6
##  8    24   0.5
##  9    26   0.7
## 10    28   0.6
## 11    30   0.8
## 12    32   0.9
## 13    34   0.9
## 14    36   0.8
## 15    38   1  
## 16    40   1</code></pre>
<p>Notice here that the power values fluctuate quite a bit. This is because we only ran 10 simulations for each sample size. To have more robust results, we need to increase the number of simulations.</p>
<p>But first, let’s make a plot that visualizes what we found:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">df.plot =<span class="st"> </span>df.power <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb80-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">power =</span> <span class="kw">sum</span>(p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb80-4" title="4"></a>
<a class="sourceLine" id="cb80-5" title="5"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.plot, </a>
<a class="sourceLine" id="cb80-6" title="6">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> power)) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-7" title="7"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb80-8" title="8">             <span class="dt">linetype =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb80-9" title="9">             <span class="dt">color =</span> <span class="st">&quot;gray50&quot;</span>,</a>
<a class="sourceLine" id="cb80-10" title="10">             <span class="dt">size =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb80-11" title="11"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb80-12" title="12"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/power-analysis-42-1.png" width="672" /></p>
<p>As expected, the power increases with the sample size n. </p>
<p>Now let’s run the same simulation again, with a larger sample size, and also for two different alternative hypotheses: p1 = 0.75, and p2 = 0.9.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co"># make reproducible </span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb82-3" title="3"></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="co"># number of simulations</span></a>
<a class="sourceLine" id="cb82-5" title="5">n_simulations =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb82-6" title="6"></a>
<a class="sourceLine" id="cb82-7" title="7"><span class="co"># run simulation </span></a>
<a class="sourceLine" id="cb82-8" title="8">df.power =<span class="st"> </span><span class="kw">crossing</span>(<span class="dt">n =</span> <span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb82-9" title="9">                    <span class="dt">simulation =</span> <span class="dv">1</span><span class="op">:</span>n_simulations,</a>
<a class="sourceLine" id="cb82-10" title="10">                    <span class="dt">p =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">0.9</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># added another hypothesis here </span></a>
<a class="sourceLine" id="cb82-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">index =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-12" title="12"><span class="st">  </span><span class="kw">group_by</span>(index, n, simulation) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-13" title="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">response =</span> <span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dt">size =</span> n, <span class="dt">prob =</span> p)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-14" title="14"><span class="st">  </span><span class="kw">group_by</span>(index, simulation, p) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-15" title="15"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-16" title="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(data, </a>
<a class="sourceLine" id="cb82-17" title="17">                   <span class="op">~</span><span class="st"> </span><span class="kw">binom.test</span>(<span class="dt">x =</span> .<span class="op">$</span>response,</a>
<a class="sourceLine" id="cb82-18" title="18">                          <span class="dt">n =</span> .<span class="op">$</span>n,</a>
<a class="sourceLine" id="cb82-19" title="19">                          <span class="dt">p =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb82-20" title="20">                          <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-21" title="21"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">coef =</span> <span class="kw">map</span>(fit, tidy)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-22" title="22"><span class="st">  </span><span class="kw">select</span>(simulation, p, index, coef) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-23" title="23"><span class="st">  </span><span class="kw">unnest</span>(<span class="dt">cols =</span> coef) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-24" title="24"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">n =</span> parameter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-25" title="25"><span class="st">  </span><span class="kw">group_by</span>(n, p) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-26" title="26"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">power =</span> <span class="kw">sum</span>(p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb82-27" title="27"></a>
<a class="sourceLine" id="cb82-28" title="28"><span class="co"># visualize results</span></a>
<a class="sourceLine" id="cb82-29" title="29"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.power, </a>
<a class="sourceLine" id="cb82-30" title="30">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> n,</a>
<a class="sourceLine" id="cb82-31" title="31">                     <span class="dt">y =</span> power,</a>
<a class="sourceLine" id="cb82-32" title="32">                     <span class="dt">fill =</span> <span class="kw">as.factor</span>(p),</a>
<a class="sourceLine" id="cb82-33" title="33">                     <span class="dt">group =</span> p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb82-34" title="34"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb82-35" title="35">             <span class="dt">linetype =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb82-36" title="36">             <span class="dt">color =</span> <span class="st">&quot;gray50&quot;</span>,</a>
<a class="sourceLine" id="cb82-37" title="37">             <span class="dt">size =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-38" title="38"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,</a>
<a class="sourceLine" id="cb82-39" title="39">              <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb82-40" title="40"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb82-41" title="41"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;alternative&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb82-42" title="42"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">reverse =</span> T))</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/power-analysis-43-1.png" width="672" /></p>
</div>
<div id="simulating-an-independent-samples-t-test" class="section level5">
<h5><span class="header-section-number">15.6.2.5.2</span> Simulating an independent samples t-test</h5>
<p>Let’s simulate data for an independent samples t-test. To do so, we need to make some assumptions about what we expect the distribution of the data to look like. Here, I assume that we get normally distributed data with some mean and standard deviation.</p>
<p>The procedure will be very similar to the Binomial test above. The only thing that changes really is how we generate the data (and then some small wrangling differences).</p>
<p>Let’s say that we collected the following pilotdata set:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb84-2" title="2"><span class="co"># parameters</span></a>
<a class="sourceLine" id="cb84-3" title="3">n =<span class="st"> </span><span class="dv">10</span> </a>
<a class="sourceLine" id="cb84-4" title="4">mean1 =<span class="st"> </span><span class="dv">10</span> </a>
<a class="sourceLine" id="cb84-5" title="5">sd1 =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb84-6" title="6">mean2 =<span class="st"> </span><span class="dv">11</span></a>
<a class="sourceLine" id="cb84-7" title="7">sd2 =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb84-8" title="8"></a>
<a class="sourceLine" id="cb84-9" title="9">df.ttest =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">group1 =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb84-10" title="10">                                 <span class="dt">mean =</span> mean1,</a>
<a class="sourceLine" id="cb84-11" title="11">                                 <span class="dt">sd =</span> sd1),</a>
<a class="sourceLine" id="cb84-12" title="12">                  <span class="dt">group2 =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb84-13" title="13">                                 <span class="dt">mean =</span> mean2,</a>
<a class="sourceLine" id="cb84-14" title="14">                                 <span class="dt">sd =</span> sd2)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-15" title="15"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">everything</span>())</a></code></pre></div>
<p>The two groups in our sample don’t differ significantly from each other.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.ttest,</a>
<a class="sourceLine" id="cb85-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> name,</a>
<a class="sourceLine" id="cb85-3" title="3">                     <span class="dt">y =</span> value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb85-4" title="4"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/power-analysis-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">t.test</span>(<span class="dt">formula =</span> value <span class="op">~</span><span class="st"> </span>name, </a>
<a class="sourceLine" id="cb86-2" title="2">         <span class="dt">data =</span> df.ttest)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  value by name
## t = -1.3135, df = 13.035, p-value = 0.2117
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.9191375  0.9548788
## sample estimates:
## mean in group group1 mean in group group2 
##             10.26441             11.74653</code></pre>
<p>Let’s calculate what the effect size was in our sample. Remember that Cohen’s d is defined as</p>
<p><span class="math display">\[d = \frac{\lvert\overline y_1 - \overline y_2\rvert}{s_p}\]</span></p>
<p>where</p>
<p><span class="math display">\[s_p = \sqrt\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}\]</span></p>
<p>In our sample, the effect size Cohen’s d was:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">df =<span class="st"> </span>df.ttest <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(value),</a>
<a class="sourceLine" id="cb88-4" title="4">            <span class="dt">sd =</span> <span class="kw">sd</span>(value),</a>
<a class="sourceLine" id="cb88-5" title="5">            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-6" title="6"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb88-7" title="7"></a>
<a class="sourceLine" id="cb88-8" title="8">sp =<span class="st"> </span><span class="kw">sqrt</span>(((df<span class="op">$</span>n[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>df<span class="op">$</span>sd[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(df<span class="op">$</span>n[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>df<span class="op">$</span>sd[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(df<span class="op">$</span>n[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>df<span class="op">$</span>n[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb88-9" title="9"></a>
<a class="sourceLine" id="cb88-10" title="10">d =<span class="st"> </span><span class="kw">abs</span>(df<span class="op">$</span>mean[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>df<span class="op">$</span>mean[<span class="dv">2</span>]) <span class="op">/</span><span class="st"> </span>sp</a>
<a class="sourceLine" id="cb88-11" title="11"></a>
<a class="sourceLine" id="cb88-12" title="12">d</a></code></pre></div>
<pre><code>## [1] 0.5874251</code></pre>
<p>Let’s double check that we got it right:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">cohens_d</span>(<span class="dt">x =</span> value <span class="op">~</span><span class="st"> </span>name, </a>
<a class="sourceLine" id="cb90-2" title="2">         <span class="dt">data =</span> df.ttest)</a></code></pre></div>
<pre><code>## [1] -0.5874251</code></pre>
<p>We did!</p>
<p>So let’s now calculate the means and standard deviations based on our pilot data and run a power analysis to determine how many participants we would need, to have an 80% chance of rejecting the null hypothesis for the estimated effect size.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="co"># make reproducible </span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb92-3" title="3"></a>
<a class="sourceLine" id="cb92-4" title="4"><span class="co"># parameters </span></a>
<a class="sourceLine" id="cb92-5" title="5">mean1 =<span class="st"> </span>df<span class="op">$</span>mean[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb92-6" title="6">mean2 =<span class="st"> </span>df<span class="op">$</span>mean[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb92-7" title="7">sd1 =<span class="st"> </span>df<span class="op">$</span>sd[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb92-8" title="8">sd2 =<span class="st"> </span>df<span class="op">$</span>sd[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb92-9" title="9"></a>
<a class="sourceLine" id="cb92-10" title="10"><span class="co"># number of simulations</span></a>
<a class="sourceLine" id="cb92-11" title="11">n_simulations =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb92-12" title="12"><span class="co"># n_simulations = 50</span></a>
<a class="sourceLine" id="cb92-13" title="13"></a>
<a class="sourceLine" id="cb92-14" title="14"><span class="co"># run simulation </span></a>
<a class="sourceLine" id="cb92-15" title="15">df.power2 =<span class="st"> </span><span class="kw">crossing</span>(<span class="dt">n =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">10</span>, <span class="dt">to =</span> <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb92-16" title="16">                     <span class="dt">simulation =</span> <span class="dv">1</span><span class="op">:</span>n_simulations) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb92-17" title="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">index =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-18" title="18"><span class="st">  </span><span class="kw">group_by</span>(index, n, simulation) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-19" title="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="kw">list</span>(<span class="kw">tibble</span>(<span class="dt">group1 =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb92-20" title="20">                                           <span class="dt">mean =</span> mean1,</a>
<a class="sourceLine" id="cb92-21" title="21">                                           <span class="dt">sd =</span> sd1),</a>
<a class="sourceLine" id="cb92-22" title="22">                            <span class="dt">group2 =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb92-23" title="23">                                           <span class="dt">mean =</span> mean2,</a>
<a class="sourceLine" id="cb92-24" title="24">                                           <span class="dt">sd =</span> sd2)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-25" title="25"><span class="st">                       </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">everything</span>()))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-26" title="26"><span class="st">  </span><span class="kw">group_by</span>(index, n, simulation) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-27" title="27"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p.value =</span> <span class="kw">map</span>(data,</a>
<a class="sourceLine" id="cb92-28" title="28">                   <span class="op">~</span><span class="st"> </span><span class="kw">t.test</span>(<span class="dt">formula =</span> value <span class="op">~</span><span class="st"> </span>name,</a>
<a class="sourceLine" id="cb92-29" title="29">                              <span class="dt">data =</span> .x)<span class="op">$</span>p.value)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb92-30" title="30"><span class="st">  </span><span class="co"># mutate(coef = map(fit, tidy)) %&gt;%</span></a>
<a class="sourceLine" id="cb92-31" title="31"><span class="st">  </span><span class="co"># select(simulation, n, index, coef) %&gt;%</span></a>
<a class="sourceLine" id="cb92-32" title="32"><span class="st">  </span><span class="co"># unnest(cols = coef) %&gt;%</span></a>
<a class="sourceLine" id="cb92-33" title="33"><span class="st">  </span><span class="kw">group_by</span>(n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-34" title="34"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">power =</span> <span class="kw">sum</span>(p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb92-35" title="35"></a>
<a class="sourceLine" id="cb92-36" title="36"><span class="co"># visualize results</span></a>
<a class="sourceLine" id="cb92-37" title="37"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.power2, </a>
<a class="sourceLine" id="cb92-38" title="38">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> n,</a>
<a class="sourceLine" id="cb92-39" title="39">                     <span class="dt">y =</span> power)) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-40" title="40"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb92-41" title="41">             <span class="dt">linetype =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb92-42" title="42">             <span class="dt">color =</span> <span class="st">&quot;gray50&quot;</span>,</a>
<a class="sourceLine" id="cb92-43" title="43">             <span class="dt">size =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-44" title="44"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,</a>
<a class="sourceLine" id="cb92-45" title="45">              <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-46" title="46"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-47" title="47"><span class="st">  </span><span class="kw">scale_x_discrete</span>()</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/power-analysis-48-1.png" width="672" /></p>
<p>Let’s compare to what we’d get from the <code>pwr</code> package.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">pwr.t.test</span>(<span class="dt">d =</span> <span class="fl">0.5874251</span>,</a>
<a class="sourceLine" id="cb94-2" title="2">           <span class="dt">power =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb94-3" title="3">           <span class="dt">type =</span> <span class="st">&quot;two.sample&quot;</span>,</a>
<a class="sourceLine" id="cb94-4" title="4">           <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</a></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 46.4718
##               d = 0.5874251
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
<p>Looks pretty similar!</p>
</div>
<div id="practice-3-simulation-of-an-interaction-effect" class="section level5">
<h5><span class="header-section-number">15.6.2.5.3</span> Practice 3 – Simulation of an interaction effect</h5>
<p>Try to run a simulation to determine how many participants you would need to have an 80% chance of rejecting the null hypothesis that there is no interaction based on the following pilot data set:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb96-2" title="2"><span class="co"># population parameters </span></a>
<a class="sourceLine" id="cb96-3" title="3">b0 =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb96-4" title="4">b1 =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb96-5" title="5">b2 =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb96-6" title="6">b1_<span class="dv">2</span> =<span class="st"> </span><span class="dv">-2</span></a>
<a class="sourceLine" id="cb96-7" title="7">sd =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb96-8" title="8">n =<span class="st"> </span><span class="dv">10</span> </a>
<a class="sourceLine" id="cb96-9" title="9"></a>
<a class="sourceLine" id="cb96-10" title="10">df.linear =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">runif</span>(<span class="dt">n =</span> n),</a>
<a class="sourceLine" id="cb96-11" title="11">                   <span class="dt">y =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">each =</span> n<span class="op">/</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb96-12" title="12">                   <span class="dt">z =</span> b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>b2 <span class="op">*</span><span class="st"> </span>y <span class="op">+</span><span class="st"> </span>b1_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>y <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> n, <span class="dt">sd =</span> sd))</a></code></pre></div>
<p>Let’s visualize the pilot data first:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.linear,</a>
<a class="sourceLine" id="cb97-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb97-3" title="3">                     <span class="dt">y =</span> z,</a>
<a class="sourceLine" id="cb97-4" title="4">                     <span class="dt">group =</span> y,</a>
<a class="sourceLine" id="cb97-5" title="5">                     <span class="dt">fill =</span> <span class="kw">as.factor</span>(y),</a>
<a class="sourceLine" id="cb97-6" title="6">                     <span class="dt">color =</span> <span class="kw">as.factor</span>(y))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb97-7" title="7"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</a>
<a class="sourceLine" id="cb97-8" title="8">              <span class="dt">se =</span> F,</a>
<a class="sourceLine" id="cb97-9" title="9">              <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb97-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb97-11" title="11">             <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb97-12" title="12">             <span class="dt">show.legend =</span> F)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/power-analysis-51-1.png" width="672" /></p>
<p>Let’s estimate the parameters based on our sample:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="co"># parameter estimates for the coefficients based on the sample </span></a>
<a class="sourceLine" id="cb99-2" title="2">b =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> z <span class="op">~</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>y,</a>
<a class="sourceLine" id="cb99-3" title="3">   <span class="dt">data =</span> df.linear) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-4" title="4"><span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-5" title="5"><span class="st">  </span><span class="kw">select</span>(term, estimate, p.value)</a>
<a class="sourceLine" id="cb99-6" title="6"></a>
<a class="sourceLine" id="cb99-7" title="7"><span class="co"># parameter estimate of the residual standard deviation </span></a>
<a class="sourceLine" id="cb99-8" title="8">sigma =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> z <span class="op">~</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>y,</a>
<a class="sourceLine" id="cb99-9" title="9">           <span class="dt">data =</span> df.linear) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-10" title="10"><span class="st">  </span><span class="kw">glance</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-11" title="11"><span class="st">  </span><span class="kw">pull</span>(sigma)</a></code></pre></div>
<p>Run a power analysis to see how many participants you would need to have an 80% of rejecting the null hypothesis that there is no interaction. Use the parameter estimates (the beta coefficients and the standard deviation of the residuals <code>sigma</code>) based on your pilot data to simulate new data.</p>
<p>Here is the strategy:</p>
<ul>
<li>Try to closely emulate what we’ve been doing for the independent samples t-test above.</li>
<li>However, this time, we have a different way of generating the data (namely by using the regression equation: <span class="math inline">\(z \sim b_0 + b_1 \cdot x + b_2 \cdot y + b_{1\_2} \cdot x \cdot y + e)\)</span>, where <span class="math inline">\(e \sim N(0, \sigma)\)</span>.</li>
<li>Fit the model first to extract the estimates for the beta coefficients, and the standard deviation of the residuals <code>sigma</code>.</li>
<li>Then use these parameters to generate new data assuming that <code>x</code> is a continuous predictor between 0 and 1 (<code>x = runif(n = n)</code>) and <code>y</code> is a binary, dummy-coded variable (<code>y = rep(c(0, 1), each = n/2)</code>).</li>
<li>Extract the coefficients of each model fit, and check whether the interaction is significant.</li>
<li>Make a plot that shows how power changes with the sample size n. </li>
</ul>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="co"># write your code here </span></a></code></pre></div>
<p>Run the same power analysis this time assuming the ground truth parameters from the population (rather than the parameters that we’ve estimated from the sample).</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb101-2" title="2"><span class="co"># write your code here </span></a></code></pre></div>
</div>
</div>
</div>
</div>
<div id="additional-resources-11" class="section level2">
<h2><span class="header-section-number">15.7</span> Additional resources</h2>
<div id="datacamp-5" class="section level3">
<h3><span class="header-section-number">15.7.1</span> Datacamp</h3>
<ul>
<li><a href="https://www.datacamp.com/courses/foundations-of-functional-programming-with-purrr">Functional programming with purrr</a></li>
</ul>
</div>
<div id="cheatsheets-6" class="section level3">
<h3><span class="header-section-number">15.7.2</span> Cheatsheets</h3>
<ul>
<li><a href="figures/cheatsheets/purrr.pdf">purrr</a></li>
</ul>
</div>
<div id="misc-7" class="section level3">
<h3><span class="header-section-number">15.7.3</span> Misc</h3>
<ul>
<li><a href="https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html">Getting started with <code>pwr</code></a></li>
<li><a href="https://rpsychologist.com/d3/NHST/">Visualize power</a></li>
<li><a href="https://www.frontiersin.org/articles/10.3389/fpsyg.2013.00863/full">Calculating and reporting effect sizes to facilitate cumulative science: a practical primer for t-tests and ANOVAs</a></li>
<li><a href="https://emoriebeck.github.io/R-tutorials/purrr/">purrr tutorial</a></li>
<li><a href="https://cran.r-project.org/web/packages/simr/index.html">simr</a>: R Package for running power analysis for generalized linear mixed effects models.</li>
<li><a href="https://cran.r-project.org/web/packages/simglm/index.html">simglm</a>: Alternative R package for running power analysis via simulation.</li>
<li><a href="https://nccih.nih.gov/grants/whatnccihfunds/pilot_studies">cautionary tale about using pilot studies for power calculations</a></li>
</ul>
</div>
</div>
<div id="session-info-12" class="section level2">
<h2><span class="header-section-number">15.8</span> Session info</h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Mojave 10.14.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] forcats_0.5.0    stringr_1.4.0    dplyr_0.8.4      purrr_0.3.3     
##  [5] readr_1.3.1      tidyr_1.0.2      tibble_2.1.3     ggplot2_3.3.0   
##  [9] tidyverse_1.3.0  pwr_1.2-2        effectsize_0.2.0 lsr_0.5         
## [13] magrittr_1.5     broom_0.5.5      kableExtra_1.1.0 knitr_1.28      
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-145        fs_1.3.2            lubridate_1.7.4    
##  [4] insight_0.8.1       webshot_0.5.2       RColorBrewer_1.1-2 
##  [7] httr_1.4.1          tools_3.6.2         backports_1.1.5    
## [10] utf8_1.1.4          R6_2.4.1            rpart_4.1-15       
## [13] Hmisc_4.3-1         DBI_1.1.0           mgcv_1.8-31        
## [16] colorspace_1.4-1    nnet_7.3-13         withr_2.1.2        
## [19] tidyselect_1.0.0    gridExtra_2.3       compiler_3.6.2     
## [22] cli_2.0.2           rvest_0.3.5         htmlTable_1.13.3   
## [25] xml2_1.2.2          labeling_0.3        bookdown_0.18      
## [28] bayestestR_0.5.2    scales_1.1.0        checkmate_2.0.0    
## [31] digest_0.6.25       foreign_0.8-76      rmarkdown_2.1      
## [34] base64enc_0.1-3     jpeg_0.1-8.1        pkgconfig_2.0.3    
## [37] htmltools_0.4.0     dbplyr_1.4.2        htmlwidgets_1.5.1  
## [40] rlang_0.4.5         readxl_1.3.1        rstudioapi_0.11    
## [43] farver_2.0.3        generics_0.0.2      jsonlite_1.6.1     
## [46] acepack_1.4.1       Formula_1.2-3       parameters_0.5.0   
## [49] Matrix_1.2-18       Rcpp_1.0.3          munsell_0.5.0      
## [52] fansi_0.4.1         lifecycle_0.1.0     stringi_1.4.6      
## [55] yaml_2.2.1          plyr_1.8.6          grid_3.6.2         
## [58] crayon_1.3.4        lattice_0.20-40     haven_2.2.0        
## [61] splines_3.6.2       hms_0.5.3           pillar_1.4.3       
## [64] reprex_0.3.0        glue_1.3.1          evaluate_0.14      
## [67] latticeExtra_0.6-29 data.table_1.12.8   modelr_0.1.6       
## [70] vctrs_0.2.3         png_0.1-7           cellranger_1.1.0   
## [73] gtable_0.3.0        assertthat_0.2.1    xfun_0.12          
## [76] survival_3.1-8      viridisLite_0.3.0   cluster_2.1.0</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="power-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mediation-moderation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/14-power_analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
