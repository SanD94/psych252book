<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 23 Bayesian data analysis 3 | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 23 Bayesian data analysis 3 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 23 Bayesian data analysis 3 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2020-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-data-analysis-2.html"/>
<link rel="next" href="bayesian-data-analysis-4.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a><ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="visualization-1.html"><a href="visualization-1.html#how-not-to-visualize-data"><i class="fa fa-check"></i><b>2.3.1</b> How <em>not</em> to visualize data</a></li>
<li class="chapter" data-level="2.3.2" data-path="visualization-1.html"><a href="visualization-1.html#how-to-make-it-better"><i class="fa fa-check"></i><b>2.3.2</b> How to make it better</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.5</b> Getting help</a></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization-using-ggplot2"><i class="fa fa-check"></i><b>2.6</b> Data visualization using <code>ggplot2</code></a><ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.6.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.6.2</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.6.3</b> Scatter plot</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.6.4</b> Line plot</a></li>
<li class="chapter" data-level="2.6.5" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.6.5</b> Adding error bars</a></li>
<li class="chapter" data-level="2.6.6" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.6.6</b> Grouping data</a></li>
<li class="chapter" data-level="2.6.7" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.6.7</b> Making facets</a></li>
<li class="chapter" data-level="2.6.8" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.6.8</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.7</b> Additional resources</a><ul>
<li class="chapter" data-level="2.7.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.7.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.7.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.7.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.7.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.7.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a><ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a><ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a><ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a><ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a><ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-2"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#install-packages"><i class="fa fa-check"></i><b>4.2</b> Install packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.3</b> Load packages</a></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.4</b> Some R basics</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.4.1</b> Modes</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.4.2</b> Data types</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.4.3</b> Operators</a></li>
<li class="chapter" data-level="4.4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.4.4</b> Control flow</a></li>
<li class="chapter" data-level="4.4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.4.5</b> Functions</a></li>
<li class="chapter" data-level="4.4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.4.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
<li class="chapter" data-level="4.5.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.5.7</b> A quick note on naming things</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a><ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.4</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.5</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.7</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a><ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="4.7.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#misc-2"><i class="fa fa-check"></i><b>4.7.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a><ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-3"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.3</b> Wrangling data (continued)</a><ul>
<li class="chapter" data-level="5.3.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.3.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.3.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.3.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.3.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.3.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.4</b> Reading in data</a><ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.4.1</b> csv</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.4.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.5</b> Saving data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.6</b> Additional resources</a><ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.6.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.6.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.6.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.6.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a><ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#learning-goals-4"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#install-and-load-packages-load-data-set-theme-1"><i class="fa fa-check"></i><b>6.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.3</b> Counting</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.5</b> The random secretary</a></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.6</b> Clue guide to probability</a><ul>
<li class="chapter" data-level="6.6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.6.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.6.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.7</b> Probability operations</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.8</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-networks"><i class="fa fa-check"></i><b>6.9</b> Bayesian networks</a><ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#sprinkler-example"><i class="fa fa-check"></i><b>6.9.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a><ul>
<li class="chapter" data-level="6.10.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.10.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.10.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-3"><i class="fa fa-check"></i><b>6.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a><ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#learning-goals-5"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.3</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.5</b> Computing probabilities</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a><ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#working-with-samples"><i class="fa fa-check"></i><b>7.5</b> Working with samples</a><ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.5.1</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="simulation-1.html"><a href="simulation-1.html#the-quantile-function"><i class="fa fa-check"></i><b>7.5.2</b> The <code>quantile()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#comparing-probability-distributions"><i class="fa fa-check"></i><b>7.6</b> Comparing probability distributions</a></li>
<li class="chapter" data-level="7.7" data-path="simulation-1.html"><a href="simulation-1.html#relationship-between-probability-and-likelihood"><i class="fa fa-check"></i><b>7.7</b> Relationship between probability and likelihood</a></li>
<li class="chapter" data-level="7.8" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.8</b> Additional resources</a><ul>
<li class="chapter" data-level="7.8.1" data-path="simulation-1.html"><a href="simulation-1.html#cheatsheets-5"><i class="fa fa-check"></i><b>7.8.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="7.8.2" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.8.2</b> Datacamp</a></li>
<li class="chapter" data-level="7.8.3" data-path="simulation-1.html"><a href="simulation-1.html#tutorials-1"><i class="fa fa-check"></i><b>7.8.3</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a><ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#learning-goals-6"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>8.3</b> The central limit theorem</a><ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.3.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.3.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.3.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.3.3</b> The sampling distribution</a></li>
<li class="chapter" data-level="8.3.4" data-path="simulation-2.html"><a href="simulation-2.html#exploring-the-clt"><i class="fa fa-check"></i><b>8.3.4</b> Exploring the CLT</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.4</b> Understanding p-values</a><ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.4.1</b> Permutation test</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.6</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a><ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#learning-goals-7"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.3</b> Modeling data</a><ul>
<li class="chapter" data-level="9.3.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.3.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.3.2" data-path="modeling-data.html"><a href="modeling-data.html#error-definitions-and-best-estimators"><i class="fa fa-check"></i><b>9.3.2</b> Error definitions and best estimators</a></li>
<li class="chapter" data-level="9.3.3" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.3.3</b> Sampling distributions for median and mean</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.4</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.5</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6</b> Additional resources</a><ul>
<li class="chapter" data-level="9.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.6.1</b> Reading</a></li>
<li class="chapter" data-level="9.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-1"><i class="fa fa-check"></i><b>9.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-7"><i class="fa fa-check"></i><b>9.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a><ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#learning-goals-8"><i class="fa fa-check"></i><b>10.1</b> Learning goals</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.3</b> Correlation</a></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.4</b> Regression</a><ul>
<li class="chapter" data-level="10.4.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.4.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.4.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.5</b> Credit example</a></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.6</b> Additional resources</a><ul>
<li class="chapter" data-level="10.6.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-2"><i class="fa fa-check"></i><b>10.6.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.6.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-4"><i class="fa fa-check"></i><b>10.6.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-8"><i class="fa fa-check"></i><b>10.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a><ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-9"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a><ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a><ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a><ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a><ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a><ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-3"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-5"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-9"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a><ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-10"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a><ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
<li class="chapter" data-level="12.5.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.5.5</b> Two-way ANOVA (with interaction)</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>12.6</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.7</b> Additional resources</a><ul>
<li class="chapter" data-level="12.7.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-4"><i class="fa fa-check"></i><b>12.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.7.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-6"><i class="fa fa-check"></i><b>12.7.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-10"><i class="fa fa-check"></i><b>12.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a><ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#learning-goals-11"><i class="fa fa-check"></i><b>13.1</b> Learning goals</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.3</b> Load data sets</a></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#planned-contrasts"><i class="fa fa-check"></i><b>13.4</b> Planned contrasts</a><ul>
<li class="chapter" data-level="13.4.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.4.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.4.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.4.2</b> Visualization</a></li>
<li class="chapter" data-level="13.4.3" data-path="linear-model-4.html"><a href="linear-model-4.html#constrasts"><i class="fa fa-check"></i><b>13.4.3</b> Constrasts</a></li>
<li class="chapter" data-level="13.4.4" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.4.4</b> Post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-11"><i class="fa fa-check"></i><b>13.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a><ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-12"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a><ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#eta-squared-and-partial-eta-squared"><i class="fa fa-check"></i><b>14.5.1</b> eta-squared and partial eta-squared</a></li>
<li class="chapter" data-level="14.5.2" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.2</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a><ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-via-simulation"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis via simulation</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-11"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a><ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-5"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-6"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-7"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-12"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mediation-moderation.html"><a href="mediation-moderation.html"><i class="fa fa-check"></i><b>15</b> Mediation &amp; Moderation</a><ul>
<li class="chapter" data-level="15.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#learning-goals-13"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#recommended-reading"><i class="fa fa-check"></i><b>15.2</b> Recommended reading</a></li>
<li class="chapter" data-level="15.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#controlling-for-variables"><i class="fa fa-check"></i><b>15.4</b> Controlling for variables</a><ul>
<li class="chapter" data-level="15.4.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>15.4.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="15.4.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#good-controls"><i class="fa fa-check"></i><b>15.4.2</b> Good controls</a></li>
<li class="chapter" data-level="15.4.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#bad-controls"><i class="fa fa-check"></i><b>15.4.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mediation-moderation.html"><a href="mediation-moderation.html#mediation"><i class="fa fa-check"></i><b>15.5</b> Mediation</a><ul>
<li class="chapter" data-level="15.5.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data"><i class="fa fa-check"></i><b>15.5.1</b> Generate data</a></li>
<li class="chapter" data-level="15.5.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>15.5.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="15.5.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>15.5.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="15.5.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>15.5.4</b> Method 3: Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation"><i class="fa fa-check"></i><b>15.6</b> Moderation</a><ul>
<li class="chapter" data-level="15.6.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data-1"><i class="fa fa-check"></i><b>15.6.1</b> Generate data</a></li>
<li class="chapter" data-level="15.6.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation-analysis"><i class="fa fa-check"></i><b>15.6.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="mediation-moderation.html"><a href="mediation-moderation.html#additional-resources-12"><i class="fa fa-check"></i><b>15.7</b> Additional resources</a><ul>
<li class="chapter" data-level="15.7.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#books"><i class="fa fa-check"></i><b>15.7.1</b> Books</a></li>
<li class="chapter" data-level="15.7.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#tutorials-2"><i class="fa fa-check"></i><b>15.7.2</b> Tutorials</a></li>
<li class="chapter" data-level="15.7.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#misc-8"><i class="fa fa-check"></i><b>15.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="mediation-moderation.html"><a href="mediation-moderation.html#session-info-13"><i class="fa fa-check"></i><b>15.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>16</b> Model comparison</a><ul>
<li class="chapter" data-level="16.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-14"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>16.3</b> Model comparison</a><ul>
<li class="chapter" data-level="16.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>16.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="16.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>16.3.2</b> F-test</a></li>
<li class="chapter" data-level="16.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>16.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="16.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>16.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="16.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>16.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>16.4</b> Additional resources</a><ul>
<li class="chapter" data-level="16.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>16.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="16.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>16.4.2</b> Reading</a></li>
<li class="chapter" data-level="16.4.3" data-path="model-comparison.html"><a href="model-comparison.html#misc-9"><i class="fa fa-check"></i><b>16.4.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-14"><i class="fa fa-check"></i><b>16.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a><ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-15"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a><ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-15"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a><ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-16"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>18.3</b> Simulating a linear mixed effects model</a></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.4</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.5</b> Different slopes</a></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.6</b> Simpson’s paradox</a></li>
<li class="chapter" data-level="18.7" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.7</b> Additional resources</a><ul>
<li class="chapter" data-level="18.7.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.7.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-16"><i class="fa fa-check"></i><b>18.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a><ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-17"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-set"><i class="fa fa-check"></i><b>19.3</b> Load data set</a></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixtures-of-participants"><i class="fa fa-check"></i><b>19.4</b> Mixtures of participants</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#pooling-and-shrinkage"><i class="fa fa-check"></i><b>19.5</b> Pooling and shrinkage</a><ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#complete-pooling"><i class="fa fa-check"></i><b>19.5.1</b> Complete pooling</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#no-pooling"><i class="fa fa-check"></i><b>19.5.2</b> No pooling</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#partial-pooling"><i class="fa fa-check"></i><b>19.5.3</b> Partial pooling</a></li>
<li class="chapter" data-level="19.5.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#compare-results"><i class="fa fa-check"></i><b>19.5.4</b> Compare results</a></li>
<li class="chapter" data-level="19.5.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#coefficients"><i class="fa fa-check"></i><b>19.5.5</b> Coefficients</a></li>
<li class="chapter" data-level="19.5.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#shrinkage"><i class="fa fa-check"></i><b>19.5.6</b> Shrinkage</a></li>
<li class="chapter" data-level="19.5.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#plotting-marginal-effects"><i class="fa fa-check"></i><b>19.5.7</b> Plotting marginal effects</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#bootstrapping"><i class="fa fa-check"></i><b>19.6</b> Bootstrapping</a><ul>
<li class="chapter" data-level="19.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#linear-model"><i class="fa fa-check"></i><b>19.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#getting-p-values"><i class="fa fa-check"></i><b>19.7</b> Getting p-values</a></li>
<li class="chapter" data-level="19.8" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.8</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-17"><i class="fa fa-check"></i><b>19.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>20</b> Generalized linear model</a><ul>
<li class="chapter" data-level="20.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-18"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set-1"><i class="fa fa-check"></i><b>20.3</b> Load data set</a></li>
<li class="chapter" data-level="20.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>20.4</b> Logistic regression</a><ul>
<li class="chapter" data-level="20.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>20.4.1</b> Interpreting the parameters</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>20.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="20.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>20.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="20.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>20.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="20.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logit-transform"><i class="fa fa-check"></i><b>20.8</b> Logit transform</a></li>
<li class="chapter" data-level="20.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>20.9</b> Additional information</a><ul>
<li class="chapter" data-level="20.9.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-6"><i class="fa fa-check"></i><b>20.9.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="20.10" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-18"><i class="fa fa-check"></i><b>20.10</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html"><i class="fa fa-check"></i><b>21</b> Bayesian data analysis</a><ul>
<li class="chapter" data-level="21.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#learning-goals-19"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>21.3</b> Doing Bayesian inference “by hand”</a><ul>
<li class="chapter" data-level="21.3.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>21.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="21.3.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#coin-flip-example"><i class="fa fa-check"></i><b>21.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="21.3.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>21.3.3</b> Bayesian inference by discretization</a></li>
<li class="chapter" data-level="21.3.4" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#effect-of-the-prior"><i class="fa fa-check"></i><b>21.3.4</b> Effect of the prior</a></li>
<li class="chapter" data-level="21.3.5" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#effect-of-the-likelihood"><i class="fa fa-check"></i><b>21.3.5</b> Effect of the likelihood</a></li>
<li class="chapter" data-level="21.3.6" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#effect-of-the-sample-size"><i class="fa fa-check"></i><b>21.3.6</b> Effect of the sample size</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#session-info-19"><i class="fa fa-check"></i><b>21.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 2</a><ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-20"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#distributions"><i class="fa fa-check"></i><b>22.3</b> Distributions</a><ul>
<li class="chapter" data-level="22.3.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#normal-vs-student-t-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Normal vs Student-t distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#beta-distributions"><i class="fa fa-check"></i><b>22.3.2</b> Beta distributions</a></li>
<li class="chapter" data-level="22.3.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#normal-distributions"><i class="fa fa-check"></i><b>22.3.3</b> Normal distributions</a></li>
<li class="chapter" data-level="22.3.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#distributions-for-non-negative-parameters"><i class="fa fa-check"></i><b>22.3.4</b> Distributions for non-negative parameters</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#inference-via-sampling"><i class="fa fa-check"></i><b>22.4</b> Inference via sampling</a></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#greta"><i class="fa fa-check"></i><b>22.5</b> Greta</a><ul>
<li class="chapter" data-level="22.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#attitude-data-set"><i class="fa fa-check"></i><b>22.5.1</b> Attitude data set</a></li>
<li class="chapter" data-level="22.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#frequentist-analysis"><i class="fa fa-check"></i><b>22.5.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="22.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#bayesian-regression"><i class="fa fa-check"></i><b>22.5.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-20"><i class="fa fa-check"></i><b>22.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 3</a><ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-21"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-data-set-2"><i class="fa fa-check"></i><b>23.3</b> Load data set</a></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#poker"><i class="fa fa-check"></i><b>23.4</b> Poker</a><ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualization-7"><i class="fa fa-check"></i><b>23.4.1</b> Visualization</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#linear-model-5"><i class="fa fa-check"></i><b>23.4.2</b> Linear model</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-model"><i class="fa fa-check"></i><b>23.4.3</b> Bayesian model</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#sleep-study"><i class="fa fa-check"></i><b>23.5</b> Sleep study</a><ul>
<li class="chapter" data-level="23.5.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-1"><i class="fa fa-check"></i><b>23.5.1</b> Frequentist analysis</a></li>
<li class="chapter" data-level="23.5.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis"><i class="fa fa-check"></i><b>23.5.2</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#titanic-study"><i class="fa fa-check"></i><b>23.6</b> Titanic study</a><ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-2"><i class="fa fa-check"></i><b>23.6.1</b> Frequentist analysis</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-anaysis"><i class="fa fa-check"></i><b>23.6.2</b> Bayesian anaysis</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-16"><i class="fa fa-check"></i><b>23.7</b> Additional resources</a></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-21"><i class="fa fa-check"></i><b>23.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html"><i class="fa fa-check"></i><b>24</b> Bayesian data analysis 4</a><ul>
<li class="chapter" data-level="24.1" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#learning-goals-22"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#load-packages-and-set-plotting-theme-17"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>24.3</b> Evidence for the null hypothesis</a><ul>
<li class="chapter" data-level="24.3.1" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#fit-the-model-4"><i class="fa fa-check"></i><b>24.3.1</b> Fit the model</a></li>
<li class="chapter" data-level="24.3.2" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#visualize-the-results-3"><i class="fa fa-check"></i><b>24.3.2</b> Visualize the results</a></li>
<li class="chapter" data-level="24.3.3" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#hypothesis-test-2"><i class="fa fa-check"></i><b>24.3.3</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>24.4</b> Dealing with heteroscedasticity</a><ul>
<li class="chapter" data-level="24.4.1" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#visualize-the-data"><i class="fa fa-check"></i><b>24.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="24.4.2" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#frequentist-analysis-3"><i class="fa fa-check"></i><b>24.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="24.4.3" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#bayesian-analysis-1"><i class="fa fa-check"></i><b>24.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>24.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="24.6" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#ordinal-regression"><i class="fa fa-check"></i><b>24.6</b> Ordinal regression</a><ul>
<li class="chapter" data-level="24.6.1" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.2" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.3" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.4" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.5" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#model-comparison-3"><i class="fa fa-check"></i><b>24.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#additional-resources-17"><i class="fa fa-check"></i><b>24.7</b> Additional resources</a></li>
<li class="chapter" data-level="24.8" data-path="bayesian-data-analysis-4.html"><a href="bayesian-data-analysis-4.html#session-info-22"><i class="fa fa-check"></i><b>24.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>25</b> Reporting statistics</a><ul>
<li class="chapter" data-level="25.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>25.1</b> General advice</a><ul>
<li class="chapter" data-level="25.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>25.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="25.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>25.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="25.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>25.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="25.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>25.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="25.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>25.1.5</b> Frequentist statistics</a></li>
<li class="chapter" data-level="25.1.6" data-path="reporting-statistics.html"><a href="reporting-statistics.html#bayesian-statistics"><i class="fa fa-check"></i><b>25.1.6</b> Bayesian statistics –&gt;</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-23"><i class="fa fa-check"></i><b>25.2</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html"><i class="fa fa-check"></i><b>26</b> Cheatsheets</a><ul>
<li class="chapter" data-level="26.1" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#statistics"><i class="fa fa-check"></i><b>26.1</b> Statistics</a></li>
<li class="chapter" data-level="26.2" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#r"><i class="fa fa-check"></i><b>26.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-data-analysis-3" class="section level1">
<h1><span class="header-section-number">Chapter 23</span> Bayesian data analysis 3</h1>
<div id="learning-goals-21" class="section level2">
<h2><span class="header-section-number">23.1</span> Learning goals</h2>
<ul>
<li>Building Bayesian models with <code>brms</code>.
<ul>
<li>Model evaluation:
<ul>
<li>Visualizing and interpreting results.</li>
<li>Testing hypotheses.</li>
</ul></li>
<li>Inference evaluation: Did things work out?</li>
</ul></li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-16" class="section level2">
<h2><span class="header-section-number">23.2</span> Load packages and set plotting theme</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(<span class="st">&quot;knitr&quot;</span>)       <span class="co"># for knitting RMarkdown </span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>)  <span class="co"># for making nice tables</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(<span class="st">&quot;janitor&quot;</span>)     <span class="co"># for cleaning column names</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(<span class="st">&quot;tidybayes&quot;</span>)   <span class="co"># tidying up results from Bayesian models</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(<span class="st">&quot;brms&quot;</span>)        <span class="co"># Bayesian regression models with Stan</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(<span class="st">&quot;patchwork&quot;</span>)   <span class="co"># for making figure panels</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(<span class="st">&quot;gganimate&quot;</span>)   <span class="co"># for animations</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(<span class="st">&quot;GGally&quot;</span>)      <span class="co"># for pairs plot</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)       <span class="co"># for tidy lm results</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">library</span>(<span class="st">&quot;broom.mixed&quot;</span>) <span class="co"># for tidy lmer results</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">library</span>(<span class="st">&quot;bayesplot&quot;</span>)   <span class="co"># for visualization of Bayesian model fits </span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">library</span>(<span class="st">&quot;modelr&quot;</span>)      <span class="co"># for modeling functions</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">library</span>(<span class="st">&quot;lme4&quot;</span>)        <span class="co"># for linear mixed effects models </span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">library</span>(<span class="st">&quot;ggeffects&quot;</span>)   <span class="co"># for help with logistic regressions</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">library</span>(<span class="st">&quot;titanic&quot;</span>)     <span class="co"># titanic dataset</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)   <span class="co"># for wrangling, plotting, etc. </span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">theme_set</span>(<span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="co"># set the theme </span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">            </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>))) <span class="co"># set the default text size</span></a></code></pre></div>
</div>
<div id="load-data-set-2" class="section level2">
<h2><span class="header-section-number">23.3</span> Load data set</h2>
<p>Load the poker data set.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">df.poker =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/poker.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">skill =</span> <span class="kw">factor</span>(skill,</a>
<a class="sourceLine" id="cb3-3" title="3">                        <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb3-4" title="4">                        <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;expert&quot;</span>, <span class="st">&quot;average&quot;</span>)),</a>
<a class="sourceLine" id="cb3-5" title="5">         <span class="dt">skill =</span> <span class="kw">fct_relevel</span>(skill, <span class="st">&quot;average&quot;</span>, <span class="st">&quot;expert&quot;</span>),</a>
<a class="sourceLine" id="cb3-6" title="6">         <span class="dt">hand =</span> <span class="kw">factor</span>(hand,</a>
<a class="sourceLine" id="cb3-7" title="7">                       <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb3-8" title="8">                       <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;bad&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;good&quot;</span>)),</a>
<a class="sourceLine" id="cb3-9" title="9">         <span class="dt">limit =</span> <span class="kw">factor</span>(limit,</a>
<a class="sourceLine" id="cb3-10" title="10">                        <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb3-11" title="11">                        <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;fixed&quot;</span>, <span class="st">&quot;none&quot;</span>)),</a>
<a class="sourceLine" id="cb3-12" title="12">         <span class="dt">participant =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="st">  </span><span class="kw">select</span>(participant, <span class="kw">everything</span>())</a></code></pre></div>
</div>
<div id="poker" class="section level2">
<h2><span class="header-section-number">23.4</span> Poker</h2>
<div id="visualization-7" class="section level3">
<h3><span class="header-section-number">23.4.1</span> Visualization</h3>
<p>Let’s visualize the data first:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">df.poker <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> hand,</a>
<a class="sourceLine" id="cb4-3" title="3">                       <span class="dt">y =</span> balance,</a>
<a class="sourceLine" id="cb4-4" title="4">                       <span class="dt">fill =</span> hand)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb4-6" title="6">             <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="fl">0.1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</a>
<a class="sourceLine" id="cb4-8" title="8">               <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>,</a>
<a class="sourceLine" id="cb4-9" title="9">               <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun =</span> <span class="st">&quot;mean&quot;</span>,</a>
<a class="sourceLine" id="cb4-11" title="11">               <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</a>
<a class="sourceLine" id="cb4-12" title="12">               <span class="dt">shape =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb4-13" title="13">               <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;final balance (in Euros)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-05-1.png" width="672" /></p>
</div>
<div id="linear-model-5" class="section level3">
<h3><span class="header-section-number">23.4.2</span> Linear model</h3>
<p>And let’s now fit a simple (frequentist) regression model:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">fit.lm =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> balance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>hand,</a>
<a class="sourceLine" id="cb5-2" title="2">            <span class="dt">data =</span> df.poker)</a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4">fit.lm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = balance ~ 1 + hand, data = df.poker)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.9264  -2.5902  -0.0115   2.6573  15.2834 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.9415     0.4111  14.451  &lt; 2e-16 ***
## handneutral   4.4051     0.5815   7.576 4.55e-13 ***
## handgood      7.0849     0.5815  12.185  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.111 on 297 degrees of freedom
## Multiple R-squared:  0.3377, Adjusted R-squared:  0.3332 
## F-statistic:  75.7 on 2 and 297 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="bayesian-model" class="section level3">
<h3><span class="header-section-number">23.4.3</span> Bayesian model</h3>
<p>Now, let’s fit a Bayesian regression model using the <code>brm()</code> function:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">fit.brm1 =<span class="st"> </span><span class="kw">brm</span>(<span class="dt">formula =</span> balance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>hand,</a>
<a class="sourceLine" id="cb7-2" title="2">               <span class="dt">data =</span> df.poker,</a>
<a class="sourceLine" id="cb7-3" title="3">               <span class="dt">file =</span> <span class="st">&quot;cache/23/brm1&quot;</span>)</a>
<a class="sourceLine" id="cb7-4" title="4"></a>
<a class="sourceLine" id="cb7-5" title="5">fit.brm1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: balance ~ 1 + hand 
##    Data: df.poker (Number of observations: 300) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept       5.93      0.41     5.12     6.72 1.00     2986     2744
## handneutral     4.41      0.58     3.30     5.55 1.00     3497     2903
## handgood        7.10      0.58     5.99     8.29 1.00     3545     2932
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     4.12      0.17     3.81     4.46 1.00     3650     2921
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>I use the <code>file =</code> argument to save the model’s results so that when I run this code chunk again, the model doesn’t need to be fit again (fitting Bayesian models takes a while …).</p>
<div id="visualize-the-posteriors-1" class="section level4">
<h4><span class="header-section-number">23.4.3.1</span> Visualize the posteriors</h4>
<p>Let’s visualize what the posterior for the different parameters looks like. We use the <code>geom_halfeyeh()</code> function from the “tidybayes” package to do so:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">fit.brm1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>lp__) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">everything</span>(),</a>
<a class="sourceLine" id="cb9-5" title="5">               <span class="dt">names_to =</span> <span class="st">&quot;variable&quot;</span>,</a>
<a class="sourceLine" id="cb9-6" title="6">               <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb9-8" title="8">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> variable,</a>
<a class="sourceLine" id="cb9-9" title="9">                       <span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">fun.data =</span> mode_hdih)</a></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: fun.data</code></pre>
<p><img src="psych252_files/figure-html/bda3-08-1.png" width="672" /></p>
</div>
<div id="compute-highest-density-intervals" class="section level4">
<h4><span class="header-section-number">23.4.3.2</span> Compute highest density intervals</h4>
<p>To compute the MAP (maximum a posteriori probability) estimate and highest density interval, we use the <code>mode_hdi()</code> function that comes with the “tidybayes” package.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">fit.brm1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;b_&quot;</span>), sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="st">  </span><span class="kw">mode_hdi</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span><span class="kw">c</span>(.width<span class="op">:</span>.interval),</a>
<a class="sourceLine" id="cb11-7" title="7">               <span class="dt">names_to =</span> <span class="st">&quot;index&quot;</span>,</a>
<a class="sourceLine" id="cb11-8" title="8">               <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="st">  </span><span class="kw">select</span>(index, value) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">index =</span> <span class="kw">ifelse</span>(<span class="kw">str_detect</span>(index, <span class="kw">fixed</span>(<span class="st">&quot;.&quot;</span>)), index, <span class="kw">str_c</span>(index, <span class="st">&quot;.mode&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="st">  </span><span class="kw">separate</span>(index, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;type&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> type, </a>
<a class="sourceLine" id="cb11-13" title="13">              <span class="dt">values_from =</span> value) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</a>
<a class="sourceLine" id="cb11-16" title="16">                <span class="dt">full_width =</span> F)</a></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:right;">
mode
</th>
<th style="text-align:right;">
lower
</th>
<th style="text-align:right;">
upper
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
b_intercept
</td>
<td style="text-align:right;">
6.02
</td>
<td style="text-align:right;">
5.13
</td>
<td style="text-align:right;">
6.73
</td>
</tr>
<tr>
<td style="text-align:left;">
b_handneutral
</td>
<td style="text-align:right;">
4.46
</td>
<td style="text-align:right;">
3.29
</td>
<td style="text-align:right;">
5.54
</td>
</tr>
<tr>
<td style="text-align:left;">
b_handgood
</td>
<td style="text-align:right;">
7.07
</td>
<td style="text-align:right;">
5.95
</td>
<td style="text-align:right;">
8.21
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
4.11
</td>
<td style="text-align:right;">
3.81
</td>
<td style="text-align:right;">
4.46
</td>
</tr>
</tbody>
</table>
</div>
<div id="posterior-predictive-check-1" class="section level4">
<h4><span class="header-section-number">23.4.3.3</span> Posterior predictive check</h4>
<p>To check whether the model did a good job capturing the data, we can simulate what future data the Baysian model predicts, now that it has learned from the data we feed into it.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">pp_check</span>(fit.brm1, <span class="dt">nsamples =</span> <span class="dv">100</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-10-1.png" width="672" /></p>
<p>This looks good! The predicted shaped of the data based on samples from the posterior distribution looks very similar to the shape of the actual data.</p>
<p>Let’s make a hypothetical outcome plot that shows what concrete data sets the model would predict:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># generate predictive samples </span></a>
<a class="sourceLine" id="cb13-2" title="2">df.predictive_samples =<span class="st"> </span>fit.brm1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;b_&quot;</span>), sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> <span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="st">  </span><span class="kw">group_by</span>(sample) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">bad =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>b_intercept <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">sd =</span> .<span class="op">$</span>sigma)),</a>
<a class="sourceLine" id="cb13-11" title="11">         <span class="dt">neutral =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>b_intercept <span class="op">+</span><span class="st"> </span>.<span class="op">$</span>b_handneutral <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">sd =</span> .<span class="op">$</span>sigma)),</a>
<a class="sourceLine" id="cb13-12" title="12">         <span class="dt">good =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>b_intercept <span class="op">+</span><span class="st"> </span>.<span class="op">$</span>b_handgood <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">sd =</span> .<span class="op">$</span>sigma))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="st">  </span><span class="kw">unnest</span>(<span class="kw">c</span>(bad, neutral, good)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>data)</a>
<a class="sourceLine" id="cb13-15" title="15"></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="co"># plot the results as an animation</span></a>
<a class="sourceLine" id="cb13-17" title="17">p =<span class="st"> </span>df.predictive_samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-18" title="18"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>sample,</a>
<a class="sourceLine" id="cb13-19" title="19">               <span class="dt">names_to =</span> <span class="st">&quot;hand&quot;</span>,</a>
<a class="sourceLine" id="cb13-20" title="20">               <span class="dt">values_to =</span> <span class="st">&quot;balance&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-21" title="21"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hand =</span> <span class="kw">factor</span>(hand, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;bad&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;good&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> hand,</a>
<a class="sourceLine" id="cb13-23" title="23">                       <span class="dt">y =</span> balance,</a>
<a class="sourceLine" id="cb13-24" title="24">                       <span class="dt">fill =</span> hand)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-25" title="25"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb13-26" title="26">             <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="fl">0.1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-27" title="27"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</a>
<a class="sourceLine" id="cb13-28" title="28">               <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>,</a>
<a class="sourceLine" id="cb13-29" title="29">               <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-30" title="30"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun =</span> <span class="st">&quot;mean&quot;</span>,</a>
<a class="sourceLine" id="cb13-31" title="31">               <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</a>
<a class="sourceLine" id="cb13-32" title="32">               <span class="dt">shape =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb13-33" title="33">               <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-34" title="34"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;final balance (in Euros)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-35" title="35"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-36" title="36"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-37" title="37"><span class="st">  </span><span class="kw">transition_manual</span>(sample)</a>
<a class="sourceLine" id="cb13-38" title="38"></a>
<a class="sourceLine" id="cb13-39" title="39"><span class="kw">animate</span>(p, <span class="dt">nframes =</span> <span class="dv">120</span>, <span class="dt">width =</span> <span class="dv">800</span>, <span class="dt">height =</span> <span class="dv">600</span>, <span class="dt">res =</span> <span class="dv">96</span>, <span class="dt">type =</span> <span class="st">&quot;cairo&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-11-1.gif" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># anim_save(&quot;poker_posterior_predictive.gif&quot;)</span></a></code></pre></div>
<p>Here is the same plot, but this time we make our life much easier by using the <code>add_predicted_draws()</code> function from the <code>"tidybayes"</code> package.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">df.predictive_samples2 =<span class="st"> </span>df.poker <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">  </span><span class="kw">add_predicted_draws</span>(fit.brm1, <span class="dt">n =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb15-3" title="3"></a>
<a class="sourceLine" id="cb15-4" title="4">p =<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df.predictive_samples2,</a>
<a class="sourceLine" id="cb15-5" title="5">            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> hand,</a>
<a class="sourceLine" id="cb15-6" title="6">                          <span class="dt">y =</span> .prediction,</a>
<a class="sourceLine" id="cb15-7" title="7">                          <span class="dt">fill =</span> hand)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb15-9" title="9">             <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="fl">0.1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</a>
<a class="sourceLine" id="cb15-11" title="11">               <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>,</a>
<a class="sourceLine" id="cb15-12" title="12">               <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun =</span> <span class="st">&quot;mean&quot;</span>,</a>
<a class="sourceLine" id="cb15-14" title="14">               <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</a>
<a class="sourceLine" id="cb15-15" title="15">               <span class="dt">shape =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb15-16" title="16">               <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;final balance (in Euros)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="st">  </span><span class="kw">transition_manual</span>(.draw)</a>
<a class="sourceLine" id="cb15-21" title="21"></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="kw">animate</span>(p, <span class="dt">nframes =</span> <span class="dv">120</span>, <span class="dt">width =</span> <span class="dv">800</span>, <span class="dt">height =</span> <span class="dv">600</span>, <span class="dt">res =</span> <span class="dv">96</span>, <span class="dt">type =</span> <span class="st">&quot;cairo&quot;</span>)</a></code></pre></div>
<pre><code>## nframes and fps adjusted to match transition</code></pre>
<p><img src="psych252_files/figure-html/bda3-12-1.gif" /><!-- --></p>
<p>And here I’ve used credible intervals instead of bootstrapped confidence intervals to illustrate the model’s uncertainty about the fitted means for each group.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">df.fitted_samples =<span class="st"> </span>df.poker <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw">add_fitted_draws</span>(fit.brm1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(hand) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="st">  </span><span class="kw">mean_hdci</span>(.value)</a>
<a class="sourceLine" id="cb17-5" title="5"></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.poker,</a>
<a class="sourceLine" id="cb17-7" title="7">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> hand,</a>
<a class="sourceLine" id="cb17-8" title="8">                     <span class="dt">y =</span> balance,</a>
<a class="sourceLine" id="cb17-9" title="9">                     <span class="dt">fill =</span> hand)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb17-11" title="11">             <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="fl">0.1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="dt">data =</span> df.fitted_samples, </a>
<a class="sourceLine" id="cb17-13" title="13">                  <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> hand,</a>
<a class="sourceLine" id="cb17-14" title="14">                                <span class="dt">y =</span> .value,</a>
<a class="sourceLine" id="cb17-15" title="15">                                <span class="dt">ymin =</span> .lower,</a>
<a class="sourceLine" id="cb17-16" title="16">                                <span class="dt">ymax =</span> .upper),</a>
<a class="sourceLine" id="cb17-17" title="17">                  <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun =</span> <span class="st">&quot;mean&quot;</span>,</a>
<a class="sourceLine" id="cb17-19" title="19">               <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</a>
<a class="sourceLine" id="cb17-20" title="20">               <span class="dt">shape =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb17-21" title="21">               <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-22" title="22"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;final balance (in Euros)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-23" title="23"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-24" title="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-13-1.png" width="672" /></p>
</div>
<div id="test-hypothesis" class="section level4">
<h4><span class="header-section-number">23.4.3.4</span> Test hypothesis</h4>
<p>One key advantage of Bayesian over frequentist analysis is that we can test hypothesis in a very flexible manner by directly probing our posterior samples in different ways.</p>
<p>We may ask, for example, what the probability is that the parameter for the difference between a bad hand and a neutral hand (<code>b_handneutral</code>) is greater than 0. Let’s plot the posterior distribution together with the criterion:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">fit.brm1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">  </span><span class="kw">select</span>(b_handneutral) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">everything</span>(),</a>
<a class="sourceLine" id="cb18-5" title="5">               <span class="dt">names_to =</span> <span class="st">&quot;variable&quot;</span>,</a>
<a class="sourceLine" id="cb18-6" title="6">               <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb18-8" title="8">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> variable, <span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="st">  </span><span class="kw">geom_halfeyeh</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb18-11" title="11">             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-14-1.png" width="672" /></p>
<p>We see that the posterior is definitely greater than 0.</p>
<p>We can ask many different kinds of questions about the data by doing basic arithmetic on our posterior samples. The <code>hypothesis()</code> function makes this even easier. Here are some examples:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># the probability that the posterior for handneutral is less than 0</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">hypothesis</span>(fit.brm1,</a>
<a class="sourceLine" id="cb19-3" title="3">           <span class="dt">hypothesis =</span> <span class="st">&quot;handneutral &lt; 0&quot;</span>)</a></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##          Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
## 1 (handneutral) &lt; 0     4.41      0.58     3.48     5.35          0         0
##   Star
## 1     
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># the probability that the posterior for handneutral is greater than 4</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">hypothesis</span>(fit.brm1,</a>
<a class="sourceLine" id="cb21-3" title="3">           <span class="dt">hypothesis =</span> <span class="st">&quot;handneutral &gt; 4&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># the probability that good hands make twice as much as bad hands</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">hypothesis</span>(fit.brm1,</a>
<a class="sourceLine" id="cb22-3" title="3">           <span class="dt">hypothesis =</span> <span class="st">&quot;Intercept + handgood &gt; 2 * Intercept&quot;</span>)</a></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##                 Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio
## 1 (Intercept+handgo... &gt; 0     1.18      0.93    -0.29     2.67        8.5
##   Post.Prob Star
## 1      0.89     
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>We can also make a plot of what the posterior distribution of the hypothesis looks like:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">hypothesis</span>(fit.brm1,</a>
<a class="sourceLine" id="cb24-2" title="2">           <span class="dt">hypothesis =</span> <span class="st">&quot;Intercept + handgood &gt; 2 * Intercept&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># the probability that neutral hands make less than the average of bad and good hands</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">hypothesis</span>(fit.brm1,</a>
<a class="sourceLine" id="cb25-3" title="3">           <span class="dt">hypothesis =</span> <span class="st">&quot;Intercept + handneutral &lt; (Intercept + Intercept + handgood) / 2&quot;</span>)</a></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##                 Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio
## 1 (Intercept+handne... &lt; 0     0.86       0.5     0.05     1.68       0.04
##   Post.Prob Star
## 1      0.04     
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>Let’s double check one example, and calculate the result directly based on the posterior samples:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">df.hypothesis =<span class="st"> </span>fit.brm1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">  </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;b_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">neutral =</span> b_intercept <span class="op">+</span><span class="st"> </span>b_handneutral,</a>
<a class="sourceLine" id="cb27-6" title="6">         <span class="dt">bad_good_average =</span> (b_intercept <span class="op">+</span><span class="st"> </span>b_intercept <span class="op">+</span><span class="st"> </span>b_handgood)<span class="op">/</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb27-7" title="7">         <span class="dt">hypothesis =</span> neutral <span class="op">&lt;</span><span class="st"> </span>bad_good_average)</a>
<a class="sourceLine" id="cb27-8" title="8"></a>
<a class="sourceLine" id="cb27-9" title="9">df.hypothesis <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">p =</span> <span class="kw">sum</span>(hypothesis)<span class="op">/</span><span class="kw">n</span>())</a></code></pre></div>
<pre><code>##         p
## 1 0.03975</code></pre>
</div>
<div id="model-comparison-2" class="section level4">
<h4><span class="header-section-number">23.4.3.5</span> Model comparison</h4>
<div id="bayes-factor" class="section level5">
<h5><span class="header-section-number">23.4.3.5.1</span> Bayes factor</h5>
<p>Another way of testing hypothesis is via the Bayes factor. Let’s fit the two models we are interested in comparing with each other:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">fit.brm2 =<span class="st"> </span><span class="kw">brm</span>(<span class="dt">formula =</span> balance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>hand,</a>
<a class="sourceLine" id="cb29-2" title="2">               <span class="dt">data =</span> df.poker,</a>
<a class="sourceLine" id="cb29-3" title="3">               <span class="dt">save_all_pars =</span> T,</a>
<a class="sourceLine" id="cb29-4" title="4">               <span class="dt">file =</span> <span class="st">&quot;cache/23/brm2&quot;</span>)</a>
<a class="sourceLine" id="cb29-5" title="5"></a>
<a class="sourceLine" id="cb29-6" title="6">fit.brm3 =<span class="st"> </span><span class="kw">brm</span>(<span class="dt">formula =</span> balance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>hand <span class="op">+</span><span class="st"> </span>skill,</a>
<a class="sourceLine" id="cb29-7" title="7">               <span class="dt">data =</span> df.poker,</a>
<a class="sourceLine" id="cb29-8" title="8">               <span class="dt">save_all_pars =</span> T,</a>
<a class="sourceLine" id="cb29-9" title="9">               <span class="dt">file =</span> <span class="st">&quot;cache/23/brm3&quot;</span>)</a></code></pre></div>
<p>And then compare the models useing the <code>bayes_factor()</code> function:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">bayes_factor</span>(fit.brm3, fit.brm2)</a></code></pre></div>
<pre><code>## Iteration: 1
## Iteration: 2
## Iteration: 3
## Iteration: 4
## Iteration: 1
## Iteration: 2
## Iteration: 3
## Iteration: 4</code></pre>
<pre><code>## Estimated Bayes factor in favor of fit.brm3 over fit.brm2: 3.81342</code></pre>
</div>
<div id="approximate-cross-validation" class="section level5">
<h5><span class="header-section-number">23.4.3.5.2</span> Approximate cross-validation</h5>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">fit.brm2 =<span class="st"> </span><span class="kw">add_criterion</span>(fit.brm2,</a>
<a class="sourceLine" id="cb33-2" title="2">                         <span class="dt">criterion =</span> <span class="kw">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>),</a>
<a class="sourceLine" id="cb33-3" title="3">                         <span class="dt">reloo =</span> T)</a></code></pre></div>
<pre><code>## No problematic observations found. Returning the original &#39;loo&#39; object.</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">fit.brm3 =<span class="st"> </span><span class="kw">add_criterion</span>(fit.brm3,</a>
<a class="sourceLine" id="cb35-2" title="2">                         <span class="dt">criterion =</span> <span class="kw">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>),</a>
<a class="sourceLine" id="cb35-3" title="3">                         <span class="dt">reloo =</span> T)</a></code></pre></div>
<pre><code>## No problematic observations found. Returning the original &#39;loo&#39; object.</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">loo_compare</span>(fit.brm2,</a>
<a class="sourceLine" id="cb37-2" title="2">            fit.brm3)</a></code></pre></div>
<pre><code>##          elpd_diff se_diff
## fit.brm3  0.0       0.0   
## fit.brm2 -0.3       1.5</code></pre>
</div>
</div>
<div id="full-specification" class="section level4">
<h4><span class="header-section-number">23.4.3.6</span> Full specification</h4>
<p>So far, we have used the defaults that <code>brm()</code> comes with and not bothered about specifiying the priors, etc.
##### Getting the priors</p>
<p>Notice that we didn’t specify any priors in the model. By default, “brms” assigns weakly informative priors to the parameters in the model. We can see what these are by running the following command:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">fit.brm1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="st">  </span><span class="kw">prior_summary</span>()</a></code></pre></div>
<pre><code>##                  prior     class        coef group resp dpar nlpar bound
## 1                              b                                        
## 2                              b    handgood                            
## 3                              b handneutral                            
## 4 student_t(3, 10, 10) Intercept                                        
## 5  student_t(3, 0, 10)     sigma</code></pre>
<p>We can also get information about which priors need to be specified before fitting a model:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">get_prior</span>(<span class="dt">formula =</span> balance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>hand,</a>
<a class="sourceLine" id="cb41-2" title="2">          <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>,</a>
<a class="sourceLine" id="cb41-3" title="3">          <span class="dt">data =</span> df.poker)</a></code></pre></div>
<pre><code>##                  prior     class        coef group resp dpar nlpar bound
## 1                              b                                        
## 2                              b    handgood                            
## 3                              b handneutral                            
## 4 student_t(3, 10, 10) Intercept                                        
## 5  student_t(3, 0, 10)     sigma</code></pre>
<p>Here is an example for what a more complete model specification could look like:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">fit.brm4 =<span class="st"> </span><span class="kw">brm</span>(<span class="dt">formula =</span> balance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>hand,</a>
<a class="sourceLine" id="cb43-2" title="2">               <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>,</a>
<a class="sourceLine" id="cb43-3" title="3">               <span class="dt">data =</span> df.poker,</a>
<a class="sourceLine" id="cb43-4" title="4">               <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">coef =</span> <span class="st">&quot;handgood&quot;</span>),</a>
<a class="sourceLine" id="cb43-5" title="5">                         <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">coef =</span> <span class="st">&quot;handneutral&quot;</span>),</a>
<a class="sourceLine" id="cb43-6" title="6">                         <span class="kw">prior</span>(<span class="kw">student_t</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">10</span>), <span class="dt">class =</span> <span class="st">&quot;Intercept&quot;</span>),</a>
<a class="sourceLine" id="cb43-7" title="7">                         <span class="kw">prior</span>(<span class="kw">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> <span class="st">&quot;sigma&quot;</span>)),</a>
<a class="sourceLine" id="cb43-8" title="8">               <span class="dt">inits =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">Intercept =</span> <span class="dv">0</span>, <span class="dt">sigma =</span> <span class="dv">1</span>, <span class="dt">handgood =</span> <span class="dv">5</span>, <span class="dt">handneutral =</span> <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb43-9" title="9">                            <span class="kw">list</span>(<span class="dt">Intercept =</span> <span class="dv">-5</span>, <span class="dt">sigma =</span> <span class="dv">3</span>, <span class="dt">handgood =</span> <span class="dv">2</span>, <span class="dt">handneutral =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb43-10" title="10">                            <span class="kw">list</span>(<span class="dt">Intercept =</span> <span class="dv">2</span>, <span class="dt">sigma =</span> <span class="dv">1</span>, <span class="dt">handgood =</span> <span class="dv">-1</span>, <span class="dt">handneutral =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb43-11" title="11">                            <span class="kw">list</span>(<span class="dt">Intercept =</span> <span class="dv">1</span>, <span class="dt">sigma =</span> <span class="dv">2</span>, <span class="dt">handgood =</span> <span class="dv">2</span>, <span class="dt">handneutral =</span> <span class="dv">-2</span>)),</a>
<a class="sourceLine" id="cb43-12" title="12">               <span class="dt">iter =</span> <span class="dv">4000</span>,</a>
<a class="sourceLine" id="cb43-13" title="13">               <span class="dt">warmup =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb43-14" title="14">               <span class="dt">chains =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb43-15" title="15">               <span class="dt">file =</span> <span class="st">&quot;cache/23/brm4&quot;</span>,</a>
<a class="sourceLine" id="cb43-16" title="16">               <span class="dt">seed =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb43-17" title="17"></a>
<a class="sourceLine" id="cb43-18" title="18">fit.brm4 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-19" title="19"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: balance ~ 1 + hand 
##    Data: df.poker (Number of observations: 300) 
## Samples: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 12000
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept       5.96      0.41     5.17     6.76 1.00    10540     8323
## handneutral     4.38      0.58     3.25     5.51 1.00    10732     8759
## handgood        7.05      0.58     5.91     8.13 1.00    11077     9673
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     4.13      0.17     3.81     4.49 1.00    11016     8475
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>We can also take a look at the Stan code that the <code>brm()</code> function creates:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">fit.brm4 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="st">  </span><span class="kw">stancode</span>()</a></code></pre></div>
<pre><code>## // generated with brms 2.10.0
## functions {
## }
## data {
##   int&lt;lower=1&gt; N;  // number of observations
##   vector[N] Y;  // response variable
##   int&lt;lower=1&gt; K;  // number of population-level effects
##   matrix[N, K] X;  // population-level design matrix
##   int prior_only;  // should the likelihood be ignored?
## }
## transformed data {
##   int Kc = K - 1;
##   matrix[N, Kc] Xc;  // centered version of X without an intercept
##   vector[Kc] means_X;  // column means of X before centering
##   for (i in 2:K) {
##     means_X[i - 1] = mean(X[, i]);
##     Xc[, i - 1] = X[, i] - means_X[i - 1];
##   }
## }
## parameters {
##   vector[Kc] b;  // population-level effects
##   // temporary intercept for centered predictors
##   real Intercept;
##   real&lt;lower=0&gt; sigma;  // residual SD
## }
## transformed parameters {
## }
## model {
##   // priors including all constants
##   target += normal_lpdf(b[1] | 0, 10);
##   target += normal_lpdf(b[2] | 0, 10);
##   target += student_t_lpdf(Intercept | 3, 3, 10);
##   target += student_t_lpdf(sigma | 3, 0, 10)
##     - 1 * student_t_lccdf(0 | 3, 0, 10);
##   // likelihood including all constants
##   if (!prior_only) {
##     target += normal_id_glm_lpdf(Y | Xc, Intercept, b, sigma);
##   }
## }
## generated quantities {
##   // actual population-level intercept
##   real b_Intercept = Intercept - dot_product(means_X, b);
## }</code></pre>
<p>One thing worth noticing: by default, “brms” centers the predictors which makes it easier to assign a default prior over the intercept.</p>
<div id="prior-predictive-check-1" class="section level5">
<h5><span class="header-section-number">23.4.3.6.1</span> Prior predictive check</h5>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">fit.brm4.prior =<span class="st"> </span><span class="kw">brm</span>(<span class="dt">formula =</span> balance <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>intercept <span class="op">+</span><span class="st"> </span>hand,</a>
<a class="sourceLine" id="cb47-2" title="2">               <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>,</a>
<a class="sourceLine" id="cb47-3" title="3">               <span class="dt">data =</span> df.poker,</a>
<a class="sourceLine" id="cb47-4" title="4">               <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> <span class="st">&quot;b&quot;</span>),</a>
<a class="sourceLine" id="cb47-5" title="5">                         <span class="kw">prior</span>(<span class="kw">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> <span class="st">&quot;sigma&quot;</span>)),</a>
<a class="sourceLine" id="cb47-6" title="6">               <span class="dt">iter =</span> <span class="dv">4000</span>,</a>
<a class="sourceLine" id="cb47-7" title="7">               <span class="dt">warmup =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb47-8" title="8">               <span class="dt">chains =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb47-9" title="9">               <span class="dt">file =</span> <span class="st">&quot;cache/23/brm4prior&quot;</span>,</a>
<a class="sourceLine" id="cb47-10" title="10">               <span class="dt">sample_prior =</span> <span class="st">&quot;only&quot;</span>,</a>
<a class="sourceLine" id="cb47-11" title="11">               <span class="dt">seed =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb47-12" title="12"></a>
<a class="sourceLine" id="cb47-13" title="13"><span class="co"># generate prior samples </span></a>
<a class="sourceLine" id="cb47-14" title="14">df.prior_samples =<span class="st"> </span>fit.brm4.prior <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-15" title="15"><span class="st">  </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-16" title="16"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-17" title="17"><span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;b_&quot;</span>), sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-18" title="18"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> <span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-19" title="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-20" title="20"><span class="st">  </span><span class="kw">group_by</span>(sample) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-21" title="21"><span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-22" title="22"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">bad =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>b_intercept <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">sd =</span> .<span class="op">$</span>sigma)),</a>
<a class="sourceLine" id="cb47-23" title="23">         <span class="dt">neutral =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>b_intercept <span class="op">+</span><span class="st"> </span>.<span class="op">$</span>b_handneutral <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">sd =</span> .<span class="op">$</span>sigma)),</a>
<a class="sourceLine" id="cb47-24" title="24">         <span class="dt">good =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>b_intercept <span class="op">+</span><span class="st"> </span>.<span class="op">$</span>b_handgood <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">sd =</span> .<span class="op">$</span>sigma))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-25" title="25"><span class="st">  </span><span class="kw">unnest</span>(<span class="kw">c</span>(bad, neutral, good)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-26" title="26"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>data)</a>
<a class="sourceLine" id="cb47-27" title="27"></a>
<a class="sourceLine" id="cb47-28" title="28"><span class="co"># plot the results as an animation</span></a>
<a class="sourceLine" id="cb47-29" title="29">p =<span class="st"> </span>df.prior_samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-30" title="30"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>sample,</a>
<a class="sourceLine" id="cb47-31" title="31">               <span class="dt">names_to =</span> <span class="st">&quot;hand&quot;</span>,</a>
<a class="sourceLine" id="cb47-32" title="32">               <span class="dt">values_to =</span> <span class="st">&quot;balance&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-33" title="33"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hand =</span> <span class="kw">factor</span>(hand, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;bad&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;good&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-34" title="34"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> hand,</a>
<a class="sourceLine" id="cb47-35" title="35">                       <span class="dt">y =</span> balance,</a>
<a class="sourceLine" id="cb47-36" title="36">                       <span class="dt">fill =</span> hand)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-37" title="37"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb47-38" title="38">             <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="fl">0.1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-39" title="39"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</a>
<a class="sourceLine" id="cb47-40" title="40">               <span class="dt">geom =</span> <span class="st">&quot;linerange&quot;</span>,</a>
<a class="sourceLine" id="cb47-41" title="41">               <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-42" title="42"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun =</span> <span class="st">&quot;mean&quot;</span>,</a>
<a class="sourceLine" id="cb47-43" title="43">               <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</a>
<a class="sourceLine" id="cb47-44" title="44">               <span class="dt">shape =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb47-45" title="45">               <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-46" title="46"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;final balance (in Euros)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-47" title="47"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-48" title="48"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-49" title="49"><span class="st">  </span><span class="kw">transition_manual</span>(sample)</a>
<a class="sourceLine" id="cb47-50" title="50"></a>
<a class="sourceLine" id="cb47-51" title="51"><span class="kw">animate</span>(p, <span class="dt">nframes =</span> <span class="dv">120</span>, <span class="dt">width =</span> <span class="dv">800</span>, <span class="dt">height =</span> <span class="dv">600</span>, <span class="dt">res =</span> <span class="dv">96</span>, <span class="dt">type =</span> <span class="st">&quot;cairo&quot;</span>)</a></code></pre></div>
<pre><code>## nframes and fps adjusted to match transition</code></pre>
<p><img src="psych252_files/figure-html/bda3-28-1.gif" /><!-- --></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co"># anim_save(&quot;poker_prior_predictive.gif&quot;)</span></a></code></pre></div>
</div>
</div>
<div id="inference-diagnostics" class="section level4">
<h4><span class="header-section-number">23.4.3.7</span> Inference diagnostics</h4>
<p>So far, we’ve assumed that the inference has worked out. We can check this by running plot() on our brm object:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">plot</span>(fit.brm1)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-29-1.png" width="960" /></p>
<p>Let’s make our own version of a trace plot for one parameter in the model:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">fit.brm1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="st">  </span><span class="kw">spread_draws</span>(b_Intercept) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">chain =</span> <span class="kw">as.factor</span>(chain)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> iteration, <span class="dt">y =</span> b_intercept, <span class="dt">group =</span> chain, <span class="dt">color =</span> chain)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-6" title="6"><span class="st">  </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-30-1.png" width="672" /></p>
<p>We can also take a look at the auto-correlation plot. Ideally, we want to generate independent samples from the posterior. So we don’t want subsequent samples to be strongly correlated with each other. Let’s take a look:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">variables =<span class="st"> </span>fit.brm1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="st">  </span><span class="kw">get_variables</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-3" title="3"><span class="st">  </span>.[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</a>
<a class="sourceLine" id="cb52-4" title="4"></a>
<a class="sourceLine" id="cb52-5" title="5">fit.brm1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-6" title="6"><span class="st">  </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-7" title="7"><span class="st">  </span><span class="kw">mcmc_acf</span>(<span class="dt">pars =</span> variables,</a>
<a class="sourceLine" id="cb52-8" title="8">           <span class="dt">lags =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-31-1.png" width="672" /></p>
<p>Looking good! The autocorrelation should become very small as the lag increases (indicating that we are getting independent samples from the posterior).</p>
<div id="when-things-go-wrong" class="section level5">
<h5><span class="header-section-number">23.4.3.7.1</span> When things go wrong</h5>
<p>Let’s try to fit a model to very little data (just two observations) with extremely uninformative priors:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">df.data =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">y =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb53-2" title="2"></a>
<a class="sourceLine" id="cb53-3" title="3">fit.brm5 =<span class="st"> </span><span class="kw">brm</span>(<span class="dt">data =</span> df.data,</a>
<a class="sourceLine" id="cb53-4" title="4">               <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb53-5" title="5">               <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb53-6" title="6">               <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">uniform</span>(<span class="op">-</span><span class="fl">1e10</span>, <span class="fl">1e10</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb53-7" title="7">                         <span class="kw">prior</span>(<span class="kw">uniform</span>(<span class="dv">0</span>, <span class="fl">1e10</span>), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb53-8" title="8">               <span class="dt">inits =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">Intercept =</span> <span class="dv">0</span>, <span class="dt">sigma =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb53-9" title="9">                            <span class="kw">list</span>(<span class="dt">Intercept =</span> <span class="dv">0</span>, <span class="dt">sigma =</span> <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb53-10" title="10">               <span class="dt">iter =</span> <span class="dv">4000</span>,</a>
<a class="sourceLine" id="cb53-11" title="11">               <span class="dt">warmup =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb53-12" title="12">               <span class="dt">chains =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb53-13" title="13">               <span class="dt">file =</span> <span class="st">&quot;cache/23/brm5&quot;</span>)</a></code></pre></div>
<p>Let’s take a look at the posterior distributions of the model parameters:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">summary</span>(fit.brm5)</a></code></pre></div>
<pre><code>## Warning: Parts of the model have not converged (some Rhats are &gt; 1.05). Be
## careful when analysing the results! We recommend running more iterations and/or
## setting stronger priors.</code></pre>
<pre><code>## Warning: There were 1203 divergent transitions after warmup.
## Increasing adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
## warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: y ~ 1 
##    Data: df.data (Number of observations: 2) 
## Samples: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 6000
## 
## Population-Level Effects: 
##               Estimate     Est.Error       l-95% CI      u-95% CI Rhat Bulk_ESS
## Intercept 357550121.58 1416057299.71 -2244033111.47 3333594132.43 1.78        3
##           Tail_ESS
## Intercept       24
## 
## Family Specific Parameters: 
##            Estimate     Est.Error l-95% CI      u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma 1524412740.64 2392424321.98 21668.93 8317582240.06 1.40        4       41
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Not looking good – The estimates and credible intervals are off the charts. And the effective samples sizes in the chains are very small.</p>
<p>Let’s visualize the trace plots:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">plot</span>(fit.brm5)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-34-1.png" width="1152" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">fit.brm5 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="st">  </span><span class="kw">spread_draws</span>(b_Intercept) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">chain =</span> <span class="kw">as.factor</span>(chain)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> iteration,</a>
<a class="sourceLine" id="cb59-6" title="6">             <span class="dt">y =</span> b_intercept,</a>
<a class="sourceLine" id="cb59-7" title="7">             <span class="dt">group =</span> chain,</a>
<a class="sourceLine" id="cb59-8" title="8">             <span class="dt">color =</span> chain)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-35-1.png" width="672" /></p>
<p>Given that we have so little data in this case, we need to help the model a little bit by providing some slighlty more specific priors.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">fit.brm6 =<span class="st"> </span><span class="kw">brm</span>(<span class="dt">data =</span> df.data,</a>
<a class="sourceLine" id="cb60-2" title="2">               <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb60-3" title="3">               <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb60-4" title="4">               <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> Intercept), <span class="co"># more reasonable priors</span></a>
<a class="sourceLine" id="cb60-5" title="5">                         <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb60-6" title="6">               <span class="dt">iter =</span> <span class="dv">4000</span>,</a>
<a class="sourceLine" id="cb60-7" title="7">               <span class="dt">warmup =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb60-8" title="8">               <span class="dt">chains =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb60-9" title="9">               <span class="dt">seed =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb60-10" title="10">               <span class="dt">file =</span> <span class="st">&quot;cache/23/brm6&quot;</span>)</a></code></pre></div>
<p>Let’s take a look at the posterior distributions of the model parameters:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">summary</span>(fit.brm6)</a></code></pre></div>
<pre><code>## Warning: There were 3 divergent transitions after warmup. Increasing adapt_delta
## above 0.8 may help. See http://mc-stan.org/misc/warnings.html#divergent-
## transitions-after-warmup</code></pre>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: y ~ 1 
##    Data: df.data (Number of observations: 2) 
## Samples: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 6000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -0.13      1.69    -4.10     3.06 1.00     1352      909
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     2.04      1.88     0.61     6.95 1.00     1144     1426
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>This looks much better. There is still quite a bit of uncertainty in our paremeter estimates, but it has reduced dramatically.</p>
<p>Let’s visualize the trace plots:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">plot</span>(fit.brm6)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">fit.brm6 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="st">  </span><span class="kw">spread_draws</span>(b_Intercept, sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">chain =</span> <span class="kw">as.factor</span>(chain)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-5" title="5"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(b_intercept, sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> iteration,</a>
<a class="sourceLine" id="cb65-7" title="7">             <span class="dt">y =</span> value,</a>
<a class="sourceLine" id="cb65-8" title="8">             <span class="dt">group =</span> chain,</a>
<a class="sourceLine" id="cb65-9" title="9">             <span class="dt">color =</span> chain)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-10" title="10"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-11" title="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(name), <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-39-1.png" width="672" /></p>
<p>Looking mostly good!</p>
</div>
</div>
</div>
</div>
<div id="sleep-study" class="section level2">
<h2><span class="header-section-number">23.5</span> Sleep study</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">df.sleep =<span class="st"> </span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-2" title="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subject =</span> <span class="kw">as.character</span>(subject)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-5" title="5"><span class="st">  </span><span class="kw">select</span>(subject, days, reaction) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-6" title="6"><span class="st">  </span><span class="kw">bind_rows</span>(<span class="kw">tibble</span>(<span class="dt">subject =</span> <span class="st">&quot;374&quot;</span>,</a>
<a class="sourceLine" id="cb66-7" title="7">                   <span class="dt">days =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb66-8" title="8">                   <span class="dt">reaction =</span> <span class="kw">c</span>(<span class="dv">286</span>, <span class="dv">288</span>)),</a>
<a class="sourceLine" id="cb66-9" title="9">            <span class="kw">tibble</span>(<span class="dt">subject =</span> <span class="st">&quot;373&quot;</span>,</a>
<a class="sourceLine" id="cb66-10" title="10">                   <span class="dt">days =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb66-11" title="11">                   <span class="dt">reaction =</span> <span class="dv">245</span>))</a></code></pre></div>
<div id="frequentist-analysis-1" class="section level3">
<h3><span class="header-section-number">23.5.1</span> Frequentist analysis</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">fit.lmer =<span class="st"> </span><span class="kw">lmer</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">|</span><span class="st"> </span>subject),</a>
<a class="sourceLine" id="cb67-2" title="2">                <span class="dt">data =</span> df.sleep)</a></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">fit.lmer <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: reaction ~ 1 + days + (1 + days | subject)
##    Data: df.sleep
## 
## REML criterion at convergence: 1771.4
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.9707 -0.4703  0.0276  0.4594  5.2009 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  subject  (Intercept) 582.73   24.140       
##           days         35.03    5.919   0.07
##  Residual             649.36   25.483       
## Number of obs: 183, groups:  subject, 20
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  252.543      6.433  39.256
## days          10.452      1.542   6.778
## 
## Correlation of Fixed Effects:
##      (Intr)
## days -0.137</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">fit.lmer <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb70-2" title="2"><span class="st">  </span><span class="kw">confint</span>()</a></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<pre><code>##                   2.5 %      97.5 %
## .sig01       14.2566758  36.2783159
## .sig02       -0.4720036   0.6823153
## .sig03        3.8063695   8.7363330
## .sigma       22.8116539  28.7123101
## (Intercept) 239.6584255 265.4573030
## days          7.3471481  13.5529113</code></pre>
</div>
<div id="bayesian-analysis" class="section level3">
<h3><span class="header-section-number">23.5.2</span> Bayesian analysis</h3>
<div id="fit-the-model-1" class="section level4">
<h4><span class="header-section-number">23.5.2.1</span> Fit the model</h4>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">fit.brm7 =<span class="st"> </span><span class="kw">brm</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">|</span><span class="st"> </span>subject),</a>
<a class="sourceLine" id="cb73-2" title="2">               <span class="dt">data =</span> df.sleep,</a>
<a class="sourceLine" id="cb73-3" title="3">               <span class="dt">file =</span> <span class="st">&quot;cache/23/brm7&quot;</span>)</a></code></pre></div>
</div>
<div id="check-the-model-diagnostics" class="section level4">
<h4><span class="header-section-number">23.5.2.2</span> Check the model diagnostics</h4>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">fit.brm7 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: reaction ~ 1 + days + (1 + days | subject) 
##    Data: df.sleep (Number of observations: 183) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Group-Level Effects: 
## ~subject (Number of levels: 20) 
##                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)          26.18      6.25    15.65    40.54 1.00     1879     2463
## sd(days)                6.59      1.53     4.14    10.13 1.00     1145     1625
## cor(Intercept,days)     0.09      0.29    -0.46     0.67 1.00      993     1526
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   252.18      6.86   238.47   265.42 1.00     1826     2766
## days         10.46      1.69     7.13    13.78 1.00     1203     1782
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    25.77      1.57    22.93    29.14 1.00     3864     2773
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">fit.brm7 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">N =</span> <span class="dv">6</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-44-1.png" width="768" /></p>
</div>
<div id="validate-the-model" class="section level4">
<h4><span class="header-section-number">23.5.2.3</span> Validate the model</h4>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">pp_check</span>(fit.brm7,</a>
<a class="sourceLine" id="cb77-2" title="2">         <span class="dt">nsamples =</span> <span class="dv">100</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-45-1.png" width="672" /></p>
</div>
<div id="interpret-the-parameters" class="section level4">
<h4><span class="header-section-number">23.5.2.4</span> Interpret the parameters</h4>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">fit.brm7 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-3" title="3"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-4" title="4"><span class="st">  </span><span class="kw">kable_styling</span>()</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
component
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
252.18
</td>
<td style="text-align:right;">
6.86
</td>
<td style="text-align:right;">
238.47
</td>
<td style="text-align:right;">
265.42
</td>
</tr>
<tr>
<td style="text-align:left;">
fixed
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
days
</td>
<td style="text-align:right;">
10.46
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
7.13
</td>
<td style="text-align:right;">
13.78
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
subject
</td>
<td style="text-align:left;">
sd__(Intercept)
</td>
<td style="text-align:right;">
26.18
</td>
<td style="text-align:right;">
6.25
</td>
<td style="text-align:right;">
15.65
</td>
<td style="text-align:right;">
40.54
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
subject
</td>
<td style="text-align:left;">
sd__days
</td>
<td style="text-align:right;">
6.59
</td>
<td style="text-align:right;">
1.53
</td>
<td style="text-align:right;">
4.14
</td>
<td style="text-align:right;">
10.13
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
subject
</td>
<td style="text-align:left;">
cor__(Intercept).days
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
-0.46
</td>
<td style="text-align:right;">
0.67
</td>
</tr>
<tr>
<td style="text-align:left;">
ran_pars
</td>
<td style="text-align:left;">
cond
</td>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:left;">
sd__Observation
</td>
<td style="text-align:right;">
25.77
</td>
<td style="text-align:right;">
1.57
</td>
<td style="text-align:right;">
22.93
</td>
<td style="text-align:right;">
29.14
</td>
</tr>
</tbody>
</table>
</div>
<div id="visualize-the-results" class="section level4">
<h4><span class="header-section-number">23.5.2.5</span> Visualize the results</h4>
<div id="summary-of-posterior-distributions" class="section level5">
<h5><span class="header-section-number">23.5.2.5.1</span> Summary of posterior distributions</h5>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">fit.brm7 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="st">  </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(lp__, <span class="kw">contains</span>(<span class="st">&quot;subject&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb79-4" title="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">everything</span>(),</a>
<a class="sourceLine" id="cb79-5" title="5">               <span class="dt">names_to =</span> <span class="st">&quot;variable&quot;</span>,</a>
<a class="sourceLine" id="cb79-6" title="6">               <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb79-8" title="8">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> variable,</a>
<a class="sourceLine" id="cb79-9" title="9">                       <span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb79-10" title="10"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">fun.data =</span> mode_hdih)</a></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: fun.data</code></pre>
<p><img src="psych252_files/figure-html/bda3-47-1.png" width="672" /></p>
</div>
<div id="comparison-with-data" class="section level5">
<h5><span class="header-section-number">23.5.2.5.2</span> Comparison with data</h5>
<div id="model-prediction-with-credible-intervals" class="section level6">
<h6><span class="header-section-number">23.5.2.5.2.1</span> Model prediction with credible intervals</h6>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">fit.brm7 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-2" title="2"><span class="st">  </span><span class="kw">fitted</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-3" title="3"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-4" title="4"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-5" title="5"><span class="st">  </span><span class="kw">bind_cols</span>(df.sleep) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb81-7" title="7">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days,</a>
<a class="sourceLine" id="cb81-8" title="8">                     <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-9" title="9"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> q2_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb81-10" title="10">                  <span class="dt">ymax =</span> q97_<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb81-11" title="11">              <span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb81-12" title="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> estimate),</a>
<a class="sourceLine" id="cb81-13" title="13">            <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb81-14" title="14"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb81-15" title="15"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subject, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb81-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb81-17" title="17">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb81-18" title="18"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb81-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb81-20" title="20">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<pre><code>## geom_path: Each group consists of only one observation. Do you need to adjust
## the group aesthetic?</code></pre>
<p><img src="psych252_files/figure-html/bda3-48-1.png" width="672" /></p>
</div>
<div id="model-prediction-for-random-samples" class="section level6">
<h6><span class="header-section-number">23.5.2.5.2.2</span> Model prediction for random samples</h6>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">df.model =<span class="st"> </span>df.sleep <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="st">  </span><span class="kw">complete</span>(subject, days) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-3" title="3"><span class="st">  </span><span class="kw">add_fitted_draws</span>(<span class="dt">newdata =</span> .,</a>
<a class="sourceLine" id="cb83-4" title="4">                   <span class="dt">model =</span> fit.brm7,</a>
<a class="sourceLine" id="cb83-5" title="5">                   <span class="dt">n =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb83-6" title="6">                   <span class="dt">seed =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb83-7" title="7"></a>
<a class="sourceLine" id="cb83-8" title="8">df.sleep <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-9" title="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb83-10" title="10">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days,</a>
<a class="sourceLine" id="cb83-11" title="11">                       <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-12" title="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df.model,</a>
<a class="sourceLine" id="cb83-13" title="13">            <span class="kw">aes</span>(<span class="dt">y =</span> .value,</a>
<a class="sourceLine" id="cb83-14" title="14">                <span class="dt">group =</span> .draw),</a>
<a class="sourceLine" id="cb83-15" title="15">            <span class="dt">color =</span> <span class="st">&quot;lightblue&quot;</span>,</a>
<a class="sourceLine" id="cb83-16" title="16">            <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-17" title="17"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb83-18" title="18"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subject, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb83-19" title="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb83-20" title="20">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-21" title="21"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb83-22" title="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb83-23" title="23">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-49-1.png" width="672" /></p>
</div>
<div id="animated-model-prediction-for-random-samples" class="section level6">
<h6><span class="header-section-number">23.5.2.5.2.3</span> Animated model prediction for random samples</h6>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">df.model =<span class="st"> </span>df.sleep <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-2" title="2"><span class="st">  </span><span class="kw">complete</span>(subject, days) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-3" title="3"><span class="st">  </span><span class="kw">add_fitted_draws</span>(<span class="dt">newdata =</span> .,</a>
<a class="sourceLine" id="cb84-4" title="4">                   <span class="dt">model =</span> fit.brm7,</a>
<a class="sourceLine" id="cb84-5" title="5">                   <span class="dt">n =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb84-6" title="6">                   <span class="dt">seed =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb84-7" title="7"></a>
<a class="sourceLine" id="cb84-8" title="8">p =<span class="st"> </span>df.sleep <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-9" title="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb84-10" title="10">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days,</a>
<a class="sourceLine" id="cb84-11" title="11">                       <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-12" title="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df.model,</a>
<a class="sourceLine" id="cb84-13" title="13">            <span class="kw">aes</span>(<span class="dt">y =</span> .value,</a>
<a class="sourceLine" id="cb84-14" title="14">                <span class="dt">group =</span> .draw),</a>
<a class="sourceLine" id="cb84-15" title="15">            <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-16" title="16"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb84-17" title="17"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subject, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb84-18" title="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb84-19" title="19">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-20" title="20"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb84-21" title="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb84-22" title="22">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-23" title="23"><span class="st">  </span><span class="kw">transition_states</span>(.draw, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb84-24" title="24"><span class="st">  </span><span class="kw">shadow_mark</span>(<span class="dt">past =</span> <span class="ot">TRUE</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;gray50&quot;</span>)</a>
<a class="sourceLine" id="cb84-25" title="25"></a>
<a class="sourceLine" id="cb84-26" title="26"><span class="kw">animate</span>(p, <span class="dt">nframes =</span> <span class="dv">10</span>, <span class="dt">fps =</span> <span class="fl">2.5</span>, <span class="dt">width =</span> <span class="dv">800</span>, <span class="dt">height =</span> <span class="dv">600</span>, <span class="dt">res =</span> <span class="dv">96</span>, <span class="dt">type =</span> <span class="st">&quot;cairo&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-50-1.gif" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">anim_save</span>(<span class="st">&quot;sleep_posterior_predictive.gif&quot;</span>)</a></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="titanic-study" class="section level2">
<h2><span class="header-section-number">23.6</span> Titanic study</h2>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">df.titanic =<span class="st"> </span>titanic_train <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">as.factor</span>(sex))</a></code></pre></div>
<div id="frequentist-analysis-2" class="section level3">
<h3><span class="header-section-number">23.6.1</span> Frequentist analysis</h3>
<div id="fit-the-model-2" class="section level4">
<h4><span class="header-section-number">23.6.1.1</span> Fit the model</h4>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">fit.glm =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>fare <span class="op">+</span><span class="st"> </span>sex,</a>
<a class="sourceLine" id="cb87-2" title="2">              <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb87-3" title="3">              <span class="dt">data =</span> df.titanic)</a>
<a class="sourceLine" id="cb87-4" title="4"></a>
<a class="sourceLine" id="cb87-5" title="5">fit.glm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-6" title="6"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = survived ~ 1 + fare + sex, family = &quot;binomial&quot;, 
##     data = df.titanic)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2082  -0.6208  -0.5824   0.8126   1.9658  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.647100   0.148502   4.358 1.32e-05 ***
## fare         0.011214   0.002295   4.886 1.03e-06 ***
## sexmale     -2.422760   0.170515 -14.208  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1186.66  on 890  degrees of freedom
## Residual deviance:  884.31  on 888  degrees of freedom
## AIC: 890.31
## 
## Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div id="visualize-the-results-1" class="section level4">
<h4><span class="header-section-number">23.6.1.2</span> Visualize the results</h4>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">df.titanic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">as.factor</span>(sex)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb89-4" title="4">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> fare,</a>
<a class="sourceLine" id="cb89-5" title="5">                       <span class="dt">y =</span> survived,</a>
<a class="sourceLine" id="cb89-6" title="6">                       <span class="dt">color =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb89-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-8" title="8"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>,</a>
<a class="sourceLine" id="cb89-9" title="9">              <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>),</a>
<a class="sourceLine" id="cb89-10" title="10">              <span class="dt">alpha =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb89-11" title="11">              <span class="kw">aes</span>(<span class="dt">fill =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb89-12" title="12"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/bda3-53-1.png" width="672" /></p>
</div>
</div>
<div id="bayesian-anaysis" class="section level3">
<h3><span class="header-section-number">23.6.2</span> Bayesian anaysis</h3>
<div id="fit-the-model-3" class="section level4">
<h4><span class="header-section-number">23.6.2.1</span> Fit the model</h4>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">fit.brm8 =<span class="st"> </span><span class="kw">brm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>fare <span class="op">+</span><span class="st"> </span>sex,</a>
<a class="sourceLine" id="cb91-2" title="2">               <span class="dt">family =</span> <span class="st">&quot;bernoulli&quot;</span>,</a>
<a class="sourceLine" id="cb91-3" title="3">               <span class="dt">data =</span> df.titanic,</a>
<a class="sourceLine" id="cb91-4" title="4">               <span class="dt">file =</span> <span class="st">&quot;cache/23/brm8&quot;</span>,</a>
<a class="sourceLine" id="cb91-5" title="5">               <span class="dt">seed =</span> <span class="dv">1</span>)</a></code></pre></div>
</div>
<div id="check-the-model-diagnostics-1" class="section level4">
<h4><span class="header-section-number">23.6.2.2</span> Check the model diagnostics</h4>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">fit.brm8 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: survived ~ 1 + fare + sex 
##    Data: df.titanic (Number of observations: 891) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.64      0.15     0.35     0.93 1.00     3446     3198
## fare          0.01      0.00     0.01     0.02 1.00     5268     2420
## sexmale      -2.43      0.17    -2.76    -2.10 1.00     2959     2502
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">fit.brm8 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-55-1.png" width="960" /></p>
</div>
<div id="validate-the-model-1" class="section level4">
<h4><span class="header-section-number">23.6.2.3</span> Validate the model</h4>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">pp_check</span>(fit.brm8,</a>
<a class="sourceLine" id="cb95-2" title="2">         <span class="dt">nsamples =</span> <span class="dv">100</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-56-1.png" width="672" /></p>
<p>Let’s visualize what the posterior predictive would have looked like for a linear model (instead of a logistic model).</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">fit.brm9 =<span class="st"> </span><span class="kw">brm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>fare <span class="op">+</span><span class="st"> </span>sex,</a>
<a class="sourceLine" id="cb96-2" title="2">               <span class="dt">data =</span> df.titanic,</a>
<a class="sourceLine" id="cb96-3" title="3">               <span class="dt">file =</span> <span class="st">&quot;cache/23/brm9&quot;</span>,</a>
<a class="sourceLine" id="cb96-4" title="4">               <span class="dt">seed =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb96-5" title="5"></a>
<a class="sourceLine" id="cb96-6" title="6"><span class="kw">pp_check</span>(fit.brm9,</a>
<a class="sourceLine" id="cb96-7" title="7">         <span class="dt">nsamples =</span> <span class="dv">100</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-57-1.png" width="672" /></p>
</div>
<div id="interpret-the-parameters-1" class="section level4">
<h4><span class="header-section-number">23.6.2.4</span> Interpret the parameters</h4>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">fit.brm8 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb97-2" title="2"><span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb97-3" title="3"><span class="st">  </span><span class="kw">select</span>(estimate<span class="op">:</span>conf.high) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb97-4" title="4"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb97-5" title="5"><span class="st">  </span><span class="kw">kable_styling</span>()</a></code></pre></div>
<pre><code>## Warning in stri_replace_first_regex(string, pattern,
## fix_replacement(replacement), : argument is not an atomic vector; coercing</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.93
</td>
</tr>
<tr>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
<tr>
<td style="text-align:right;">
-2.43
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
-2.76
</td>
<td style="text-align:right;">
-2.10
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">fit.brm8 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-2" title="2"><span class="st">  </span><span class="kw">ggpredict</span>(<span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;fare [0:500]&quot;</span>, <span class="st">&quot;sex&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-3" title="3"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-59-1.png" width="672" /></p>
</div>
<div id="visualize-the-results-2" class="section level4">
<h4><span class="header-section-number">23.6.2.5</span> Visualize the results</h4>
<div id="summary-of-posterior-distributions-1" class="section level5">
<h5><span class="header-section-number">23.6.2.5.1</span> Summary of posterior distributions</h5>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">fit.brm8 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb100-2" title="2"><span class="st">  </span><span class="kw">posterior_samples</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb100-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>lp__) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb100-4" title="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">everything</span>(),</a>
<a class="sourceLine" id="cb100-5" title="5">               <span class="dt">names_to =</span> <span class="st">&quot;variable&quot;</span>,</a>
<a class="sourceLine" id="cb100-6" title="6">               <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb100-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb100-8" title="8">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> variable,</a>
<a class="sourceLine" id="cb100-9" title="9">                       <span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-10" title="10"><span class="st">  </span><span class="kw">stat_intervalh</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb100-11" title="11"><span class="st">  </span><span class="kw">scale_color_brewer</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-60-1.png" width="672" /></p>
</div>
<div id="comparison-with-data-1" class="section level5">
<h5><span class="header-section-number">23.6.2.5.2</span> Comparison with data</h5>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">df.model =<span class="st"> </span><span class="kw">add_fitted_draws</span>(<span class="dt">newdata =</span> <span class="kw">expand_grid</span>(<span class="dt">sex =</span> <span class="kw">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>),</a>
<a class="sourceLine" id="cb101-2" title="2">                                                  <span class="dt">fare =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">500</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-3" title="3"><span class="st">                              </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">factor</span>(sex, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>))),</a>
<a class="sourceLine" id="cb101-4" title="4">                            <span class="dt">model =</span> fit.brm8,</a>
<a class="sourceLine" id="cb101-5" title="5">                            <span class="dt">n =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb101-6" title="6"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.titanic,</a>
<a class="sourceLine" id="cb101-7" title="7">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> fare,</a>
<a class="sourceLine" id="cb101-8" title="8">                     <span class="dt">y =</span> survived,</a>
<a class="sourceLine" id="cb101-9" title="9">                     <span class="dt">color =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-11" title="11"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df.model <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-12" title="12"><span class="st">              </span><span class="kw">filter</span>(sex <span class="op">==</span><span class="st"> &quot;male&quot;</span>),</a>
<a class="sourceLine" id="cb101-13" title="13">            <span class="kw">aes</span>(<span class="dt">y =</span> .value,</a>
<a class="sourceLine" id="cb101-14" title="14">                <span class="dt">group =</span> .draw,</a>
<a class="sourceLine" id="cb101-15" title="15">                <span class="dt">color =</span> sex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-16" title="16"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df.model <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-17" title="17"><span class="st">              </span><span class="kw">filter</span>(sex <span class="op">==</span><span class="st"> &quot;female&quot;</span>),</a>
<a class="sourceLine" id="cb101-18" title="18">            <span class="kw">aes</span>(<span class="dt">y =</span> .value,</a>
<a class="sourceLine" id="cb101-19" title="19">                <span class="dt">group =</span> .draw,</a>
<a class="sourceLine" id="cb101-20" title="20">                <span class="dt">color =</span> sex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-21" title="21"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/bda3-61-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
<div id="additional-resources-16" class="section level2">
<h2><span class="header-section-number">23.7</span> Additional resources</h2>
<ul>
<li><a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html">Tutorial on visualizing brms posteriors with tidybayes</a></li>
<li><a href="https://mucollective.northwestern.edu/files/2018-HOPsTrends-InfoVis.pdf">Hypothetical outcome plots</a></li>
<li><a href="https://cran.r-project.org/web/packages/bayesplot/vignettes/visual-mcmc-diagnostics.html#general-mcmc-diagnostics">Visual MCMC diagnostics</a></li>
<li><a href="https://vuorre.netlify.com/post/2019/02/18/analyze-analog-scale-%20ratings-with-zero-one-inflated-beta-models/#zoib-regression">How to model slider data the Bayesian way</a></li>
<li><a href="https://chi-feng.github.io/mcmc-demo/">Visualization of different MCMC algorithms</a></li>
<li><a href="https://elevanth.org/blog/2017/11/28/build-a-better-markov-chain/">Article describing the different inference algorithms</a></li>
</ul>
</div>
<div id="session-info-21" class="section level2">
<h2><span class="header-section-number">23.8</span> Session info</h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Mojave 10.14.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] forcats_0.5.0     stringr_1.4.0     dplyr_0.8.4       purrr_0.3.3      
##  [5] readr_1.3.1       tidyr_1.0.2       tibble_2.1.3      tidyverse_1.3.0  
##  [9] titanic_0.1.0     ggeffects_0.14.1  lme4_1.1-21       Matrix_1.2-18    
## [13] modelr_0.1.6      bayesplot_1.7.1   broom.mixed_0.2.4 broom_0.5.5      
## [17] GGally_1.4.0      gganimate_1.0.5   ggplot2_3.3.0     patchwork_1.0.0  
## [21] brms_2.12.0       Rcpp_1.0.3        tidybayes_2.0.1   janitor_1.2.1    
## [25] kableExtra_1.1.0  knitr_1.28       
## 
## loaded via a namespace (and not attached):
##   [1] readxl_1.3.1         backports_1.1.5      Hmisc_4.3-1         
##   [4] plyr_1.8.6           igraph_1.2.4.2       TMB_1.7.16          
##   [7] splines_3.6.2        svUnit_0.7-12        crosstalk_1.0.0     
##  [10] rstantools_2.0.0     inline_0.3.15        digest_0.6.25       
##  [13] htmltools_0.4.0      rsconnect_0.8.16     fansi_0.4.1         
##  [16] checkmate_2.0.0      magrittr_1.5         cluster_2.1.0       
##  [19] matrixStats_0.55.0   xts_0.12-0           lpSolve_5.6.15      
##  [22] prettyunits_1.1.1    jpeg_0.1-8.1         colorspace_1.4-1    
##  [25] rvest_0.3.5          haven_2.2.0          xfun_0.12           
##  [28] callr_3.4.2          crayon_1.3.4         jsonlite_1.6.1      
##  [31] survival_3.1-8       zoo_1.8-7            glue_1.3.1          
##  [34] gtable_0.3.0         webshot_0.5.2        pkgbuild_1.0.6      
##  [37] rstan_2.19.3         abind_1.4-5          scales_1.1.0        
##  [40] mvtnorm_1.1-0        DBI_1.1.0            miniUI_0.1.1.1      
##  [43] htmlTable_1.13.3     viridisLite_0.3.0    xtable_1.8-4        
##  [46] progress_1.2.2       units_0.6-5          HDInterval_0.2.0    
##  [49] foreign_0.8-76       Formula_1.2-3        stats4_3.6.2        
##  [52] StanHeaders_2.21.0-1 DT_0.12              htmlwidgets_1.5.1   
##  [55] httr_1.4.1           threejs_0.3.3        arrayhelpers_1.1-0  
##  [58] RColorBrewer_1.1-2   ellipsis_0.3.0       acepack_1.4.1       
##  [61] pkgconfig_2.0.3      reshape_0.8.8        loo_2.2.0           
##  [64] farver_2.0.3         transformr_0.1.1     nnet_7.3-13         
##  [67] dbplyr_1.4.2         labeling_0.3         tidyselect_1.0.0    
##  [70] rlang_0.4.5          reshape2_1.4.3       later_1.0.0         
##  [73] munsell_0.5.0        cellranger_1.1.0     tools_3.6.2         
##  [76] cli_2.0.2            generics_0.0.2       sjlabelled_1.1.3    
##  [79] gifski_0.8.6         ggridges_0.5.2       evaluate_0.14       
##  [82] fastmap_1.0.1        yaml_2.2.1           fs_1.3.2            
##  [85] processx_3.4.2       nlme_3.1-145         mime_0.9            
##  [88] rstanarm_2.19.3      xml2_1.2.2           compiler_3.6.2      
##  [91] shinythemes_1.1.2    rstudioapi_0.11      png_0.1-7           
##  [94] e1071_1.7-3          reprex_0.3.0         tweenr_1.0.1        
##  [97] stringi_1.4.6        highr_0.8            ps_1.3.2            
## [100] Brobdingnag_1.2-6    lattice_0.20-40      classInt_0.4-2      
## [103] nloptr_1.2.1         markdown_1.1         shinyjs_1.1         
## [106] vctrs_0.2.3          pillar_1.4.3         lifecycle_0.1.0     
## [109] bridgesampling_1.0-0 data.table_1.12.8    insight_0.8.1       
## [112] httpuv_1.5.2         latticeExtra_0.6-29  R6_2.4.1            
## [115] bookdown_0.18        promises_1.1.0       KernSmooth_2.23-16  
## [118] gridExtra_2.3        codetools_0.2-16     boot_1.3-24         
## [121] colourpicker_1.0     MASS_7.3-51.5        gtools_3.8.1        
## [124] assertthat_0.2.1     withr_2.1.2          shinystan_2.5.0     
## [127] mgcv_1.8-31          parallel_3.6.2       hms_0.5.3           
## [130] rpart_4.1-15         grid_3.6.2           class_7.3-15        
## [133] coda_0.19-3          minqa_1.2.4          snakecase_0.11.0    
## [136] rmarkdown_2.1        sf_0.8-1             shiny_1.4.0         
## [139] lubridate_1.7.4      base64enc_0.1-3      dygraphs_1.1.1.6</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-data-analysis-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-data-analysis-4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/23-bayesian_data_analysis3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"search": false
});
});
</script>

</body>

</html>
