<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Generalized linear model | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Generalized linear model | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Generalized linear model | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2020-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-mixed-effects-models-3.html"/>
<link rel="next" href="bayesian-data-analysis-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a><ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="visualization-1.html"><a href="visualization-1.html#how-not-to-visualize-data"><i class="fa fa-check"></i><b>2.3.1</b> How <em>not</em> to visualize data</a></li>
<li class="chapter" data-level="2.3.2" data-path="visualization-1.html"><a href="visualization-1.html#how-to-make-it-better"><i class="fa fa-check"></i><b>2.3.2</b> How to make it better</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.5</b> Getting help</a></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization-using-ggplot2"><i class="fa fa-check"></i><b>2.6</b> Data visualization using <code>ggplot2</code></a><ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.6.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.6.2</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.6.3</b> Scatter plot</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.6.4</b> Line plot</a></li>
<li class="chapter" data-level="2.6.5" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.6.5</b> Adding error bars</a></li>
<li class="chapter" data-level="2.6.6" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.6.6</b> Grouping data</a></li>
<li class="chapter" data-level="2.6.7" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.6.7</b> Making facets</a></li>
<li class="chapter" data-level="2.6.8" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.6.8</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.7</b> Additional resources</a><ul>
<li class="chapter" data-level="2.7.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.7.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.7.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.7.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.7.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.7.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a><ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a><ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a><ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a><ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a><ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-2"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#install-packages"><i class="fa fa-check"></i><b>4.2</b> Install packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.3</b> Load packages</a></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.4</b> Some R basics</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.4.1</b> Modes</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.4.2</b> Data types</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.4.3</b> Operators</a></li>
<li class="chapter" data-level="4.4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.4.4</b> Control flow</a></li>
<li class="chapter" data-level="4.4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.4.5</b> Functions</a></li>
<li class="chapter" data-level="4.4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.4.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
<li class="chapter" data-level="4.5.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.5.7</b> A quick note on naming things</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a><ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.4</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.5</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.7</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a><ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="4.7.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#misc-2"><i class="fa fa-check"></i><b>4.7.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a><ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-3"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.3</b> Wrangling data (continued)</a><ul>
<li class="chapter" data-level="5.3.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.3.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.3.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.3.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.3.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.3.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.4</b> Reading in data</a><ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.4.1</b> csv</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.4.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.5</b> Saving data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.6</b> Additional resources</a><ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.6.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.6.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.6.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.6.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a><ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#learning-goals-4"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#install-and-load-packages-load-data-set-theme-1"><i class="fa fa-check"></i><b>6.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.3</b> Counting</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.5</b> The random secretary</a></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.6</b> Clue guide to probability</a><ul>
<li class="chapter" data-level="6.6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.6.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.6.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.7</b> Probability operations</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.8</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-networks"><i class="fa fa-check"></i><b>6.9</b> Bayesian networks</a><ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#sprinkler-example"><i class="fa fa-check"></i><b>6.9.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a><ul>
<li class="chapter" data-level="6.10.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.10.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.10.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-3"><i class="fa fa-check"></i><b>6.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a><ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#learning-goals-5"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.3</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.5</b> Computing probabilities</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a><ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#working-with-samples"><i class="fa fa-check"></i><b>7.5</b> Working with samples</a><ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.5.1</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="simulation-1.html"><a href="simulation-1.html#the-quantile-function"><i class="fa fa-check"></i><b>7.5.2</b> The <code>quantile()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#comparing-probability-distributions"><i class="fa fa-check"></i><b>7.6</b> Comparing probability distributions</a></li>
<li class="chapter" data-level="7.7" data-path="simulation-1.html"><a href="simulation-1.html#relationship-between-probability-and-likelihood"><i class="fa fa-check"></i><b>7.7</b> Relationship between probability and likelihood</a></li>
<li class="chapter" data-level="7.8" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.8</b> Additional resources</a><ul>
<li class="chapter" data-level="7.8.1" data-path="simulation-1.html"><a href="simulation-1.html#cheatsheets-5"><i class="fa fa-check"></i><b>7.8.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="7.8.2" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.8.2</b> Datacamp</a></li>
<li class="chapter" data-level="7.8.3" data-path="simulation-1.html"><a href="simulation-1.html#tutorials-1"><i class="fa fa-check"></i><b>7.8.3</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a><ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#learning-goals-6"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>8.3</b> The central limit theorem</a><ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.3.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.3.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.3.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.3.3</b> The sampling distribution</a></li>
<li class="chapter" data-level="8.3.4" data-path="simulation-2.html"><a href="simulation-2.html#exploring-the-clt"><i class="fa fa-check"></i><b>8.3.4</b> Exploring the CLT</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.4</b> Understanding p-values</a><ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.4.1</b> Permutation test</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.6</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a><ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#learning-goals-7"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.3</b> Modeling data</a><ul>
<li class="chapter" data-level="9.3.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.3.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.3.2" data-path="modeling-data.html"><a href="modeling-data.html#error-definitions-and-best-estimators"><i class="fa fa-check"></i><b>9.3.2</b> Error definitions and best estimators</a></li>
<li class="chapter" data-level="9.3.3" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.3.3</b> Sampling distributions for median and mean</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.4</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.5</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6</b> Additional resources</a><ul>
<li class="chapter" data-level="9.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.6.1</b> Reading</a></li>
<li class="chapter" data-level="9.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-1"><i class="fa fa-check"></i><b>9.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-7"><i class="fa fa-check"></i><b>9.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a><ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#learning-goals-8"><i class="fa fa-check"></i><b>10.1</b> Learning goals</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.3</b> Correlation</a></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.4</b> Regression</a><ul>
<li class="chapter" data-level="10.4.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.4.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.4.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.5</b> Credit example</a></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.6</b> Additional resources</a><ul>
<li class="chapter" data-level="10.6.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-2"><i class="fa fa-check"></i><b>10.6.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.6.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-4"><i class="fa fa-check"></i><b>10.6.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-8"><i class="fa fa-check"></i><b>10.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a><ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-9"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a><ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a><ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a><ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a><ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a><ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-3"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-5"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-9"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a><ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-10"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a><ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
<li class="chapter" data-level="12.5.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.5.5</b> Two-way ANOVA (with interaction)</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>12.6</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.7</b> Additional resources</a><ul>
<li class="chapter" data-level="12.7.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-4"><i class="fa fa-check"></i><b>12.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.7.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-6"><i class="fa fa-check"></i><b>12.7.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-10"><i class="fa fa-check"></i><b>12.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a><ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#learning-goals-11"><i class="fa fa-check"></i><b>13.1</b> Learning goals</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.3</b> Load data sets</a></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#planned-contrasts"><i class="fa fa-check"></i><b>13.4</b> Planned contrasts</a><ul>
<li class="chapter" data-level="13.4.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.4.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.4.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.4.2</b> Visualization</a></li>
<li class="chapter" data-level="13.4.3" data-path="linear-model-4.html"><a href="linear-model-4.html#constrasts"><i class="fa fa-check"></i><b>13.4.3</b> Constrasts</a></li>
<li class="chapter" data-level="13.4.4" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.4.4</b> Post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-11"><i class="fa fa-check"></i><b>13.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a><ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-12"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a><ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#eta-squared-and-partial-eta-squared"><i class="fa fa-check"></i><b>14.5.1</b> eta-squared and partial eta-squared</a></li>
<li class="chapter" data-level="14.5.2" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.2</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a><ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-via-simulation"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis via simulation</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-11"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a><ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-5"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-6"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-7"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-12"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mediation-moderation.html"><a href="mediation-moderation.html"><i class="fa fa-check"></i><b>15</b> Mediation &amp; Moderation</a><ul>
<li class="chapter" data-level="15.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#learning-goals-13"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#recommended-reading"><i class="fa fa-check"></i><b>15.2</b> Recommended reading</a></li>
<li class="chapter" data-level="15.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#controlling-for-variables"><i class="fa fa-check"></i><b>15.4</b> Controlling for variables</a><ul>
<li class="chapter" data-level="15.4.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>15.4.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="15.4.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#good-controls"><i class="fa fa-check"></i><b>15.4.2</b> Good controls</a></li>
<li class="chapter" data-level="15.4.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#bad-controls"><i class="fa fa-check"></i><b>15.4.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mediation-moderation.html"><a href="mediation-moderation.html#mediation"><i class="fa fa-check"></i><b>15.5</b> Mediation</a><ul>
<li class="chapter" data-level="15.5.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data"><i class="fa fa-check"></i><b>15.5.1</b> Generate data</a></li>
<li class="chapter" data-level="15.5.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>15.5.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="15.5.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>15.5.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="15.5.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>15.5.4</b> Method 3: Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation"><i class="fa fa-check"></i><b>15.6</b> Moderation</a><ul>
<li class="chapter" data-level="15.6.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data-1"><i class="fa fa-check"></i><b>15.6.1</b> Generate data</a></li>
<li class="chapter" data-level="15.6.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation-analysis"><i class="fa fa-check"></i><b>15.6.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="mediation-moderation.html"><a href="mediation-moderation.html#additional-resources-12"><i class="fa fa-check"></i><b>15.7</b> Additional resources</a><ul>
<li class="chapter" data-level="15.7.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#books"><i class="fa fa-check"></i><b>15.7.1</b> Books</a></li>
<li class="chapter" data-level="15.7.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#tutorials-2"><i class="fa fa-check"></i><b>15.7.2</b> Tutorials</a></li>
<li class="chapter" data-level="15.7.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#misc-8"><i class="fa fa-check"></i><b>15.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="mediation-moderation.html"><a href="mediation-moderation.html#session-info-13"><i class="fa fa-check"></i><b>15.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>16</b> Model comparison</a><ul>
<li class="chapter" data-level="16.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-14"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>16.3</b> Model comparison</a><ul>
<li class="chapter" data-level="16.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>16.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="16.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>16.3.2</b> F-test</a></li>
<li class="chapter" data-level="16.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>16.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="16.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>16.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="16.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>16.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>16.4</b> Additional resources</a><ul>
<li class="chapter" data-level="16.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>16.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="16.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>16.4.2</b> Reading</a></li>
<li class="chapter" data-level="16.4.3" data-path="model-comparison.html"><a href="model-comparison.html#misc-9"><i class="fa fa-check"></i><b>16.4.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-14"><i class="fa fa-check"></i><b>16.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a><ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-15"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a><ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-15"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a><ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-16"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>18.3</b> Simulating a linear mixed effects model</a></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.4</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.5</b> Different slopes</a></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.6</b> Simpson’s paradox</a></li>
<li class="chapter" data-level="18.7" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.7</b> Additional resources</a><ul>
<li class="chapter" data-level="18.7.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.7.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-16"><i class="fa fa-check"></i><b>18.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a><ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-17"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-set"><i class="fa fa-check"></i><b>19.3</b> Load data set</a></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixtures-of-participants"><i class="fa fa-check"></i><b>19.4</b> Mixtures of participants</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#pooling-and-shrinkage"><i class="fa fa-check"></i><b>19.5</b> Pooling and shrinkage</a><ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#complete-pooling"><i class="fa fa-check"></i><b>19.5.1</b> Complete pooling</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#no-pooling"><i class="fa fa-check"></i><b>19.5.2</b> No pooling</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#partial-pooling"><i class="fa fa-check"></i><b>19.5.3</b> Partial pooling</a></li>
<li class="chapter" data-level="19.5.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#compare-results"><i class="fa fa-check"></i><b>19.5.4</b> Compare results</a></li>
<li class="chapter" data-level="19.5.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#coefficients"><i class="fa fa-check"></i><b>19.5.5</b> Coefficients</a></li>
<li class="chapter" data-level="19.5.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#shrinkage"><i class="fa fa-check"></i><b>19.5.6</b> Shrinkage</a></li>
<li class="chapter" data-level="19.5.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#plotting-marginal-effects"><i class="fa fa-check"></i><b>19.5.7</b> Plotting marginal effects</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#bootstrapping"><i class="fa fa-check"></i><b>19.6</b> Bootstrapping</a><ul>
<li class="chapter" data-level="19.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#linear-model"><i class="fa fa-check"></i><b>19.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#getting-p-values"><i class="fa fa-check"></i><b>19.7</b> Getting p-values</a></li>
<li class="chapter" data-level="19.8" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.8</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-17"><i class="fa fa-check"></i><b>19.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>20</b> Generalized linear model</a><ul>
<li class="chapter" data-level="20.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-18"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set-1"><i class="fa fa-check"></i><b>20.3</b> Load data set</a></li>
<li class="chapter" data-level="20.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>20.4</b> Logistic regression</a><ul>
<li class="chapter" data-level="20.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>20.4.1</b> Interpreting the parameters</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>20.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="20.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>20.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="20.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>20.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="20.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logit-transform"><i class="fa fa-check"></i><b>20.8</b> Logit transform</a></li>
<li class="chapter" data-level="20.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>20.9</b> Additional information</a><ul>
<li class="chapter" data-level="20.9.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-6"><i class="fa fa-check"></i><b>20.9.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="20.10" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-18"><i class="fa fa-check"></i><b>20.10</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html"><i class="fa fa-check"></i><b>21</b> Bayesian data analysis 1</a><ul>
<li class="chapter" data-level="21.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#learning-goals-19"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#things-that-came-up"><i class="fa fa-check"></i><b>21.3</b> Things that came up</a><ul>
<li class="chapter" data-level="21.3.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bias-in-cosyne-2019-conference-admission"><i class="fa fa-check"></i><b>21.3.1</b> Bias in Cosyne 2019 conference admission?</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#session-info-19"><i class="fa fa-check"></i><b>21.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 2</a><ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-20"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>22.3</b> Doing Bayesian inference “by hand”</a><ul>
<li class="chapter" data-level="22.3.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#coin-flip-example"><i class="fa fa-check"></i><b>22.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="22.3.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>22.3.3</b> Bayesian inference by discretization</a></li>
<li class="chapter" data-level="22.3.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-prior"><i class="fa fa-check"></i><b>22.3.4</b> Effect of the prior</a></li>
<li class="chapter" data-level="22.3.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-likelihood"><i class="fa fa-check"></i><b>22.3.5</b> Effect of the likelihood</a></li>
<li class="chapter" data-level="22.3.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-sample-size"><i class="fa fa-check"></i><b>22.3.6</b> Effect of the sample size</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#distributions"><i class="fa fa-check"></i><b>22.4</b> Distributions</a><ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#normal-vs-student-t-distribution"><i class="fa fa-check"></i><b>22.4.1</b> Normal vs Student-t distribution</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#beta-distributions"><i class="fa fa-check"></i><b>22.4.2</b> Beta distributions</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#normal-distributions"><i class="fa fa-check"></i><b>22.4.3</b> Normal distributions</a></li>
<li class="chapter" data-level="22.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#distributions-for-non-negative-parameters"><i class="fa fa-check"></i><b>22.4.4</b> Distributions for non-negative parameters</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#inference-via-sampling"><i class="fa fa-check"></i><b>22.5</b> Inference via sampling</a></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#greta"><i class="fa fa-check"></i><b>22.6</b> Greta</a><ul>
<li class="chapter" data-level="22.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#attitude-data-set"><i class="fa fa-check"></i><b>22.6.1</b> Attitude data set</a></li>
<li class="chapter" data-level="22.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#frequentist-analysis"><i class="fa fa-check"></i><b>22.6.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="22.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#bayesian-regression"><i class="fa fa-check"></i><b>22.6.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-20"><i class="fa fa-check"></i><b>22.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 3</a><ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-21"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-data-set-2"><i class="fa fa-check"></i><b>23.3</b> Load data set</a></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#poker"><i class="fa fa-check"></i><b>23.4</b> Poker</a><ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualization-7"><i class="fa fa-check"></i><b>23.4.1</b> Visualization</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#linear-model-5"><i class="fa fa-check"></i><b>23.4.2</b> Linear model</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-model"><i class="fa fa-check"></i><b>23.4.3</b> Bayesian model</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>23.5</b> Dealing with heteroscedasticity</a></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>23.6</b> Ordinal regression</a></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-16"><i class="fa fa-check"></i><b>23.7</b> Additional resources</a></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-21"><i class="fa fa-check"></i><b>23.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>24</b> Reporting statistics</a><ul>
<li class="chapter" data-level="24.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>24.1</b> General advice</a><ul>
<li class="chapter" data-level="24.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>24.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="24.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>24.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="24.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>24.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="24.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>24.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="24.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>24.1.5</b> Frequentist statistics</a></li>
<li class="chapter" data-level="24.1.6" data-path="reporting-statistics.html"><a href="reporting-statistics.html#bayesian-statistics"><i class="fa fa-check"></i><b>24.1.6</b> Bayesian statistics –&gt;</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-22"><i class="fa fa-check"></i><b>24.2</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html"><i class="fa fa-check"></i><b>25</b> Cheatsheets</a><ul>
<li class="chapter" data-level="25.1" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#statistics"><i class="fa fa-check"></i><b>25.1</b> Statistics</a></li>
<li class="chapter" data-level="25.2" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#r"><i class="fa fa-check"></i><b>25.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="generalized-linear-model" class="section level1">
<h1><span class="header-section-number">Chapter 20</span> Generalized linear model</h1>
<div id="learning-goals-18" class="section level2">
<h2><span class="header-section-number">20.1</span> Learning goals</h2>
<ul>
<li>Logistic regression.</li>
<li>Logit transform.</li>
<li>Fitting a logistic regression in R.</li>
<li>Visualizing and interpreting model predictions.</li>
<li>Simulating data from a logistic regression.</li>
<li>Assessing model fit.</li>
<li>Testing hypotheses.</li>
<li>Reporting results.</li>
<li>Mixed effects logistic regression.</li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-13" class="section level2">
<h2><span class="header-section-number">20.2</span> Load packages and set plotting theme</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(<span class="st">&quot;knitr&quot;</span>)      <span class="co"># for knitting RMarkdown </span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(<span class="st">&quot;titanic&quot;</span>)    <span class="co"># titanic dataset</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>) <span class="co"># for making nice tables</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(<span class="st">&quot;janitor&quot;</span>)    <span class="co"># for cleaning column names</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)      <span class="co"># for tidying up linear models </span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(<span class="st">&quot;lme4&quot;</span>)       <span class="co"># for linear mixed effects models</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(<span class="st">&quot;boot&quot;</span>)       <span class="co"># for bootstrapping (also has an inverse logit function)</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(<span class="st">&quot;ggeffects&quot;</span>)  <span class="co"># for showing effects in linear, generalized linear, and other models</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)  <span class="co"># for wrangling, plotting, etc. </span></a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co"># include references for used packages</span></a>
<a class="sourceLine" id="cb1-12" title="12">knitr<span class="op">::</span><span class="kw">write_bib</span>(<span class="kw">.packages</span>(), <span class="st">&quot;packages.bib&quot;</span>) </a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">theme_set</span>(<span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="co">#set the theme </span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></a></code></pre></div>
</div>
<div id="load-data-set-1" class="section level2">
<h2><span class="header-section-number">20.3</span> Load data set</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">df.titanic =<span class="st"> </span>titanic_train <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">as.factor</span>(sex))</a></code></pre></div>
<p>Let’s take a quick look at the data:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">df.titanic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">glimpse</span>()</a></code></pre></div>
<pre><code>## Observations: 891
## Variables: 12
## $ passenger_id &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…
## $ survived     &lt;int&gt; 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0,…
## $ pclass       &lt;int&gt; 3, 1, 3, 1, 3, 3, 1, 3, 3, 2, 3, 1, 3, 3, 3, 2, 3, 2, 3,…
## $ name         &lt;chr&gt; &quot;Braund, Mr. Owen Harris&quot;, &quot;Cumings, Mrs. John Bradley (…
## $ sex          &lt;fct&gt; male, female, female, female, male, male, male, male, fe…
## $ age          &lt;dbl&gt; 22, 38, 26, 35, 35, NA, 54, 2, 27, 14, 4, 58, 20, 39, 14…
## $ sib_sp       &lt;int&gt; 1, 1, 0, 1, 0, 0, 0, 3, 0, 1, 1, 0, 0, 1, 0, 0, 4, 0, 1,…
## $ parch        &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 0, 0, 5, 0, 0, 1, 0, 0,…
## $ ticket       &lt;chr&gt; &quot;A/5 21171&quot;, &quot;PC 17599&quot;, &quot;STON/O2. 3101282&quot;, &quot;113803&quot;, &quot;…
## $ fare         &lt;dbl&gt; 7.2500, 71.2833, 7.9250, 53.1000, 8.0500, 8.4583, 51.862…
## $ cabin        &lt;chr&gt; &quot;&quot;, &quot;C85&quot;, &quot;&quot;, &quot;C123&quot;, &quot;&quot;, &quot;&quot;, &quot;E46&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;G6&quot;, …
## $ embarked     &lt;chr&gt; &quot;S&quot;, &quot;C&quot;, &quot;S&quot;, &quot;S&quot;, &quot;S&quot;, &quot;Q&quot;, &quot;S&quot;, &quot;S&quot;, &quot;S&quot;, &quot;C&quot;, &quot;S&quot;, &quot;…</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># Table of the first 10 entries</span></a>
<a class="sourceLine" id="cb6-2" title="2">df.titanic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</a>
<a class="sourceLine" id="cb6-6" title="6">                <span class="dt">full_width =</span> F)</a></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
passenger_id
</th>
<th style="text-align:right;">
survived
</th>
<th style="text-align:right;">
pclass
</th>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
sex
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
sib_sp
</th>
<th style="text-align:right;">
parch
</th>
<th style="text-align:left;">
ticket
</th>
<th style="text-align:right;">
fare
</th>
<th style="text-align:left;">
cabin
</th>
<th style="text-align:left;">
embarked
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Braund, Mr. Owen Harris
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
A/5 21171
</td>
<td style="text-align:right;">
7.25
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Cumings, Mrs. John Bradley (Florence Briggs Thayer)
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
PC 17599
</td>
<td style="text-align:right;">
71.28
</td>
<td style="text-align:left;">
C85
</td>
<td style="text-align:left;">
C
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Heikkinen, Miss. Laina
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
STON/O2. 3101282
</td>
<td style="text-align:right;">
7.92
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Futrelle, Mrs. Jacques Heath (Lily May Peel)
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
113803
</td>
<td style="text-align:right;">
53.10
</td>
<td style="text-align:left;">
C123
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Allen, Mr. William Henry
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
373450
</td>
<td style="text-align:right;">
8.05
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Moran, Mr. James
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
330877
</td>
<td style="text-align:right;">
8.46
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Q
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
McCarthy, Mr. Timothy J
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
17463
</td>
<td style="text-align:right;">
51.86
</td>
<td style="text-align:left;">
E46
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Palsson, Master. Gosta Leonard
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
349909
</td>
<td style="text-align:right;">
21.07
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
347742
</td>
<td style="text-align:right;">
11.13
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Nasser, Mrs. Nicholas (Adele Achem)
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
237736
</td>
<td style="text-align:right;">
30.07
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
C
</td>
</tr>
</tbody>
</table>
</div>
<div id="logistic-regression" class="section level2">
<h2><span class="header-section-number">20.4</span> Logistic regression</h2>
<p>Let’s see if we can predict whether or not a passenger survived based on the price of their ticket.</p>
<p>Let’s run a simple regression first:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># fit a linear model </span></a>
<a class="sourceLine" id="cb7-2" title="2">fit.lm =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>fare,</a>
<a class="sourceLine" id="cb7-3" title="3">            <span class="dt">data =</span> df.titanic)</a>
<a class="sourceLine" id="cb7-4" title="4"></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co"># summarize the results</span></a>
<a class="sourceLine" id="cb7-6" title="6">fit.lm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = survived ~ 1 + fare, data = df.titanic)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.9653 -0.3391 -0.3222  0.6044  0.6973 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.3026994  0.0187849  16.114  &lt; 2e-16 ***
## fare        0.0025195  0.0003174   7.939 6.12e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4705 on 889 degrees of freedom
## Multiple R-squared:  0.06621,    Adjusted R-squared:  0.06516 
## F-statistic: 63.03 on 1 and 889 DF,  p-value: 6.12e-15</code></pre>
<p>Look’s like <code>fare</code> is a significant predictor of whether or not a person survived. Let’s visualize the model’s predictions:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.titanic,</a>
<a class="sourceLine" id="cb9-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> fare,</a>
<a class="sourceLine" id="cb9-3" title="3">                     <span class="dt">y =</span> survived)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;survived&quot;</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/glm-08-1.png" width="672" /></p>
<p>This doesn’t look good! The model predicts intermediate values of <code>survived</code> (which doesn’t make sense given that a person either survived or didn’t survive). Furthermore, the model predicts values greater than 1 for fares greather than ~ 300.</p>
<p>Let’s run a logistic regression instead.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># fit a logistic regression </span></a>
<a class="sourceLine" id="cb11-2" title="2">fit.glm =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>fare,</a>
<a class="sourceLine" id="cb11-3" title="3">              <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb11-4" title="4">              <span class="dt">data =</span> df.titanic)</a>
<a class="sourceLine" id="cb11-5" title="5"></a>
<a class="sourceLine" id="cb11-6" title="6">fit.glm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = survived ~ 1 + fare, family = &quot;binomial&quot;, data = df.titanic)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4906  -0.8878  -0.8531   1.3429   1.5942  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.941330   0.095129  -9.895  &lt; 2e-16 ***
## fare         0.015197   0.002232   6.810 9.79e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1186.7  on 890  degrees of freedom
## Residual deviance: 1117.6  on 889  degrees of freedom
## AIC: 1121.6
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>And let’s visualize the predictions of the logistic regression:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.titanic,</a>
<a class="sourceLine" id="cb13-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> fare,</a>
<a class="sourceLine" id="cb13-3" title="3">                     <span class="dt">y =</span> survived)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>,</a>
<a class="sourceLine" id="cb13-5" title="5">              <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;p(survived)&quot;</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/glm-10-1.png" width="672" /></p>
<p>Much better! Note that we’ve changed the interpretation of our dependent variable. We are now predicting the <em>probability that a person survived</em> based on their fare. The model now only predicts values between 0 and 1. To achieve this, we apply a logit transform to the outcome variable like so:</p>
<p><span class="math display">\[
\ln(\frac{\pi_i}{1-\pi_i}) = b_0 + b_1 \cdot X_i + e_i
\]</span>
where <span class="math inline">\(\pi_i\)</span> is the probability of passenger <span class="math inline">\(i\)</span> having survived. Importantly, this affects our interpretation of the model parameters. They are now defined in log-odds, and can apply an inverse logit transformation to turn this back into a probability:</p>
<p>With</p>
<p><span class="math display">\[
\pi = P(Y = 1)
\]</span>
and the logit transformation</p>
<p><span class="math display">\[
\ln(\frac{\pi}{1-\pi}) = V,
\]</span>
where <span class="math inline">\(V\)</span> is just a placeholder for our linear model formula, we can go back to <span class="math inline">\(\pi\)</span> through the inverse logit transformation like so:</p>
<p><span class="math display">\[
\pi = \frac{e^V}{1 + e^V}
\]</span>
In R, we can use <code>log(x)</code> to calculate the natural logarithm <span class="math inline">\(\ln(x)\)</span>, and <code>exp(x)</code> to calculate <code>e^x</code>.</p>
<div id="interpreting-the-parameters" class="section level3">
<h3><span class="header-section-number">20.4.1</span> Interpreting the parameters</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">fit.glm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = survived ~ 1 + fare, family = &quot;binomial&quot;, data = df.titanic)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4906  -0.8878  -0.8531   1.3429   1.5942  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.941330   0.095129  -9.895  &lt; 2e-16 ***
## fare         0.015197   0.002232   6.810 9.79e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1186.7  on 890  degrees of freedom
## Residual deviance: 1117.6  on 889  degrees of freedom
## AIC: 1121.6
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>The estimate for the intercept and fare are in log-odds. We apply the inverse logit transformation to turn these into probabilities:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">fit.glm<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw">inv.logit</span>()</a></code></pre></div>
<pre><code>## (Intercept) 
##   0.2806318</code></pre>
<p>Here, we see that the intercept is <span class="math inline">\(p = 0.28\)</span>. That is, the predicted chance of survival for someone who didn’t pay any fare at all is 28% according to the model. Interpreting the slope is a little more tricky. Let’s look at a situation first where we have a binary predictor.</p>
<div id="binary-predictor" class="section level4">
<h4><span class="header-section-number">20.4.1.1</span> Binary predictor</h4>
<p>Let’s see whether the probability of survival differed between male and female passengers.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">fit.glm2 =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span>sex,</a>
<a class="sourceLine" id="cb19-2" title="2">               <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb19-3" title="3">               <span class="dt">data =</span> df.titanic)</a>
<a class="sourceLine" id="cb19-4" title="4"></a>
<a class="sourceLine" id="cb19-5" title="5">fit.glm2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = survived ~ sex, family = &quot;binomial&quot;, data = df.titanic)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6462  -0.6471  -0.6471   0.7725   1.8256  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   1.0566     0.1290   8.191 2.58e-16 ***
## sexmale      -2.5137     0.1672 -15.036  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1186.7  on 890  degrees of freedom
## Residual deviance:  917.8  on 889  degrees of freedom
## AIC: 921.8
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>It looks like it did! Let’s visualize:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">df.titanic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">survived =</span> <span class="kw">factor</span>(survived, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;died&quot;</span>, <span class="st">&quot;survived&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb21-4" title="4">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> sex,</a>
<a class="sourceLine" id="cb21-5" title="5">                       <span class="dt">fill =</span> survived)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>,</a>
<a class="sourceLine" id="cb21-7" title="7">           <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;probability&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/glm-14-1.png" width="672" /></p>
<p>And let’s interpret the parameters by applying the inverse logit transform. To get the prediction for female passengers we get</p>
<p><span class="math display">\[
\widehat{\ln(\frac{\pi_i}{1-\pi_i})} = b_0 + b_1 \cdot \text{sex}_i = b_0 + b_1 \cdot 0 = b_0
\]</span></p>
<p>since we dummy coded the predictor and female is our reference category. To get the predicted probability of surival for women we do the logit transform:</p>
<p><span class="math display">\[
\pi = \frac{e^{b_0}}{1 + e^{b_0}}
\]</span>
The predicted probability is:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">fit.glm2<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">inv.logit</span>()</a></code></pre></div>
<pre><code>## (Intercept) 
##   0.7420382</code></pre>
<p>To get the prediction for male passengers we have:</p>
<p><span class="math display">\[
\widehat{\ln(\frac{\pi_i}{1-\pi_i})} = b_0 + b_1 \cdot \text{sex}_i = b_0 + b_1 \cdot 1 = b_0 + b_1
\]</span>
Applying the logit transform like so</p>
<p><span class="math display">\[
\pi = \frac{e^{b_0 + b_1}}{1 + e^{b_0 + b_1}}
\]</span></p>
<p>The predicted probability of male passengers surviving is:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">sum</span>(fit.glm2<span class="op">$</span>coefficients) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">inv.logit</span>()</a></code></pre></div>
<pre><code>## [1] 0.1889081</code></pre>
<p>Here is the same information in a table:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">df.titanic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">  </span><span class="kw">count</span>(sex, survived) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> n<span class="op">/</span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(survived|sex)</span><span class="st">`</span> =<span class="st"> </span>p<span class="op">/</span><span class="kw">sum</span>(p)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</a>
<a class="sourceLine" id="cb26-9" title="9">                <span class="dt">full_width =</span> F)</a></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
sex
</th>
<th style="text-align:right;">
survived
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
p(survived|sex)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
233
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.74
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
468
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
109
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.19
</td>
</tr>
</tbody>
</table>
</div>
<div id="continuous-predictor" class="section level4">
<h4><span class="header-section-number">20.4.1.2</span> Continuous predictor</h4>
<p>To interpret the predictions when a continuous predictor is invovled, it’s easiest to consider a few concrete cases. Here, I use the <code>augment()</code> function from the “broom” package to get the model’s predictions for some values of interest:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">fit.glm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">  </span><span class="kw">augment</span>(<span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">fare =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">  </span><span class="kw">select</span>(fare, <span class="dt">prediction =</span> fitted) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(survival)</span><span class="st">`</span> =<span class="st"> </span>prediction <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">inv.logit</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</a>
<a class="sourceLine" id="cb27-9" title="9">                <span class="dt">full_width =</span> F)</a></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
fare
</th>
<th style="text-align:right;">
prediction
</th>
<th style="text-align:right;">
p(survival)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.94
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-0.79
</td>
<td style="text-align:right;">
0.31
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.45
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.64
</td>
</tr>
<tr>
<td style="text-align:right;">
500
</td>
<td style="text-align:right;">
6.66
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
</tbody>
</table>
</div>
<div id="several-predictors" class="section level4">
<h4><span class="header-section-number">20.4.1.3</span> Several predictors</h4>
<p>Let’s fit a logistic regression that predicts the probability of survival based both on the passenger’s sex and what fare they paid (allowing for an interaction of the two predictors):</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">fit.glm =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>fare,</a>
<a class="sourceLine" id="cb28-2" title="2">              <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb28-3" title="3">              <span class="dt">data =</span> df.titanic)</a>
<a class="sourceLine" id="cb28-4" title="4"></a>
<a class="sourceLine" id="cb28-5" title="5">fit.glm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = survived ~ 1 + sex + fare, family = &quot;binomial&quot;, 
##     data = df.titanic)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2082  -0.6208  -0.5824   0.8126   1.9658  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.647100   0.148502   4.358 1.32e-05 ***
## sexmale     -2.422760   0.170515 -14.208  &lt; 2e-16 ***
## fare         0.011214   0.002295   4.886 1.03e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1186.66  on 890  degrees of freedom
## Residual deviance:  884.31  on 888  degrees of freedom
## AIC: 890.31
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>And let’s visualize the result:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">df.titanic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">as.factor</span>(sex)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb30-4" title="4">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> fare,</a>
<a class="sourceLine" id="cb30-5" title="5">                       <span class="dt">y =</span> survived,</a>
<a class="sourceLine" id="cb30-6" title="6">                       <span class="dt">color =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>,</a>
<a class="sourceLine" id="cb30-9" title="9">              <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>),</a>
<a class="sourceLine" id="cb30-10" title="10">              <span class="dt">alpha =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb30-11" title="11">              <span class="kw">aes</span>(<span class="dt">fill =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-12" title="12"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/glm-20-1.png" width="672" /></p>
<p>Let’s see how large the difference between genders is once we take into account how much each person paid for the fair:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">ggpredict</span>(fit.glm,</a>
<a class="sourceLine" id="cb32-2" title="2">          <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;sex&quot;</span>))</a></code></pre></div>
<pre><code>## 
## # Predicted values of survived
## # x = sex
## 
## x      | Predicted |   SE |       95% CI
## ----------------------------------------
## female |      0.73 | 0.13 | [0.68, 0.78]
## male   |      0.20 | 0.11 | [0.16, 0.23]
## 
## Adjusted for:
## * fare = 32.20</code></pre>
<p>We notice that there is one outlier who was male and paid a $500 fare (or maybe this is a mistake in the data entry?!). Let’s remove this outlier and see what happens:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">fit.glm2 =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>fare,</a>
<a class="sourceLine" id="cb34-2" title="2">              <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb34-3" title="3">              <span class="dt">data =</span> df.titanic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="st">                </span><span class="kw">filter</span>(fare <span class="op">&lt;</span><span class="st"> </span><span class="dv">500</span>))</a>
<a class="sourceLine" id="cb34-5" title="5"></a>
<a class="sourceLine" id="cb34-6" title="6">fit.glm2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = survived ~ 1 + sex + fare, family = &quot;binomial&quot;, 
##     data = df.titanic %&gt;% filter(fare &lt; 500))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2030  -0.6212  -0.5828   0.8124   1.9647  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.650213   0.149265   4.356 1.32e-05 ***
## sexmale     -2.423381   0.170518 -14.212  &lt; 2e-16 ***
## fare         0.011111   0.002345   4.739 2.15e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1180.89  on 887  degrees of freedom
## Residual deviance:  884.23  on 885  degrees of freedom
## AIC: 890.23
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">df.titanic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="st">  </span><span class="kw">filter</span>(fare <span class="op">&lt;</span><span class="st"> </span><span class="dv">500</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">as.factor</span>(sex)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb36-5" title="5">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> fare,</a>
<a class="sourceLine" id="cb36-6" title="6">                       <span class="dt">y =</span> survived,</a>
<a class="sourceLine" id="cb36-7" title="7">                       <span class="dt">color =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb36-8" title="8"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>,</a>
<a class="sourceLine" id="cb36-10" title="10">              <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>),</a>
<a class="sourceLine" id="cb36-11" title="11">              <span class="dt">alpha =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb36-12" title="12">              <span class="dt">fullrange =</span> T,</a>
<a class="sourceLine" id="cb36-13" title="13">              <span class="kw">aes</span>(<span class="dt">fill =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb36-14" title="14"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb36-15" title="15"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">500</span>))</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/glm-22-1.png" width="672" /></p>
<p>There is still a clear difference between female and male passengers, but the prediction for male passengers has changed a bit. Let’s look at a concrete example:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="co"># with the outlier: </span></a>
<a class="sourceLine" id="cb38-2" title="2"></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="co"># predicted probability of survival for a male passenger who paid $200 for their fare </span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="kw">inv.logit</span>(fit.glm<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>fit.glm<span class="op">$</span>coefficients[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>fit.glm<span class="op">$</span>coefficients[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span><span class="dv">200</span> <span class="op">+</span><span class="st"> </span>fit.glm<span class="op">$</span>coefficients[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span><span class="dv">200</span>)</a></code></pre></div>
<pre><code>## (Intercept) 
##          NA</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co"># without the outlier: </span></a>
<a class="sourceLine" id="cb40-2" title="2"></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="co"># predicted probability of survival for a male passenger who paid $200 for their fare </span></a>
<a class="sourceLine" id="cb40-4" title="4">fit.glm_no_outlier =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">*</span><span class="st"> </span>fare,</a>
<a class="sourceLine" id="cb40-5" title="5">                         <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb40-6" title="6">                         <span class="dt">data =</span> df.titanic <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-7" title="7"><span class="st">                           </span><span class="kw">filter</span>(fare <span class="op">&lt;</span><span class="st"> </span><span class="dv">500</span>))</a>
<a class="sourceLine" id="cb40-8" title="8"></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="kw">inv.logit</span>(fit.glm_no_outlier<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>fit.glm_no_outlier<span class="op">$</span>coefficients[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>fit.glm_no_outlier<span class="op">$</span>coefficients[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span><span class="dv">200</span> <span class="op">+</span><span class="st"> </span>fit.glm_no_outlier<span class="op">$</span>coefficients[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span><span class="dv">200</span>) </a></code></pre></div>
<pre><code>## (Intercept) 
##   0.4658284</code></pre>
<p>With the oulier removed, the predicted probability of survival for a male passenger who paid $200 decreases from 49% to 47%.</p>
<div id="with-interactions" class="section level5">
<h5><span class="header-section-number">20.4.1.3.1</span> With interactions</h5>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">fit.glm3 =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">*</span><span class="st"> </span>fare,</a>
<a class="sourceLine" id="cb42-2" title="2">              <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb42-3" title="3">              <span class="dt">data =</span> df.titanic)</a>
<a class="sourceLine" id="cb42-4" title="4"></a>
<a class="sourceLine" id="cb42-5" title="5">df.data =<span class="st"> </span><span class="kw">ggpredict</span>(fit.glm3,</a>
<a class="sourceLine" id="cb42-6" title="6">                    <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;fare [0:500]&quot;</span>, <span class="st">&quot;sex&quot;</span>))</a>
<a class="sourceLine" id="cb42-7" title="7">  </a>
<a class="sourceLine" id="cb42-8" title="8"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.data,</a>
<a class="sourceLine" id="cb42-9" title="9">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb42-10" title="10">                     <span class="dt">y =</span> predicted,</a>
<a class="sourceLine" id="cb42-11" title="11">                     <span class="dt">color =</span> group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-12" title="12"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">ymin =</span> conf.low,</a>
<a class="sourceLine" id="cb42-13" title="13">                            <span class="dt">ymax =</span> conf.high,</a>
<a class="sourceLine" id="cb42-14" title="14">                            <span class="dt">fill =</span> group),</a>
<a class="sourceLine" id="cb42-15" title="15">              <span class="dt">alpha =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb42-16" title="16">              <span class="dt">color =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-17" title="17"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-18" title="18"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> df.titanic,</a>
<a class="sourceLine" id="cb42-19" title="19">             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> fare,</a>
<a class="sourceLine" id="cb42-20" title="20">                           <span class="dt">y =</span> survived,</a>
<a class="sourceLine" id="cb42-21" title="21">                           <span class="dt">color =</span> sex),</a>
<a class="sourceLine" id="cb42-22" title="22">             <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-23" title="23"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/glm-24-1.png" width="672" /></p>
</div>
</div>
<div id="using-the-ggeffects-package" class="section level4">
<h4><span class="header-section-number">20.4.1.4</span> Using the “ggeffects” package</h4>
<p>The “ggeffects” package helps with the interpretation of the results. It applies the inverse logit transform for us, and shows the predictions for a range of cases.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># show effects </span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">ggeffect</span>(<span class="dt">model =</span> fit.glm,</a>
<a class="sourceLine" id="cb43-3" title="3">         <span class="dt">terms =</span> <span class="st">&quot;fare [0, 100, 200, 300, 400, 500]&quot;</span>)</a></code></pre></div>
<pre><code>## 
## # Predicted values of survived
## # x = fare
## 
##   x | Predicted |   SE |       95% CI
## -------------------------------------
##   0 |      0.28 | 0.11 | [0.24, 0.33]
## 100 |      0.55 | 0.18 | [0.46, 0.64]
## 200 |      0.79 | 0.40 | [0.63, 0.89]
## 300 |      0.92 | 0.63 | [0.77, 0.98]
## 400 |      0.97 | 0.86 | [0.87, 0.99]
## 500 |      0.99 | 1.08 | [0.93, 1.00]</code></pre>
<p>I’ve used the <code>[]</code> construction to specify for what values of the predictor <code>fare</code>, I’d like get the predicted values.</p>
</div>
</div>
</div>
<div id="simulate-a-logistic-regression" class="section level2">
<h2><span class="header-section-number">20.5</span> Simulate a logistic regression</h2>
<p>As always, to better understand a statistical modeling procedure, it’s helpful to simulate data from the assumed data-generating process, fit the model, and see whether we can reconstruct the parameters.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># make example reproducible </span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb45-3" title="3"></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="co"># set parameters </span></a>
<a class="sourceLine" id="cb45-5" title="5">sample_size =<span class="st"> </span><span class="dv">1000</span> </a>
<a class="sourceLine" id="cb45-6" title="6">b0 =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb45-7" title="7">b1 =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb45-8" title="8"><span class="co"># b1 = 8</span></a>
<a class="sourceLine" id="cb45-9" title="9"></a>
<a class="sourceLine" id="cb45-10" title="10"><span class="co"># generate data </span></a>
<a class="sourceLine" id="cb45-11" title="11">df.data =<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb45-12" title="12">  <span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> sample_size),</a>
<a class="sourceLine" id="cb45-13" title="13">  <span class="dt">y =</span> b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb45-14" title="14">  <span class="dt">p =</span> <span class="kw">inv.logit</span>(y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-15" title="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">response =</span> <span class="kw">rbinom</span>(<span class="kw">n</span>(), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">p =</span> p))</a>
<a class="sourceLine" id="cb45-16" title="16"></a>
<a class="sourceLine" id="cb45-17" title="17"><span class="co"># fit model </span></a>
<a class="sourceLine" id="cb45-18" title="18">fit =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> response <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb45-19" title="19">          <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb45-20" title="20">          <span class="dt">data =</span> df.data)</a>
<a class="sourceLine" id="cb45-21" title="21"></a>
<a class="sourceLine" id="cb45-22" title="22"><span class="co"># model summary </span></a>
<a class="sourceLine" id="cb45-23" title="23">fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = response ~ 1 + x, family = &quot;binomial&quot;, data = df.data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1137  -1.0118  -0.4591   1.0287   2.2591  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.06214    0.06918  -0.898    0.369    
## x            0.92905    0.07937  11.705   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1385.4  on 999  degrees of freedom
## Residual deviance: 1209.6  on 998  degrees of freedom
## AIC: 1213.6
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<p>Nice! The inferred estimates are very close to the parameter values we used to simulate the data.</p>
<p>Let’s visualize the result:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.data,</a>
<a class="sourceLine" id="cb47-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb47-3" title="3">                     <span class="dt">y =</span> response)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>,</a>
<a class="sourceLine" id="cb47-5" title="5">              <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;p(response)&quot;</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/glm-27-1.png" width="672" /></p>
<div id="calculate-the-models-likelihood" class="section level4">
<h4><span class="header-section-number">20.5.0.1</span> Calculate the model’s likelihood</h4>
<p>To calculate the likelihood of the data for a given logistic model, we look at the actual response, and the probability of the predicted response, and then determine the likelihood of the observation assuming a bernoulli process. To get the overall likelihood of the data, we then multiply the likelihood of each data point (or take the logs first and then the sum to get the log-likelihood).</p>
<p>This table illustrate the steps involved:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">fit <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> <span class="kw">inv.logit</span>(fitted)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-5" title="5"><span class="st">  </span><span class="kw">select</span>(response, p) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_response =</span> <span class="kw">ifelse</span>(response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, p, <span class="dv">1</span><span class="op">-</span>p),</a>
<a class="sourceLine" id="cb49-7" title="7">         <span class="dt">log_p =</span> <span class="kw">log</span>(p_response)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-8" title="8"><span class="st">  </span><span class="kw">rename</span>(<span class="st">`</span><span class="dt">p(Y = 1)</span><span class="st">`</span> =<span class="st"> </span>p, <span class="st">`</span><span class="dt">p(Y = response)</span><span class="st">`</span> =<span class="st"> </span>p_response,</a>
<a class="sourceLine" id="cb49-9" title="9">         <span class="st">`</span><span class="dt">log(p(Y = response))</span><span class="st">`</span> =<span class="st"> </span>log_p) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-10" title="10"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-11" title="11"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-12" title="12"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</a>
<a class="sourceLine" id="cb49-13" title="13">                <span class="dt">full_width =</span> F)</a></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
response
</th>
<th style="text-align:right;">
p(Y = 1)
</th>
<th style="text-align:right;">
p(Y = response)
</th>
<th style="text-align:right;">
log(p(Y = response))
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
-1.07
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
-0.75
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
-1.20
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;">
-0.22
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
-0.58
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
-0.36
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
-0.52
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
-0.43
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
-0.48
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
-0.54
</td>
</tr>
</tbody>
</table>
<p>Let’s calculate the log-likelihood by hand:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">fit <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> <span class="kw">inv.logit</span>(fitted),</a>
<a class="sourceLine" id="cb50-5" title="5">         <span class="dt">log_likelihood =</span> response <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(p) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>response) <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-6" title="6"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">log_likelihood =</span> <span class="kw">sum</span>(log_likelihood))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   log_likelihood
##            &lt;dbl&gt;
## 1          -605.</code></pre>
<p>And compare it with the model summary</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">fit <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="st">  </span><span class="kw">glance</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-3" title="3"><span class="st">  </span><span class="kw">select</span>(logLik, AIC, BIC) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-4" title="4"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-5" title="5"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</a>
<a class="sourceLine" id="cb52-6" title="6">                <span class="dt">full_width =</span> F)</a></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-604.82
</td>
<td style="text-align:right;">
1213.64
</td>
<td style="text-align:right;">
1223.45
</td>
</tr>
</tbody>
</table>
<p>We’re getting the same result – neat! Now we know how the likelihood of the data is calculated for a logistic regression model.</p>
</div>
</div>
<div id="testing-hypotheses" class="section level2">
<h2><span class="header-section-number">20.6</span> Testing hypotheses</h2>
<p>To test hypotheses, we use our gold old model comparison approach:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># fit compact model</span></a>
<a class="sourceLine" id="cb53-2" title="2">fit.compact =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>fare,</a>
<a class="sourceLine" id="cb53-3" title="3">                  <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb53-4" title="4">                  <span class="dt">data =</span> df.titanic)</a>
<a class="sourceLine" id="cb53-5" title="5"></a>
<a class="sourceLine" id="cb53-6" title="6"><span class="co"># fit augmented model</span></a>
<a class="sourceLine" id="cb53-7" title="7">fit.augmented =<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> survived <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>fare,</a>
<a class="sourceLine" id="cb53-8" title="8">                    <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>,</a>
<a class="sourceLine" id="cb53-9" title="9">                    <span class="dt">data =</span> df.titanic)</a>
<a class="sourceLine" id="cb53-10" title="10"></a>
<a class="sourceLine" id="cb53-11" title="11"><span class="co"># likelihood ratio test</span></a>
<a class="sourceLine" id="cb53-12" title="12"><span class="kw">anova</span>(fit.compact, fit.augmented, <span class="dt">test =</span> <span class="st">&quot;LRT&quot;</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: survived ~ 1 + fare
## Model 2: survived ~ 1 + sex + fare
##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
## 1       889    1117.57                          
## 2       888     884.31  1   233.26 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note that in order to get a p-value out of this, we need to specify what statistical test we’d like to run. In this case, we use the likelihood ratio test (“LRT”).</p>
</div>
<div id="logistic-mixed-effects-model" class="section level2">
<h2><span class="header-section-number">20.7</span> Logistic mixed effects model</h2>
<p>Just like we can build linear mixed effects models using <code>lmer()</code> instead of <code>lm()</code>, we can also build a logistic mixed effects regression using <code>glmer()</code> instead of <code>glm()</code>.</p>
<p>Let’s read in some data:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="co"># load bdf data set from nlme package</span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">data</span>(bdf, <span class="dt">package =</span> <span class="st">&quot;nlme&quot;</span>)</a>
<a class="sourceLine" id="cb55-3" title="3"></a>
<a class="sourceLine" id="cb55-4" title="4">df.language =<span class="st"> </span>bdf <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-5" title="5"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-6" title="6"><span class="st">  </span><span class="kw">filter</span>(repeatgr <span class="op">!=</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">repeatgr =</span> repeatgr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.numeric</span>())</a>
<a class="sourceLine" id="cb55-8" title="8"></a>
<a class="sourceLine" id="cb55-9" title="9"><span class="kw">rm</span>(bdf)</a></code></pre></div>
<p>Fit the model, and print out the results:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">fit =<span class="st">  </span><span class="kw">glmer</span>(repeatgr <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>ses <span class="op">+</span><span class="st"> </span>minority <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school_nr),</a>
<a class="sourceLine" id="cb56-2" title="2">             <span class="dt">data =</span> df.language,</a>
<a class="sourceLine" id="cb56-3" title="3">             <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb56-4" title="4"></a>
<a class="sourceLine" id="cb56-5" title="5">fit <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb56-6" title="6"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: repeatgr ~ 1 + ses + minority + (1 | school_nr)
##    Data: df.language
## 
##      AIC      BIC   logLik deviance df.resid 
##   1659.1   1682.1   -825.6   1651.1     2279 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -0.9235 -0.4045 -0.3150 -0.2249  5.8372 
## 
## Random effects:
##  Groups    Name        Variance Std.Dev.
##  school_nr (Intercept) 0.2489   0.4989  
## Number of obs: 2283, groups:  school_nr, 131
## 
## Fixed effects:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.506291   0.197570  -2.563  0.01039 *  
## ses         -0.060086   0.007524  -7.986 1.39e-15 ***
## minorityY    0.673612   0.238660   2.822  0.00477 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##           (Intr) ses   
## ses       -0.898       
## minorityY -0.308  0.208</code></pre>
<p>To visualize the results, we can use the <code>ggeffects</code> package.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">ggpredict</span>(<span class="dt">model =</span> fit,</a>
<a class="sourceLine" id="cb58-2" title="2">          <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;ses [all]&quot;</span>, <span class="st">&quot;minority&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-3" title="3"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/glm-34-1.png" width="672" /></p>
</div>
<div id="logit-transform" class="section level2">
<h2><span class="header-section-number">20.8</span> Logit transform</h2>
<p>Here is a visualization of what the odds and log odds transformation look like.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co"># odds </span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)),</a>
<a class="sourceLine" id="cb59-3" title="3">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> <span class="op">~</span><span class="st"> </span>.<span class="op">/</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>.),</a>
<a class="sourceLine" id="cb59-5" title="5">                <span class="dt">size =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/glm-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co"># logg odds </span></a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)),</a>
<a class="sourceLine" id="cb60-3" title="3">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(.<span class="op">/</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>.)),</a>
<a class="sourceLine" id="cb60-5" title="5">                <span class="dt">size =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/glm-35-2.png" width="672" /></p>
</div>
<div id="additional-information" class="section level2">
<h2><span class="header-section-number">20.9</span> Additional information</h2>
<div id="datacamp-6" class="section level3">
<h3><span class="header-section-number">20.9.1</span> Datacamp</h3>
<ul>
<li><a href="https://www.datacamp.com/courses/multiple-and-logistic-regression">Multiple and logistic regression</a></li>
<li><a href="https://www.datacamp.com/courses/generalized-linear-models-in-r">Generalized linear models in R</a></li>
<li><a href="https://www.datacamp.com/courses/categorical-data-in-the-tidyverse">Categorical data in the tidyverse</a></li>
</ul>
</div>
</div>
<div id="session-info-18" class="section level2">
<h2><span class="header-section-number">20.10</span> Session info</h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Mojave 10.14.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] forcats_0.5.0    stringr_1.4.0    dplyr_0.8.4      purrr_0.3.3     
##  [5] readr_1.3.1      tidyr_1.0.2      tibble_2.1.3     ggplot2_3.3.0   
##  [9] tidyverse_1.3.0  ggeffects_0.14.1 boot_1.3-24      lme4_1.1-21     
## [13] Matrix_1.2-18    broom_0.5.5      janitor_1.2.1    kableExtra_1.1.0
## [17] titanic_0.1.0    knitr_1.28      
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-145       fs_1.3.2           lubridate_1.7.4    insight_0.8.1     
##  [5] webshot_0.5.2      RColorBrewer_1.1-2 httr_1.4.1         tools_3.6.2       
##  [9] backports_1.1.5    utf8_1.1.4         R6_2.4.1           sjlabelled_1.1.3  
## [13] DBI_1.1.0          mgcv_1.8-31        colorspace_1.4-1   nnet_7.3-13       
## [17] withr_2.1.2        tidyselect_1.0.0   compiler_3.6.2     cli_2.0.2         
## [21] rvest_0.3.5        xml2_1.2.2         labeling_0.3       effects_4.1-4     
## [25] bookdown_0.18      scales_1.1.0       digest_0.6.25      minqa_1.2.4       
## [29] rmarkdown_2.1      pkgconfig_2.0.3    htmltools_0.4.0    dbplyr_1.4.2      
## [33] highr_0.8          rlang_0.4.5        readxl_1.3.1       rstudioapi_0.11   
## [37] generics_0.0.2     farver_2.0.3       jsonlite_1.6.1     magrittr_1.5      
## [41] Rcpp_1.0.3         munsell_0.5.0      fansi_0.4.1        lifecycle_0.1.0   
## [45] stringi_1.4.6      yaml_2.2.1         snakecase_0.11.0   carData_3.0-3     
## [49] MASS_7.3-51.5      grid_3.6.2         crayon_1.3.4       lattice_0.20-40   
## [53] haven_2.2.0        splines_3.6.2      hms_0.5.3          pillar_1.4.3      
## [57] estimability_1.3   reprex_0.3.0       glue_1.3.1         evaluate_0.14     
## [61] mitools_2.4        modelr_0.1.6       vctrs_0.2.3        nloptr_1.2.1      
## [65] cellranger_1.1.0   gtable_0.3.0       assertthat_0.2.1   xfun_0.12         
## [69] survey_3.37        survival_3.1-8     viridisLite_0.3.0</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-mixed-effects-models-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-data-analysis-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/20-generalized_linear_model.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
