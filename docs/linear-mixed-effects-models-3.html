<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Linear mixed effects models 3 | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Linear mixed effects models 3 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Linear mixed effects models 3 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2020-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-mixed-effects-models-2.html"/>
<link rel="next" href="generalized-linear-model.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a><ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="visualization-1.html"><a href="visualization-1.html#how-not-to-visualize-data"><i class="fa fa-check"></i><b>2.3.1</b> How <em>not</em> to visualize data</a></li>
<li class="chapter" data-level="2.3.2" data-path="visualization-1.html"><a href="visualization-1.html#how-to-make-it-better"><i class="fa fa-check"></i><b>2.3.2</b> How to make it better</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.5</b> Getting help</a></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization-using-ggplot2"><i class="fa fa-check"></i><b>2.6</b> Data visualization using <code>ggplot2</code></a><ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.6.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.6.2</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.6.3</b> Scatter plot</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.6.4</b> Line plot</a></li>
<li class="chapter" data-level="2.6.5" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.6.5</b> Adding error bars</a></li>
<li class="chapter" data-level="2.6.6" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.6.6</b> Grouping data</a></li>
<li class="chapter" data-level="2.6.7" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.6.7</b> Making facets</a></li>
<li class="chapter" data-level="2.6.8" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.6.8</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.7</b> Additional resources</a><ul>
<li class="chapter" data-level="2.7.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.7.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.7.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.7.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.7.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.7.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a><ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a><ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a><ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a><ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a><ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-2"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#install-packages"><i class="fa fa-check"></i><b>4.2</b> Install packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.3</b> Load packages</a></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.4</b> Some R basics</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.4.1</b> Modes</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.4.2</b> Data types</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.4.3</b> Operators</a></li>
<li class="chapter" data-level="4.4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.4.4</b> Control flow</a></li>
<li class="chapter" data-level="4.4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.4.5</b> Functions</a></li>
<li class="chapter" data-level="4.4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.4.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
<li class="chapter" data-level="4.5.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.5.7</b> A quick note on naming things</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a><ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.4</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.5</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.7</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a><ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="4.7.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#misc-2"><i class="fa fa-check"></i><b>4.7.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a><ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-3"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.3</b> Wrangling data (continued)</a><ul>
<li class="chapter" data-level="5.3.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.3.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.3.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.3.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.3.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.3.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.4</b> Reading in data</a><ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.4.1</b> csv</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.4.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.5</b> Saving data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.6</b> Additional resources</a><ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.6.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.6.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.6.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.6.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a><ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#learning-goals-4"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#install-and-load-packages-load-data-set-theme-1"><i class="fa fa-check"></i><b>6.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.3</b> Counting</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.5</b> The random secretary</a></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.6</b> Clue guide to probability</a><ul>
<li class="chapter" data-level="6.6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.6.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.6.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.7</b> Probability operations</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.8</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-networks"><i class="fa fa-check"></i><b>6.9</b> Bayesian networks</a><ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#sprinkler-example"><i class="fa fa-check"></i><b>6.9.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a><ul>
<li class="chapter" data-level="6.10.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.10.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.10.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-3"><i class="fa fa-check"></i><b>6.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a><ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#learning-goals-5"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.3</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.5</b> Computing probabilities</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a><ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#working-with-samples"><i class="fa fa-check"></i><b>7.5</b> Working with samples</a><ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.5.1</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="simulation-1.html"><a href="simulation-1.html#the-quantile-function"><i class="fa fa-check"></i><b>7.5.2</b> The <code>quantile()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#comparing-probability-distributions"><i class="fa fa-check"></i><b>7.6</b> Comparing probability distributions</a></li>
<li class="chapter" data-level="7.7" data-path="simulation-1.html"><a href="simulation-1.html#relationship-between-probability-and-likelihood"><i class="fa fa-check"></i><b>7.7</b> Relationship between probability and likelihood</a></li>
<li class="chapter" data-level="7.8" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.8</b> Additional resources</a><ul>
<li class="chapter" data-level="7.8.1" data-path="simulation-1.html"><a href="simulation-1.html#cheatsheets-5"><i class="fa fa-check"></i><b>7.8.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="7.8.2" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.8.2</b> Datacamp</a></li>
<li class="chapter" data-level="7.8.3" data-path="simulation-1.html"><a href="simulation-1.html#tutorials-1"><i class="fa fa-check"></i><b>7.8.3</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a><ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#learning-goals-6"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>8.3</b> The central limit theorem</a><ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.3.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.3.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.3.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.3.3</b> The sampling distribution</a></li>
<li class="chapter" data-level="8.3.4" data-path="simulation-2.html"><a href="simulation-2.html#exploring-the-clt"><i class="fa fa-check"></i><b>8.3.4</b> Exploring the CLT</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.4</b> Understanding p-values</a><ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.4.1</b> Permutation test</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.6</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a><ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#learning-goals-7"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.3</b> Modeling data</a><ul>
<li class="chapter" data-level="9.3.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.3.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.3.2" data-path="modeling-data.html"><a href="modeling-data.html#error-definitions-and-best-estimators"><i class="fa fa-check"></i><b>9.3.2</b> Error definitions and best estimators</a></li>
<li class="chapter" data-level="9.3.3" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.3.3</b> Sampling distributions for median and mean</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.4</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.5</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6</b> Additional resources</a><ul>
<li class="chapter" data-level="9.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.6.1</b> Reading</a></li>
<li class="chapter" data-level="9.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-1"><i class="fa fa-check"></i><b>9.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-7"><i class="fa fa-check"></i><b>9.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a><ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#learning-goals-8"><i class="fa fa-check"></i><b>10.1</b> Learning goals</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.3</b> Correlation</a></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.4</b> Regression</a><ul>
<li class="chapter" data-level="10.4.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.4.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.4.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.5</b> Credit example</a></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.6</b> Additional resources</a><ul>
<li class="chapter" data-level="10.6.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-2"><i class="fa fa-check"></i><b>10.6.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.6.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-4"><i class="fa fa-check"></i><b>10.6.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-8"><i class="fa fa-check"></i><b>10.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a><ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-9"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a><ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a><ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a><ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a><ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a><ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-3"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-5"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-9"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a><ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-10"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a><ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
<li class="chapter" data-level="12.5.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.5.5</b> Two-way ANOVA (with interaction)</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>12.6</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.7</b> Additional resources</a><ul>
<li class="chapter" data-level="12.7.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-4"><i class="fa fa-check"></i><b>12.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.7.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-6"><i class="fa fa-check"></i><b>12.7.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-10"><i class="fa fa-check"></i><b>12.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a><ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#learning-goals-11"><i class="fa fa-check"></i><b>13.1</b> Learning goals</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.3</b> Load data sets</a></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#planned-contrasts"><i class="fa fa-check"></i><b>13.4</b> Planned contrasts</a><ul>
<li class="chapter" data-level="13.4.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.4.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.4.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.4.2</b> Visualization</a></li>
<li class="chapter" data-level="13.4.3" data-path="linear-model-4.html"><a href="linear-model-4.html#constrasts"><i class="fa fa-check"></i><b>13.4.3</b> Constrasts</a></li>
<li class="chapter" data-level="13.4.4" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.4.4</b> Post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-11"><i class="fa fa-check"></i><b>13.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a><ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-12"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a><ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#eta-squared-and-partial-eta-squared"><i class="fa fa-check"></i><b>14.5.1</b> eta-squared and partial eta-squared</a></li>
<li class="chapter" data-level="14.5.2" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.2</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a><ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-via-simulation"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis via simulation</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-11"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a><ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-5"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-6"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-7"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-12"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mediation-moderation.html"><a href="mediation-moderation.html"><i class="fa fa-check"></i><b>15</b> Mediation &amp; Moderation</a><ul>
<li class="chapter" data-level="15.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#learning-goals-13"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#recommended-reading"><i class="fa fa-check"></i><b>15.2</b> Recommended reading</a></li>
<li class="chapter" data-level="15.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#controlling-for-variables"><i class="fa fa-check"></i><b>15.4</b> Controlling for variables</a><ul>
<li class="chapter" data-level="15.4.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>15.4.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="15.4.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#good-controls"><i class="fa fa-check"></i><b>15.4.2</b> Good controls</a></li>
<li class="chapter" data-level="15.4.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#bad-controls"><i class="fa fa-check"></i><b>15.4.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mediation-moderation.html"><a href="mediation-moderation.html#mediation"><i class="fa fa-check"></i><b>15.5</b> Mediation</a><ul>
<li class="chapter" data-level="15.5.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data"><i class="fa fa-check"></i><b>15.5.1</b> Generate data</a></li>
<li class="chapter" data-level="15.5.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>15.5.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="15.5.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>15.5.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="15.5.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>15.5.4</b> Method 3: Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation"><i class="fa fa-check"></i><b>15.6</b> Moderation</a><ul>
<li class="chapter" data-level="15.6.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data-1"><i class="fa fa-check"></i><b>15.6.1</b> Generate data</a></li>
<li class="chapter" data-level="15.6.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation-analysis"><i class="fa fa-check"></i><b>15.6.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="mediation-moderation.html"><a href="mediation-moderation.html#additional-resources-12"><i class="fa fa-check"></i><b>15.7</b> Additional resources</a><ul>
<li class="chapter" data-level="15.7.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#books"><i class="fa fa-check"></i><b>15.7.1</b> Books</a></li>
<li class="chapter" data-level="15.7.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#tutorials-2"><i class="fa fa-check"></i><b>15.7.2</b> Tutorials</a></li>
<li class="chapter" data-level="15.7.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#misc-8"><i class="fa fa-check"></i><b>15.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="mediation-moderation.html"><a href="mediation-moderation.html#session-info-13"><i class="fa fa-check"></i><b>15.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>16</b> Model comparison</a><ul>
<li class="chapter" data-level="16.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-14"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>16.3</b> Model comparison</a><ul>
<li class="chapter" data-level="16.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>16.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="16.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>16.3.2</b> F-test</a></li>
<li class="chapter" data-level="16.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>16.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="16.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>16.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="16.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>16.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>16.4</b> Additional resources</a><ul>
<li class="chapter" data-level="16.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>16.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="16.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>16.4.2</b> Reading</a></li>
<li class="chapter" data-level="16.4.3" data-path="model-comparison.html"><a href="model-comparison.html#misc-9"><i class="fa fa-check"></i><b>16.4.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-14"><i class="fa fa-check"></i><b>16.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a><ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-15"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a><ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-15"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a><ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-16"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>18.3</b> Simulating a linear mixed effects model</a></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.4</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.5</b> Different slopes</a></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.6</b> Simpson’s paradox</a></li>
<li class="chapter" data-level="18.7" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.7</b> Additional resources</a><ul>
<li class="chapter" data-level="18.7.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.7.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-16"><i class="fa fa-check"></i><b>18.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a><ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-17"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-set"><i class="fa fa-check"></i><b>19.3</b> Load data set</a></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixtures-of-participants"><i class="fa fa-check"></i><b>19.4</b> Mixtures of participants</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#pooling-and-shrinkage"><i class="fa fa-check"></i><b>19.5</b> Pooling and shrinkage</a><ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#complete-pooling"><i class="fa fa-check"></i><b>19.5.1</b> Complete pooling</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#no-pooling"><i class="fa fa-check"></i><b>19.5.2</b> No pooling</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#partial-pooling"><i class="fa fa-check"></i><b>19.5.3</b> Partial pooling</a></li>
<li class="chapter" data-level="19.5.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#compare-results"><i class="fa fa-check"></i><b>19.5.4</b> Compare results</a></li>
<li class="chapter" data-level="19.5.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#coefficients"><i class="fa fa-check"></i><b>19.5.5</b> Coefficients</a></li>
<li class="chapter" data-level="19.5.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#shrinkage"><i class="fa fa-check"></i><b>19.5.6</b> Shrinkage</a></li>
<li class="chapter" data-level="19.5.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#plotting-marginal-effects"><i class="fa fa-check"></i><b>19.5.7</b> Plotting marginal effects</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#bootstrapping"><i class="fa fa-check"></i><b>19.6</b> Bootstrapping</a><ul>
<li class="chapter" data-level="19.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#linear-model"><i class="fa fa-check"></i><b>19.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#getting-p-values"><i class="fa fa-check"></i><b>19.7</b> Getting p-values</a></li>
<li class="chapter" data-level="19.8" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.8</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-17"><i class="fa fa-check"></i><b>19.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>20</b> Generalized linear model</a><ul>
<li class="chapter" data-level="20.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-18"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set-1"><i class="fa fa-check"></i><b>20.3</b> Load data set</a></li>
<li class="chapter" data-level="20.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>20.4</b> Logistic regression</a><ul>
<li class="chapter" data-level="20.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>20.4.1</b> Interpreting the parameters</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>20.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="20.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>20.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="20.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>20.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="20.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>20.8</b> Additional information</a><ul>
<li class="chapter" data-level="20.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-6"><i class="fa fa-check"></i><b>20.8.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-18"><i class="fa fa-check"></i><b>20.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html"><i class="fa fa-check"></i><b>21</b> Bayesian data analysis 1</a><ul>
<li class="chapter" data-level="21.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#learning-goals-19"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#things-that-came-up"><i class="fa fa-check"></i><b>21.3</b> Things that came up</a><ul>
<li class="chapter" data-level="21.3.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bias-in-cosyne-2019-conference-admission"><i class="fa fa-check"></i><b>21.3.1</b> Bias in Cosyne 2019 conference admission?</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#session-info-19"><i class="fa fa-check"></i><b>21.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 2</a><ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-20"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>22.3</b> Doing Bayesian inference “by hand”</a><ul>
<li class="chapter" data-level="22.3.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#coin-flip-example"><i class="fa fa-check"></i><b>22.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="22.3.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>22.3.3</b> Bayesian inference by discretization</a></li>
<li class="chapter" data-level="22.3.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-prior"><i class="fa fa-check"></i><b>22.3.4</b> Effect of the prior</a></li>
<li class="chapter" data-level="22.3.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-likelihood"><i class="fa fa-check"></i><b>22.3.5</b> Effect of the likelihood</a></li>
<li class="chapter" data-level="22.3.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-sample-size"><i class="fa fa-check"></i><b>22.3.6</b> Effect of the sample size</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#distributions"><i class="fa fa-check"></i><b>22.4</b> Distributions</a><ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#normal-vs-student-t-distribution"><i class="fa fa-check"></i><b>22.4.1</b> Normal vs Student-t distribution</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#beta-distributions"><i class="fa fa-check"></i><b>22.4.2</b> Beta distributions</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#normal-distributions"><i class="fa fa-check"></i><b>22.4.3</b> Normal distributions</a></li>
<li class="chapter" data-level="22.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#distributions-for-non-negative-parameters"><i class="fa fa-check"></i><b>22.4.4</b> Distributions for non-negative parameters</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#inference-via-sampling"><i class="fa fa-check"></i><b>22.5</b> Inference via sampling</a></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#greta"><i class="fa fa-check"></i><b>22.6</b> Greta</a><ul>
<li class="chapter" data-level="22.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#attitude-data-set"><i class="fa fa-check"></i><b>22.6.1</b> Attitude data set</a></li>
<li class="chapter" data-level="22.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#frequentist-analysis"><i class="fa fa-check"></i><b>22.6.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="22.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#bayesian-regression"><i class="fa fa-check"></i><b>22.6.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-20"><i class="fa fa-check"></i><b>22.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 3</a><ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-21"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-data-set-2"><i class="fa fa-check"></i><b>23.3</b> Load data set</a></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#poker"><i class="fa fa-check"></i><b>23.4</b> Poker</a><ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualization-7"><i class="fa fa-check"></i><b>23.4.1</b> Visualization</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#linear-model-5"><i class="fa fa-check"></i><b>23.4.2</b> Linear model</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-model"><i class="fa fa-check"></i><b>23.4.3</b> Bayesian model</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>23.5</b> Dealing with heteroscedasticity</a></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>23.6</b> Ordinal regression</a></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-16"><i class="fa fa-check"></i><b>23.7</b> Additional resources</a></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-21"><i class="fa fa-check"></i><b>23.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>24</b> Reporting statistics</a><ul>
<li class="chapter" data-level="24.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>24.1</b> General advice</a><ul>
<li class="chapter" data-level="24.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>24.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="24.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>24.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="24.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>24.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="24.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>24.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="24.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>24.1.5</b> Frequentist statistics</a></li>
<li class="chapter" data-level="24.1.6" data-path="reporting-statistics.html"><a href="reporting-statistics.html#bayesian-statistics"><i class="fa fa-check"></i><b>24.1.6</b> Bayesian statistics –&gt;</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-22"><i class="fa fa-check"></i><b>24.2</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html"><i class="fa fa-check"></i><b>25</b> Cheatsheets</a><ul>
<li class="chapter" data-level="25.1" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#statistics"><i class="fa fa-check"></i><b>25.1</b> Statistics</a></li>
<li class="chapter" data-level="25.2" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#r"><i class="fa fa-check"></i><b>25.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-mixed-effects-models-3" class="section level1">
<h1><span class="header-section-number">Chapter 19</span> Linear mixed effects models 3</h1>
<div id="learning-goals-17" class="section level2">
<h2><span class="header-section-number">19.1</span> Learning goals</h2>
<ul>
<li>Bootstrapping linear mixed effects models.</li>
<li>Getting p-values.</li>
<li>Pitfalls in fitting <code>lmers()</code>s (and what to do about it).</li>
<li>Understanding <code>lmer()</code> syntax even better.</li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-12" class="section level2">
<h2><span class="header-section-number">19.2</span> Load packages and set plotting theme</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(<span class="st">&quot;knitr&quot;</span>)       <span class="co"># for knitting RMarkdown </span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>)  <span class="co"># for making nice tables</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(<span class="st">&quot;janitor&quot;</span>)     <span class="co"># for cleaning column names</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)       <span class="co"># for tidying up linear models </span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(<span class="st">&quot;broom.mixed&quot;</span>) <span class="co"># for tidying up linear mixed effects models </span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(<span class="st">&quot;patchwork&quot;</span>)   <span class="co"># for making figure panels</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(<span class="st">&quot;lme4&quot;</span>)        <span class="co"># for linear mixed effects models</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(<span class="st">&quot;modelr&quot;</span>)      <span class="co"># for bootstrapping</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">library</span>(<span class="st">&quot;boot&quot;</span>)        <span class="co"># also for bootstrapping</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">library</span>(<span class="st">&quot;ggeffects&quot;</span>)   <span class="co"># for plotting marginal effects</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)   <span class="co"># for wrangling, plotting, etc. </span></a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co"># include references for used packages</span></a>
<a class="sourceLine" id="cb1-14" title="14">knitr<span class="op">::</span><span class="kw">write_bib</span>(<span class="kw">.packages</span>(), <span class="st">&quot;packages.bib&quot;</span>) </a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">theme_set</span>(<span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="co">#set the theme </span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">            </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></a></code></pre></div>
</div>
<div id="load-data-set" class="section level2">
<h2><span class="header-section-number">19.3</span> Load data set</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># load sleepstudy data set </span></a>
<a class="sourceLine" id="cb3-2" title="2">df.sleep =<span class="st"> </span>sleepstudy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">subject =</span> <span class="kw">as.character</span>(subject)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="st">  </span><span class="kw">select</span>(subject, days, reaction)</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># add two fake participants (with missing data)</span></a>
<a class="sourceLine" id="cb4-2" title="2">df.sleep =<span class="st"> </span>df.sleep <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">  </span><span class="kw">bind_rows</span>(<span class="kw">tibble</span>(<span class="dt">subject =</span> <span class="st">&quot;374&quot;</span>,</a>
<a class="sourceLine" id="cb4-4" title="4">                   <span class="dt">days =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb4-5" title="5">                   <span class="dt">reaction =</span> <span class="kw">c</span>(<span class="dv">286</span>, <span class="dv">288</span>)),</a>
<a class="sourceLine" id="cb4-6" title="6">            <span class="kw">tibble</span>(<span class="dt">subject =</span> <span class="st">&quot;373&quot;</span>,</a>
<a class="sourceLine" id="cb4-7" title="7">                   <span class="dt">days =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb4-8" title="8">                   <span class="dt">reaction =</span> <span class="dv">245</span>))</a></code></pre></div>
</div>
<div id="mixtures-of-participants" class="section level2">
<h2><span class="header-section-number">19.4</span> Mixtures of participants</h2>
<p>What if we have groups of participants who differ from each other? Let’s generate data for which this is the case.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># make example reproducible </span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4">sample_size =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb5-5" title="5">b0 =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-6" title="6">b1 =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb5-7" title="7">sd_residual =<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb5-8" title="8">sd_participant =<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb5-9" title="9">mean_group1 =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-10" title="10">mean_group2 =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb5-11" title="11"></a>
<a class="sourceLine" id="cb5-12" title="12">df.mixed =<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb5-13" title="13">  <span class="dt">condition =</span> <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">each =</span> sample_size), </a>
<a class="sourceLine" id="cb5-14" title="14">  <span class="dt">participant =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>sample_size, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="st">  </span><span class="kw">group_by</span>(participant) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb5-17" title="17">         <span class="dt">intercept =</span> <span class="kw">ifelse</span>(group <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb5-18" title="18">                            <span class="kw">rnorm</span>(<span class="kw">n</span>(), <span class="dt">mean =</span> mean_group1, <span class="dt">sd =</span> sd_participant),</a>
<a class="sourceLine" id="cb5-19" title="19">                            <span class="kw">rnorm</span>(<span class="kw">n</span>(), <span class="dt">mean =</span> mean_group2, <span class="dt">sd =</span> sd_participant))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="st">  </span><span class="kw">group_by</span>(condition) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>condition <span class="op">+</span><span class="st"> </span>intercept <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">n</span>(), <span class="dt">sd =</span> sd_residual)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">condition =</span> <span class="kw">as.factor</span>(condition),</a>
<a class="sourceLine" id="cb5-24" title="24">         <span class="dt">participant =</span> <span class="kw">as.factor</span>(participant))</a></code></pre></div>
<div id="ignoring-mixture" class="section level4">
<h4><span class="header-section-number">19.4.0.1</span> Ignoring mixture</h4>
<p>Let’ first fit a model that ignores the fact that there are two different groups of participatns.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># fit model</span></a>
<a class="sourceLine" id="cb6-2" title="2">fit.mixed =<span class="st"> </span><span class="kw">lmer</span>(<span class="dt">formula =</span> value <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>condition <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>participant),</a>
<a class="sourceLine" id="cb6-3" title="3">                <span class="dt">data =</span> df.mixed)</a>
<a class="sourceLine" id="cb6-4" title="4"></a>
<a class="sourceLine" id="cb6-5" title="5">fit.mixed <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: value ~ 1 + condition + (1 | participant)
##    Data: df.mixed
## 
## REML criterion at convergence: 163.5
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -1.62997 -0.41663 -0.05607  0.54750  1.54023 
## 
## Random effects:
##  Groups      Name        Variance Std.Dev.
##  participant (Intercept) 19.2206  4.3841  
##  Residual                 0.3521  0.5934  
## Number of obs: 40, groups:  participant, 20
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)   5.8729     0.9893   5.937
## condition1    1.6652     0.1876   8.875
## 
## Correlation of Fixed Effects:
##            (Intr)
## condition1 -0.095</code></pre>
<p>Let’s look at the model’s predictions:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">fit.mixed <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb8-5" title="5">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> condition,</a>
<a class="sourceLine" id="cb8-6" title="6">                       <span class="dt">y =</span> value,</a>
<a class="sourceLine" id="cb8-7" title="7">                       <span class="dt">group =</span> participant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> fitted),</a>
<a class="sourceLine" id="cb8-11" title="11">             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> fitted),</a>
<a class="sourceLine" id="cb8-13" title="13">             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-08-1.png" width="672" /></p>
<p>And let’s simulate some data from the fitted model:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># simulated data </span></a>
<a class="sourceLine" id="cb9-2" title="2">fit.mixed <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">simulate</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">bind_cols</span>(df.mixed) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb9-6" title="6">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> condition,</a>
<a class="sourceLine" id="cb9-7" title="7">                       <span class="dt">y =</span> sim_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb9-8" title="8">                       <span class="dt">group =</span> participant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-09-1.png" width="672" /></p>
<p>As we can see, the simulated data doesn’t look like the data that was used to fit the model.</p>
</div>
<div id="modeling-mixture" class="section level4">
<h4><span class="header-section-number">19.4.0.2</span> Modeling mixture</h4>
<p>Now, let’s fit a model that takes the differences between groups into account by adding a fixed effect for <code>group</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># fit model</span></a>
<a class="sourceLine" id="cb10-2" title="2">fit.grouped =<span class="st"> </span><span class="kw">lmer</span>(<span class="dt">formula =</span> value <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>condition <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>participant),</a>
<a class="sourceLine" id="cb10-3" title="3">                <span class="dt">data =</span> df.mixed)</a>
<a class="sourceLine" id="cb10-4" title="4"></a>
<a class="sourceLine" id="cb10-5" title="5">fit.grouped <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: value ~ 1 + group + condition + (1 | participant)
##    Data: df.mixed
## 
## REML criterion at convergence: 82.2
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -1.61879 -0.61378  0.02557  0.49842  2.19076 
## 
## Random effects:
##  Groups      Name        Variance Std.Dev.
##  participant (Intercept) 0.09265  0.3044  
##  Residual                0.35208  0.5934  
## Number of obs: 40, groups:  participant, 20
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  -6.3136     0.3633 -17.381
## group         8.7046     0.2366  36.791
## condition1    1.6652     0.1876   8.875
## 
## Correlation of Fixed Effects:
##            (Intr) group 
## group      -0.912       
## condition1 -0.258  0.000</code></pre>
<p>Note how the variance of the random intercepts is much smaller now that we’ve taken the group structure in the data into account.</p>
<p>Let’s visualize the model’s predictions:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">fit.grouped <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb12-5" title="5">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> condition,</a>
<a class="sourceLine" id="cb12-6" title="6">                       <span class="dt">y =</span> value,</a>
<a class="sourceLine" id="cb12-7" title="7">                       <span class="dt">group =</span> participant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> fitted),</a>
<a class="sourceLine" id="cb12-11" title="11">             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> fitted),</a>
<a class="sourceLine" id="cb12-13" title="13">             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-11-1.png" width="672" /></p>
<p>And simulate some data from the model:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># simulated data </span></a>
<a class="sourceLine" id="cb13-2" title="2">fit.grouped <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw">simulate</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">  </span><span class="kw">bind_cols</span>(df.mixed) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb13-6" title="6">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> condition,</a>
<a class="sourceLine" id="cb13-7" title="7">                       <span class="dt">y =</span> sim_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb13-8" title="8">                       <span class="dt">group =</span> participant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-12-1.png" width="672" /></p>
<p>This time, the simulated data looks much more like the data that was used to fit the model. Yay!</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">ggpredict</span>(<span class="dt">model =</span> fit.grouped,</a>
<a class="sourceLine" id="cb14-2" title="2">          <span class="dt">terms =</span> <span class="st">&quot;condition&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">ggpredict</span>(<span class="dt">model =</span> fit.mixed,</a>
<a class="sourceLine" id="cb15-2" title="2">          <span class="dt">terms =</span> <span class="st">&quot;condition&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-13-2.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># fit.mixed %&gt;% </span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co">#   summary()</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co"># fit.grouped %&gt;% </span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co">#   summary()</span></a></code></pre></div>
</div>
<div id="heterogeneity-in-variance" class="section level4">
<h4><span class="header-section-number">19.4.0.3</span> Heterogeneity in variance</h4>
<p>The example above has shown that we can take overall differences between groups into account by adding a fixed effect. Can we also deal with heterogeneity in variance between groups? For example, what if the responses of one group exhibit much more variance than the responses of another group?</p>
<p>Let’s first generate some data with heterogeneous variance:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># make example reproducible </span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-3" title="3"></a>
<a class="sourceLine" id="cb17-4" title="4">sample_size =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb17-5" title="5">b0 =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb17-6" title="6">b1 =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb17-7" title="7">sd_residual =<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb17-8" title="8">mean_group1 =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb17-9" title="9">sd_group1 =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb17-10" title="10">mean_group2 =<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb17-11" title="11">sd_group2 =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb17-12" title="12"></a>
<a class="sourceLine" id="cb17-13" title="13">df.variance =<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb17-14" title="14">  <span class="dt">condition =</span> <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">each =</span> sample_size), </a>
<a class="sourceLine" id="cb17-15" title="15">  <span class="dt">participant =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>sample_size, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="st">  </span><span class="kw">group_by</span>(participant) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb17-18" title="18">         <span class="dt">intercept =</span> <span class="kw">ifelse</span>(group <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb17-19" title="19">                            <span class="kw">rnorm</span>(<span class="kw">n</span>(), <span class="dt">mean =</span> mean_group1, <span class="dt">sd =</span> sd_group1),</a>
<a class="sourceLine" id="cb17-20" title="20">                            <span class="kw">rnorm</span>(<span class="kw">n</span>(), <span class="dt">mean =</span> mean_group2, <span class="dt">sd =</span> sd_group2))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="st">  </span><span class="kw">group_by</span>(condition) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-22" title="22"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>condition <span class="op">+</span><span class="st"> </span>intercept <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">n</span>(), <span class="dt">sd =</span> sd_residual)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-23" title="23"><span class="st">  </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-24" title="24"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">condition =</span> <span class="kw">as.factor</span>(condition),</a>
<a class="sourceLine" id="cb17-25" title="25">         <span class="dt">participant =</span> <span class="kw">as.factor</span>(participant))</a></code></pre></div>
<p>Let’s fit the model:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># fit model</span></a>
<a class="sourceLine" id="cb18-2" title="2">fit.variance =<span class="st"> </span><span class="kw">lmer</span>(<span class="dt">formula =</span> value <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>condition <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>participant),</a>
<a class="sourceLine" id="cb18-3" title="3">                <span class="dt">data =</span> df.variance)</a>
<a class="sourceLine" id="cb18-4" title="4"></a>
<a class="sourceLine" id="cb18-5" title="5">fit.variance <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: value ~ 1 + group + condition + (1 | participant)
##    Data: df.variance
## 
## REML criterion at convergence: 232.7
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.96291 -0.19619  0.03751  0.28317  1.45552 
## 
## Random effects:
##  Groups      Name        Variance Std.Dev.
##  participant (Intercept) 17.12    4.137   
##  Residual                13.74    3.706   
## Number of obs: 40, groups:  participant, 20
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept) -24.0018     3.3669  -7.129
## group        27.0696     2.2353  12.110
## condition1    0.5716     1.1720   0.488
## 
## Correlation of Fixed Effects:
##            (Intr) group 
## group      -0.929       
## condition1 -0.174  0.000</code></pre>
<p>Look at the data and model predictions:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">fit.variance <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb20-5" title="5">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> condition,</a>
<a class="sourceLine" id="cb20-6" title="6">                       <span class="dt">y =</span> value,</a>
<a class="sourceLine" id="cb20-7" title="7">                       <span class="dt">group =</span> participant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> fitted),</a>
<a class="sourceLine" id="cb20-11" title="11">             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-12" title="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> fitted),</a>
<a class="sourceLine" id="cb20-13" title="13">             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-16-1.png" width="672" /></p>
<p>And the simulated data:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># simulated data </span></a>
<a class="sourceLine" id="cb21-2" title="2">fit.variance <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="st">  </span><span class="kw">simulate</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="st">  </span><span class="kw">bind_cols</span>(df.mixed) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb21-6" title="6">         <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> condition,</a>
<a class="sourceLine" id="cb21-7" title="7">                       <span class="dt">y =</span> sim_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb21-8" title="8">                       <span class="dt">group =</span> participant)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-17-1.png" width="672" /></p>
<p>The <code>lmer()</code> fails here. It uses one normal distribution to model the variance between participants. It cannot account for the fact that the answers of one group of participants vary more than the answers from another groups of participants. Again, the simulated data doesn’t look like the original data, even though we did take the grouping into account.</p>
</div>
</div>
<div id="pooling-and-shrinkage" class="section level2">
<h2><span class="header-section-number">19.5</span> Pooling and shrinkage</h2>
<p>Let’s illustrate the concept of pooling and shrinkage via the sleep data set that comes with the lmer package. We’ve already loaded the data set into our environment as <code>df.sleep</code>.</p>
<p>Let’s start by visualizing the data</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># visualize the data</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.sleep,</a>
<a class="sourceLine" id="cb22-3" title="3">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days, <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subject, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb22-7" title="7">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb22-10" title="10">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-18-1.png" width="672" /></p>
<p>The plot shows the effect of the number of days of sleep deprivation on the average reaction time (presumably in an experiment). Note that for participant 373 and 374 we only have one and two data points respectively.</p>
<div id="complete-pooling" class="section level3">
<h3><span class="header-section-number">19.5.1</span> Complete pooling</h3>
<p>Let’s first fit a model the simply combines all the data points. This model ignores the dependence structure in the data (i.e. the fact that we have repeated observations from the same participants).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">fit.complete =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span>days,</a>
<a class="sourceLine" id="cb23-2" title="2">                  <span class="dt">data =</span> df.sleep)</a>
<a class="sourceLine" id="cb23-3" title="3"></a>
<a class="sourceLine" id="cb23-4" title="4">fit.params =<span class="st"> </span><span class="kw">tidy</span>(fit.complete)</a>
<a class="sourceLine" id="cb23-5" title="5"></a>
<a class="sourceLine" id="cb23-6" title="6">fit.complete <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-7" title="7"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = reaction ~ days, data = df.sleep)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -110.646  -27.951    1.829   26.388  139.875 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  252.321      6.406  39.389  &lt; 2e-16 ***
## days          10.328      1.210   8.537 5.48e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 47.43 on 181 degrees of freedom
## Multiple R-squared:  0.2871, Adjusted R-squared:  0.2831 
## F-statistic: 72.88 on 1 and 181 DF,  p-value: 5.484e-15</code></pre>
<p>And let’s visualize the predictions of this model.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># visualization (aggregate) </span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.sleep,</a>
<a class="sourceLine" id="cb25-3" title="3">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days, <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> fit.params<span class="op">$</span>estimate[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb25-5" title="5">              <span class="dt">slope =</span> fit.params<span class="op">$</span>estimate[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb25-6" title="6">              <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb25-9" title="9">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb25-12" title="12">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-20-1.png" width="672" /></p>
<p>And here is what the model’s predictions look like separated by participant.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># visualization (separate participants) </span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.sleep,</a>
<a class="sourceLine" id="cb26-3" title="3">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days, <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> fit.params<span class="op">$</span>estimate[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb26-5" title="5">              <span class="dt">slope =</span> fit.params<span class="op">$</span>estimate[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb26-6" title="6">              <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subject, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb26-10" title="10">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-12" title="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb26-13" title="13">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-21-1.png" width="672" /></p>
<p>The model predicts the same relationship between sleep deprivation and reaction time for each participant (not surprising since we didn’t even tell the model that this data is based on different participants).</p>
</div>
<div id="no-pooling" class="section level3">
<h3><span class="header-section-number">19.5.2</span> No pooling</h3>
<p>We could also fit separate regressions for each participant. Let’s do that.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># fit regressions and extract parameter estimates </span></a>
<a class="sourceLine" id="cb27-2" title="2">df.no_pooling =<span class="st"> </span>df.sleep <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(subject) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">  </span><span class="kw">nest</span>(<span class="dt">data =</span> <span class="kw">c</span>(days, reaction)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">lm</span>(reaction <span class="op">~</span><span class="st"> </span>days, <span class="dt">data =</span> .)),</a>
<a class="sourceLine" id="cb27-6" title="6">         <span class="dt">params =</span> <span class="kw">map</span>(fit, tidy)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="st">  </span><span class="kw">unnest</span>(<span class="kw">c</span>(params)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="st">  </span><span class="kw">select</span>(subject, term, estimate) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="st">  </span><span class="kw">complete</span>(subject, term, <span class="dt">fill =</span> <span class="kw">list</span>(<span class="dt">estimate =</span> <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-11" title="11"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> term,</a>
<a class="sourceLine" id="cb27-12" title="12">              <span class="dt">values_from =</span> estimate) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="st">  </span><span class="kw">clean_names</span>()</a></code></pre></div>
<p>And let’s visualize what the predictions of these separate regressions would look like:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.sleep,</a>
<a class="sourceLine" id="cb28-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days,</a>
<a class="sourceLine" id="cb28-3" title="3">                     <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">data =</span> df.no_pooling <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="st">                </span><span class="kw">filter</span>(subject <span class="op">!=</span><span class="st"> </span><span class="dv">373</span>),</a>
<a class="sourceLine" id="cb28-6" title="6">              <span class="kw">aes</span>(<span class="dt">intercept =</span> intercept,</a>
<a class="sourceLine" id="cb28-7" title="7">                  <span class="dt">slope =</span> days),</a>
<a class="sourceLine" id="cb28-8" title="8">              <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb28-10" title="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subject, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb28-12" title="12">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb28-15" title="15">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-23-1.png" width="672" /></p>
<p>When we fit separate regression, no information is shared between participants.</p>
</div>
<div id="partial-pooling" class="section level3">
<h3><span class="header-section-number">19.5.3</span> Partial pooling</h3>
<p>By usign linear mixed effects models, we are partially pooling information. That is, the estimates for one participant are influenced by the rest of the participants.</p>
<p>We’ll fit a number of mixed effects models that differ in their random effects structure.</p>
<div id="random-intercept-and-random-slope" class="section level4">
<h4><span class="header-section-number">19.5.3.1</span> Random intercept and random slope</h4>
<p>This model allows for random differences in the intercepts and slopes between subjects (and also models the correlation between intercepts and slopes).</p>
<p>Let’s fit the model</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">fit.random_intercept_slope =<span class="st"> </span><span class="kw">lmer</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">|</span><span class="st"> </span>subject),</a>
<a class="sourceLine" id="cb29-2" title="2">                                  <span class="dt">data =</span> df.sleep)</a></code></pre></div>
<p>and take a look at the model’s predictions:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">fit.random_intercept_slope <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb30-5" title="5">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days,</a>
<a class="sourceLine" id="cb30-6" title="6">                     <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-7" title="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> fitted),</a>
<a class="sourceLine" id="cb30-8" title="8">            <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-9" title="9"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb30-10" title="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subject, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb30-12" title="12">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-14" title="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb30-15" title="15">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<pre><code>## geom_path: Each group consists of only one observation. Do you need to adjust
## the group aesthetic?</code></pre>
<p><img src="psych252_files/figure-html/lmer3-25-1.png" width="672" /></p>
<p>As we can see, the lines for each participant are different. We’ve allowed for the intercept as well as the relationship between sleep deprivation and reaction time to be different between participants.</p>
</div>
<div id="only-random-intercepts" class="section level4">
<h4><span class="header-section-number">19.5.3.2</span> Only random intercepts</h4>
<p>Let’s fit a model that only allows for the intercepts to vary between participants.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">fit.random_intercept =<span class="st"> </span><span class="kw">lmer</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>subject),</a>
<a class="sourceLine" id="cb32-2" title="2">                            <span class="dt">data =</span> df.sleep)</a></code></pre></div>
<p>And let’s visualize what these predictions look like:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">fit.random_intercept <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb33-5" title="5">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days,</a>
<a class="sourceLine" id="cb33-6" title="6">                     <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> fitted),</a>
<a class="sourceLine" id="cb33-8" title="8">            <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-9" title="9"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb33-10" title="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subject, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb33-12" title="12">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-14" title="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb33-15" title="15">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<pre><code>## geom_path: Each group consists of only one observation. Do you need to adjust
## the group aesthetic?</code></pre>
<p><img src="psych252_files/figure-html/lmer3-27-1.png" width="672" /></p>
<p>Now, all the lines are parallel but the intercept differs between participants.</p>
</div>
<div id="only-random-slopes" class="section level4">
<h4><span class="header-section-number">19.5.3.3</span> Only random slopes</h4>
<p>Finally, let’s compare a model that only allows for the slopes to differ but not the intercepts.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">fit.random_slope =<span class="st"> </span><span class="kw">lmer</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>days <span class="op">|</span><span class="st"> </span>subject),</a>
<a class="sourceLine" id="cb35-2" title="2">                        <span class="dt">data =</span> df.sleep)</a></code></pre></div>
<p>And let’s visualize the model fit:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">fit.random_slope <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb36-5" title="5">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days,</a>
<a class="sourceLine" id="cb36-6" title="6">                     <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> fitted),</a>
<a class="sourceLine" id="cb36-8" title="8">            <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb36-10" title="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(subject), <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb36-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb36-12" title="12">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb36-14" title="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb36-15" title="15">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<pre><code>## geom_path: Each group consists of only one observation. Do you need to adjust
## the group aesthetic?</code></pre>
<p><img src="psych252_files/figure-html/lmer3-29-1.png" width="672" /></p>
<p>Here, all the lines have the same starting point (i.e. the same intercept) but the slopes are different.</p>
</div>
</div>
<div id="compare-results" class="section level3">
<h3><span class="header-section-number">19.5.4</span> Compare results</h3>
<p>Let’s compare the results of the different methods – complete pooling, no pooling, and partial pooling (with random intercepts and slopes).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="co"># complete pooling</span></a>
<a class="sourceLine" id="cb38-2" title="2">fit.complete_pooling =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span>days,</a>
<a class="sourceLine" id="cb38-3" title="3">                          <span class="dt">data =</span> df.sleep)  </a>
<a class="sourceLine" id="cb38-4" title="4"></a>
<a class="sourceLine" id="cb38-5" title="5">df.complete_pooling =<span class="st">  </span>fit.complete_pooling <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-6" title="6"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-7" title="7"><span class="st">  </span><span class="kw">bind_rows</span>(fit.complete_pooling <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-8" title="8"><span class="st">              </span><span class="kw">augment</span>(<span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">subject =</span> <span class="kw">c</span>(<span class="st">&quot;373&quot;</span>, <span class="st">&quot;374&quot;</span>),</a>
<a class="sourceLine" id="cb38-9" title="9">                                       <span class="dt">days =</span> <span class="kw">rep</span>(<span class="dv">10</span>, <span class="dv">2</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-10" title="10"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-11" title="11"><span class="st">  </span><span class="kw">select</span>(reaction, days, <span class="dt">complete_pooling =</span> fitted)</a>
<a class="sourceLine" id="cb38-12" title="12"></a>
<a class="sourceLine" id="cb38-13" title="13"><span class="co"># no pooling</span></a>
<a class="sourceLine" id="cb38-14" title="14">df.no_pooling =<span class="st"> </span>df.sleep <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-15" title="15"><span class="st">  </span><span class="kw">group_by</span>(subject) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-16" title="16"><span class="st">  </span><span class="kw">nest</span>(<span class="dt">data =</span> <span class="kw">c</span>(days, reaction)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-17" title="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">lm</span>(reaction <span class="op">~</span><span class="st"> </span>days, <span class="dt">data =</span> .)),</a>
<a class="sourceLine" id="cb38-18" title="18">         <span class="dt">augment =</span> <span class="kw">map</span>(fit, augment)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-19" title="19"><span class="st">  </span><span class="kw">unnest</span>(<span class="kw">c</span>(augment)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-20" title="20"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-21" title="21"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-22" title="22"><span class="st">  </span><span class="kw">select</span>(subject, reaction, days, <span class="dt">no_pooling =</span> fitted)</a>
<a class="sourceLine" id="cb38-23" title="23"></a>
<a class="sourceLine" id="cb38-24" title="24"><span class="co"># partial pooling</span></a>
<a class="sourceLine" id="cb38-25" title="25">fit.lmer =<span class="st"> </span><span class="kw">lmer</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">|</span><span class="st"> </span>subject),</a>
<a class="sourceLine" id="cb38-26" title="26">                <span class="dt">data =</span> df.sleep) </a>
<a class="sourceLine" id="cb38-27" title="27"></a>
<a class="sourceLine" id="cb38-28" title="28">df.partial_pooling =<span class="st"> </span>fit.lmer <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-29" title="29"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-30" title="30"><span class="st">  </span><span class="kw">bind_rows</span>(fit.lmer <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-31" title="31"><span class="st">              </span><span class="kw">augment</span>(<span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">subject =</span> <span class="kw">c</span>(<span class="st">&quot;373&quot;</span>, <span class="st">&quot;374&quot;</span>),</a>
<a class="sourceLine" id="cb38-32" title="32">                                       <span class="dt">days =</span> <span class="kw">rep</span>(<span class="dv">10</span>, <span class="dv">2</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-33" title="33"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-34" title="34"><span class="st">  </span><span class="kw">select</span>(subject, reaction, days, <span class="dt">partial_pooling =</span> fitted)</a>
<a class="sourceLine" id="cb38-35" title="35"></a>
<a class="sourceLine" id="cb38-36" title="36"><span class="co"># combine results</span></a>
<a class="sourceLine" id="cb38-37" title="37">df.pooling =<span class="st"> </span>df.partial_pooling <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-38" title="38"><span class="st">  </span><span class="kw">left_join</span>(df.complete_pooling) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-39" title="39"><span class="st">  </span><span class="kw">left_join</span>(df.no_pooling)</a></code></pre></div>
<p>Let’s compare the predictions of the different models visually:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.pooling,</a>
<a class="sourceLine" id="cb39-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days,</a>
<a class="sourceLine" id="cb39-3" title="3">                     <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</a>
<a class="sourceLine" id="cb39-5" title="5">              <span class="dt">se =</span> F,</a>
<a class="sourceLine" id="cb39-6" title="6">              <span class="dt">color =</span> <span class="st">&quot;orange&quot;</span>,</a>
<a class="sourceLine" id="cb39-7" title="7">              <span class="dt">fullrange =</span> T) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> complete_pooling),</a>
<a class="sourceLine" id="cb39-9" title="9">            <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-10" title="10"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> partial_pooling),</a>
<a class="sourceLine" id="cb39-11" title="11">            <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-12" title="12"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb39-13" title="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>subject, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-14" title="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb39-15" title="15">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-16" title="16"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-17" title="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb39-18" title="18">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
<p><img src="psych252_files/figure-html/lmer3-31-1.png" width="672" /></p>
<p>To better see the differences between the approaches, let’s focus on the predictions for the participants with incomplete data:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># subselection</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.pooling <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="st">         </span><span class="kw">filter</span>(subject <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;373&quot;</span>, <span class="st">&quot;374&quot;</span>)),</a>
<a class="sourceLine" id="cb43-4" title="4">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days,</a>
<a class="sourceLine" id="cb43-5" title="5">                     <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</a>
<a class="sourceLine" id="cb43-7" title="7">              <span class="dt">se =</span> F,</a>
<a class="sourceLine" id="cb43-8" title="8">              <span class="dt">color =</span> <span class="st">&quot;orange&quot;</span>,</a>
<a class="sourceLine" id="cb43-9" title="9">              <span class="dt">fullrange =</span> T) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> complete_pooling),</a>
<a class="sourceLine" id="cb43-11" title="11">            <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-12" title="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> partial_pooling),</a>
<a class="sourceLine" id="cb43-13" title="13">            <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-14" title="14"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb43-15" title="15"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(subject)) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </a>
<a class="sourceLine" id="cb43-17" title="17">       <span class="dt">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-18" title="18"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb43-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb43-20" title="20">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 4 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_point).</code></pre>
<p><img src="psych252_files/figure-html/lmer3-32-1.png" width="672" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">df.plot =<span class="st"> </span><span class="kw">ggpredict</span>(<span class="dt">model =</span> fit.lmer,</a>
<a class="sourceLine" id="cb47-2" title="2">                    <span class="dt">terms =</span> <span class="st">&quot;days&quot;</span>)</a>
<a class="sourceLine" id="cb47-3" title="3"></a>
<a class="sourceLine" id="cb47-4" title="4">tmp =<span class="st"> </span>fit.lmer <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="st">  </span><span class="kw">tidy</span>(<span class="dt">effects =</span> <span class="kw">c</span>(<span class="st">&quot;ran_pars&quot;</span>, <span class="st">&quot;ran_vals&quot;</span>, <span class="st">&quot;fixed&quot;</span>))</a>
<a class="sourceLine" id="cb47-6" title="6"></a>
<a class="sourceLine" id="cb47-7" title="7"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.plot,</a>
<a class="sourceLine" id="cb47-8" title="8">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb47-9" title="9">                     <span class="dt">y =</span> predicted)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-10" title="10"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">ymin =</span> conf.low,</a>
<a class="sourceLine" id="cb47-11" title="11">                            <span class="dt">ymax =</span> conf.high),</a>
<a class="sourceLine" id="cb47-12" title="12">              <span class="dt">fill =</span> <span class="st">&quot;gray80&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-13" title="13"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-14" title="14"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> tmp<span class="op">$</span>estimate[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb47-15" title="15">              <span class="dt">slope =</span> tmp<span class="op">$</span>estimate[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb47-16" title="16">              <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-33-1.png" width="672" /></p>
</div>
<div id="coefficients" class="section level3">
<h3><span class="header-section-number">19.5.5</span> Coefficients</h3>
<p>One good way to get a sense for what the different models are doing is by taking a look at the coefficients:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">fit.complete_pooling <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="st">  </span><span class="kw">coef</span>()</a></code></pre></div>
<pre><code>## (Intercept)        days 
##   252.32070    10.32766</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">fit.random_intercept <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="st">  </span><span class="kw">coef</span>()</a></code></pre></div>
<pre><code>## $subject
##     (Intercept)     days
## 308    292.2749 10.43191
## 309    174.0559 10.43191
## 310    188.7454 10.43191
## 330    256.0247 10.43191
## 331    261.8141 10.43191
## 332    259.8262 10.43191
## 333    268.0765 10.43191
## 334    248.6471 10.43191
## 335    206.5096 10.43191
## 337    323.5643 10.43191
## 349    230.5114 10.43191
## 350    265.6957 10.43191
## 351    243.7988 10.43191
## 352    287.8850 10.43191
## 369    258.6454 10.43191
## 370    245.2931 10.43191
## 371    248.3508 10.43191
## 372    269.6861 10.43191
## 373    248.2086 10.43191
## 374    273.9400 10.43191
## 
## attr(,&quot;class&quot;)
## [1] &quot;coef.mer&quot;</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">fit.random_slope <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="st">  </span><span class="kw">coef</span>()</a></code></pre></div>
<pre><code>## $subject
##     (Intercept)       days
## 308    252.2965 19.9526801
## 309    252.2965 -4.3719650
## 310    252.2965 -0.9574726
## 330    252.2965  8.9909957
## 331    252.2965 10.5394285
## 332    252.2965 11.3994289
## 333    252.2965 12.6074020
## 334    252.2965 10.3413879
## 335    252.2965 -0.5722073
## 337    252.2965 24.2246485
## 349    252.2965  7.7702676
## 350    252.2965 15.0661415
## 351    252.2965  7.9675415
## 352    252.2965 17.0002999
## 369    252.2965 11.6982767
## 370    252.2965 11.3939807
## 371    252.2965  9.4535879
## 372    252.2965 13.4569059
## 373    252.2965 10.4142695
## 374    252.2965 11.9097917
## 
## attr(,&quot;class&quot;)
## [1] &quot;coef.mer&quot;</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">fit.random_intercept_slope <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="st">  </span><span class="kw">coef</span>()</a></code></pre></div>
<pre><code>## $subject
##     (Intercept)       days
## 308    253.9479 19.6264139
## 309    211.7328  1.7319567
## 310    213.1579  4.9061843
## 330    275.1425  5.6435987
## 331    273.7286  7.3862680
## 332    260.6504 10.1632535
## 333    268.3684 10.2245979
## 334    244.5523 11.4837825
## 335    251.3700 -0.3355554
## 337    286.2321 19.1090061
## 349    226.7662 11.5531963
## 350    238.7807 17.0156766
## 351    256.2344  7.4119501
## 352    272.3512 13.9920698
## 369    254.9484 11.2985741
## 370    226.3701 15.2027922
## 371    252.5051  9.4335432
## 372    263.8916 11.7253342
## 373    248.9752 10.3915245
## 374    271.1451 11.0782697
## 
## attr(,&quot;class&quot;)
## [1] &quot;coef.mer&quot;</code></pre>
</div>
<div id="shrinkage" class="section level3">
<h3><span class="header-section-number">19.5.6</span> Shrinkage</h3>
<p>In mixed effects models, the variance of parameter estimates across participants shrinks compared to a no pooling model (where we fit a different regression to each participant). Expressed differently, individual parameter estimates are borrowing strength from the overall data set in mixed effects models.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co"># get estimates from partial pooling model</span></a>
<a class="sourceLine" id="cb56-2" title="2">df.partial_pooling =<span class="st"> </span>fit.random_intercept_slope <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-3" title="3"><span class="st">  </span><span class="kw">coef</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="st">  </span>.[[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-5" title="5"><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="st">&quot;subject&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-6" title="6"><span class="st">  </span><span class="kw">clean_names</span>()</a>
<a class="sourceLine" id="cb56-7" title="7"></a>
<a class="sourceLine" id="cb56-8" title="8"><span class="co"># combine estimates from no pooling with partial pooling model </span></a>
<a class="sourceLine" id="cb56-9" title="9">df.plot =<span class="st"> </span>df.sleep <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-10" title="10"><span class="st">  </span><span class="kw">group_by</span>(subject) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-11" title="11"><span class="st">  </span><span class="kw">nest</span>(<span class="dt">data =</span> <span class="kw">c</span>(days, reaction)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-12" title="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(data, <span class="op">~</span><span class="st"> </span><span class="kw">lm</span>(reaction <span class="op">~</span><span class="st"> </span>days, <span class="dt">data =</span> .)),</a>
<a class="sourceLine" id="cb56-13" title="13">         <span class="dt">tidy =</span> <span class="kw">map</span>(fit, tidy)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-14" title="14"><span class="st">  </span><span class="kw">unnest</span>(<span class="kw">c</span>(tidy)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-15" title="15"><span class="st">  </span><span class="kw">select</span>(subject, term, estimate) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-16" title="16"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> term,</a>
<a class="sourceLine" id="cb56-17" title="17">              <span class="dt">values_from =</span> estimate) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-18" title="18"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-19" title="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">method =</span> <span class="st">&quot;no pooling&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-20" title="20"><span class="st">  </span><span class="kw">bind_rows</span>(df.partial_pooling <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-21" title="21"><span class="st">              </span><span class="kw">mutate</span>(<span class="dt">method =</span> <span class="st">&quot;partial pooling&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-22" title="22"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span><span class="kw">c</span>(subject, method),</a>
<a class="sourceLine" id="cb56-23" title="23">               <span class="dt">names_to =</span> <span class="st">&quot;index&quot;</span>, </a>
<a class="sourceLine" id="cb56-24" title="24">               <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-25" title="25"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">index =</span> <span class="kw">factor</span>(index, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;days&quot;</span>)))</a>
<a class="sourceLine" id="cb56-26" title="26"></a>
<a class="sourceLine" id="cb56-27" title="27"></a>
<a class="sourceLine" id="cb56-28" title="28"><span class="co"># visualize the results  </span></a>
<a class="sourceLine" id="cb56-29" title="29"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.plot,</a>
<a class="sourceLine" id="cb56-30" title="30">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> value,</a>
<a class="sourceLine" id="cb56-31" title="31">                     <span class="dt">group =</span> method,</a>
<a class="sourceLine" id="cb56-32" title="32">                     <span class="dt">fill =</span> method)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-33" title="33"><span class="st">  </span><span class="kw">stat_density</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>,</a>
<a class="sourceLine" id="cb56-34" title="34">               <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>,</a>
<a class="sourceLine" id="cb56-35" title="35">               <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb56-36" title="36">               <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-37" title="37"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="dt">cols =</span> <span class="kw">vars</span>(index),</a>
<a class="sourceLine" id="cb56-38" title="38">             <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing non-finite values (stat_density).</code></pre>
<p><img src="psych252_files/figure-html/lmer3-38-1.png" width="672" /></p>
</div>
<div id="plotting-marginal-effects" class="section level3">
<h3><span class="header-section-number">19.5.7</span> Plotting marginal effects</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># library(&quot;ggeffects&quot;)</span></a>
<a class="sourceLine" id="cb58-2" title="2"></a>
<a class="sourceLine" id="cb58-3" title="3"><span class="co"># using the plot() function</span></a>
<a class="sourceLine" id="cb58-4" title="4"><span class="kw">ggpredict</span>(<span class="dt">model =</span> fit.random_intercept_slope,</a>
<a class="sourceLine" id="cb58-5" title="5">          <span class="dt">terms =</span> <span class="st">&quot;days&quot;</span>,</a>
<a class="sourceLine" id="cb58-6" title="6">          <span class="dt">type =</span> <span class="st">&quot;fe&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-7" title="7"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-39-1.png" width="672" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co"># using our own ggplot magic</span></a>
<a class="sourceLine" id="cb59-2" title="2">df.plot =<span class="st"> </span><span class="kw">ggpredict</span>(<span class="dt">model =</span> fit.random_intercept_slope,</a>
<a class="sourceLine" id="cb59-3" title="3">                    <span class="dt">terms =</span> <span class="st">&quot;days&quot;</span>,</a>
<a class="sourceLine" id="cb59-4" title="4">                    <span class="dt">type =</span> <span class="st">&quot;fe&quot;</span>)</a>
<a class="sourceLine" id="cb59-5" title="5"></a>
<a class="sourceLine" id="cb59-6" title="6"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.plot,</a>
<a class="sourceLine" id="cb59-7" title="7">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb59-8" title="8">                     <span class="dt">y =</span> predicted,</a>
<a class="sourceLine" id="cb59-9" title="9">                     <span class="dt">ymin =</span> conf.low,</a>
<a class="sourceLine" id="cb59-10" title="10">                     <span class="dt">ymax =</span> conf.high)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-11" title="11"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-12" title="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-39-2.png" width="672" /></p>
</div>
</div>
<div id="bootstrapping" class="section level2">
<h2><span class="header-section-number">19.6</span> Bootstrapping</h2>
<p>Bootstrapping is a good way to estimate our uncertainty on the parameter estimates in the model.</p>
<div id="linear-model" class="section level3">
<h3><span class="header-section-number">19.6.1</span> Linear model</h3>
<p>Let’s briefly review how to do bootstrapping in a simple linear model.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co"># fit model </span></a>
<a class="sourceLine" id="cb60-2" title="2">fit.lm =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days,</a>
<a class="sourceLine" id="cb60-3" title="3">            <span class="dt">data =</span> df.sleep)</a>
<a class="sourceLine" id="cb60-4" title="4"></a>
<a class="sourceLine" id="cb60-5" title="5"><span class="co"># coefficients</span></a>
<a class="sourceLine" id="cb60-6" title="6">fit.lm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">coef</span>()</a></code></pre></div>
<pre><code>## (Intercept)        days 
##   252.32070    10.32766</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># bootstrapping </span></a>
<a class="sourceLine" id="cb62-2" title="2">df.boot =<span class="st"> </span>df.sleep <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-3" title="3"><span class="st">  </span><span class="kw">bootstrap</span>(<span class="dt">n =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb62-4" title="4">            <span class="dt">id =</span> <span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">map</span>(strap, <span class="op">~</span><span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days, <span class="dt">data =</span> .)),</a>
<a class="sourceLine" id="cb62-6" title="6">         <span class="dt">tidy =</span> <span class="kw">map</span>(fit, tidy)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-7" title="7"><span class="st">  </span><span class="kw">unnest</span>(tidy) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-8" title="8"><span class="st">  </span><span class="kw">select</span>(id, term, estimate) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-9" title="9"><span class="st">  </span><span class="kw">spread</span>(term, estimate) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-10" title="10"><span class="st">  </span><span class="kw">clean_names</span>() </a></code></pre></div>
<p>Let’s illustrate the linear model with a confidence interval (making parametric assumptions using the t-distribution).</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.sleep,</a>
<a class="sourceLine" id="cb63-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days, <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="psych252_files/figure-html/lmer3-41-1.png" width="672" /></p>
<p>And let’s compare this with the different regression lines that we get out of our bootstrapped samples:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> df.sleep,</a>
<a class="sourceLine" id="cb65-2" title="2">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> days, <span class="dt">y =</span> reaction)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-3" title="3"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">data =</span> df.boot,</a>
<a class="sourceLine" id="cb65-4" title="4">              <span class="kw">aes</span>(<span class="dt">intercept =</span> intercept,</a>
<a class="sourceLine" id="cb65-5" title="5">                  <span class="dt">slope =</span> days,</a>
<a class="sourceLine" id="cb65-6" title="6">                  <span class="dt">group =</span> id),</a>
<a class="sourceLine" id="cb65-7" title="7">              <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb65-8" title="8"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-42-1.png" width="672" /></p>
<div id="bootmer-function" class="section level4">
<h4><span class="header-section-number">19.6.1.1</span> bootmer() function</h4>
<p>For the linear mixed effects model, we can use the <code>bootmer()</code> function to do bootstrapping.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb66-2" title="2"></a>
<a class="sourceLine" id="cb66-3" title="3"><span class="co"># fit the model </span></a>
<a class="sourceLine" id="cb66-4" title="4">fit.lmer =<span class="st"> </span><span class="kw">lmer</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">|</span><span class="st"> </span>subject),</a>
<a class="sourceLine" id="cb66-5" title="5">                <span class="dt">data =</span> df.sleep)</a>
<a class="sourceLine" id="cb66-6" title="6"></a>
<a class="sourceLine" id="cb66-7" title="7"><span class="co"># bootstrap parameter estimates </span></a>
<a class="sourceLine" id="cb66-8" title="8">boot.lmer =<span class="st"> </span><span class="kw">bootMer</span>(fit.lmer,</a>
<a class="sourceLine" id="cb66-9" title="9">                    <span class="dt">FUN =</span> fixef,</a>
<a class="sourceLine" id="cb66-10" title="10">                    <span class="dt">nsim =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb66-11" title="11"></a>
<a class="sourceLine" id="cb66-12" title="12"><span class="co"># compute confidence interval </span></a>
<a class="sourceLine" id="cb66-13" title="13"><span class="kw">boot.ci</span>(boot.lmer, <span class="dt">index =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&quot;perc&quot;</span>)</a></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 100 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.lmer, type = &quot;perc&quot;, index = 2)
## 
## Intervals : 
## Level     Percentile     
## 95%   ( 7.26, 13.79 )  
## Calculations and Intervals on Original Scale
## Some percentile intervals may be unstable</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="co"># plot estimates </span></a>
<a class="sourceLine" id="cb68-2" title="2">boot.lmer<span class="op">$</span>t <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-4" title="4"><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-6" title="6"><span class="st">  </span><span class="kw">gather</span>(<span class="st">&quot;index&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="op">-</span><span class="st"> </span>id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> .,</a>
<a class="sourceLine" id="cb68-8" title="8">       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-9" title="9"><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-10" title="10"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="dt">cols =</span> <span class="kw">vars</span>(index),</a>
<a class="sourceLine" id="cb68-11" title="11">             <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb68-12" title="12"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> F)</a></code></pre></div>
<p><img src="psych252_files/figure-html/lmer3-43-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="getting-p-values" class="section level2">
<h2><span class="header-section-number">19.7</span> Getting p-values</h2>
<p>We can use the “lmerTest” package to get p-values for the different fixed effects.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">lmerTest<span class="op">::</span><span class="kw">lmer</span>(<span class="dt">formula =</span> reaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>days <span class="op">|</span><span class="st"> </span>subject),</a>
<a class="sourceLine" id="cb69-2" title="2">                <span class="dt">data =</span> df.sleep) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb69-3" title="3"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: reaction ~ 1 + days + (1 + days | subject)
##    Data: df.sleep
## 
## REML criterion at convergence: 1771.4
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.9707 -0.4703  0.0276  0.4594  5.2009 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  subject  (Intercept) 582.73   24.140       
##           days         35.03    5.919   0.07
##  Residual             649.36   25.483       
## Number of obs: 183, groups:  subject, 20
## 
## Fixed effects:
##             Estimate Std. Error      df t value Pr(&gt;|t|)    
## (Intercept)  252.543      6.433  19.294  39.256  &lt; 2e-16 ***
## days          10.452      1.542  17.163   6.778 3.06e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##      (Intr)
## days -0.137</code></pre>
</div>
<div id="understanding-the-lmer-syntax" class="section level2">
<h2><span class="header-section-number">19.8</span> Understanding the lmer() syntax</h2>
<p>Here is an overview of how to specify different kinds of linear mixed effects models.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
formula
</th>
<th style="text-align:left;">
description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>dv ~ x1 + (1 | g)</code>
</td>
<td style="text-align:left;">
Random intercept for each level of <code>g</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>dv ~ x1 + (0 + x1 | g)</code>
</td>
<td style="text-align:left;">
Random slope for each level of <code>g</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>dv ~ x1 + (x1 | g)</code>
</td>
<td style="text-align:left;">
Correlated random slope and intercept for each level of <code>g</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>dv ~ x1 + (x1 || g)</code>
</td>
<td style="text-align:left;">
Uncorrelated random slope and intercept for each level of <code>g</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>dv ~ x1 + (1 | school) + (1 | teacher)</code>
</td>
<td style="text-align:left;">
Random intercept for each level of <code>school</code> and for each level of <code>teacher</code> (crossed)
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>dv ~ x1 + (1 | school/teacher)</code>
</td>
<td style="text-align:left;">
Random intercept for each level of <code>school</code> and for each level of <code>teacher</code> in <code>school</code> (nested)
</td>
</tr>
</tbody>
</table>
</div>
<div id="session-info-17" class="section level2">
<h2><span class="header-section-number">19.9</span> Session info</h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Mojave 10.14.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] forcats_0.5.0     stringr_1.4.0     dplyr_0.8.4       purrr_0.3.3      
##  [5] readr_1.3.1       tidyr_1.0.2       tibble_2.1.3      ggplot2_3.3.0    
##  [9] tidyverse_1.3.0   ggeffects_0.14.1  boot_1.3-24       modelr_0.1.6     
## [13] lme4_1.1-21       Matrix_1.2-18     patchwork_1.0.0   broom.mixed_0.2.4
## [17] broom_0.5.5       janitor_1.2.1     kableExtra_1.1.0  knitr_1.28       
## 
## loaded via a namespace (and not attached):
##  [1] httr_1.4.1          jsonlite_1.6.1      viridisLite_0.3.0  
##  [4] splines_3.6.2       assertthat_0.2.1    highr_0.8          
##  [7] cellranger_1.1.0    yaml_2.2.1          numDeriv_2016.8-1.1
## [10] pillar_1.4.3        backports_1.1.5     lattice_0.20-40    
## [13] glue_1.3.1          digest_0.6.25       rvest_0.3.5        
## [16] snakecase_0.11.0    minqa_1.2.4         colorspace_1.4-1   
## [19] htmltools_0.4.0     plyr_1.8.6          pkgconfig_2.0.3    
## [22] haven_2.2.0         bookdown_0.18       scales_1.1.0       
## [25] webshot_0.5.2       mgcv_1.8-31         generics_0.0.2     
## [28] farver_2.0.3        ellipsis_0.3.0      sjlabelled_1.1.3   
## [31] withr_2.1.2         TMB_1.7.16          cli_2.0.2          
## [34] magrittr_1.5        crayon_1.3.4        readxl_1.3.1       
## [37] evaluate_0.14       fs_1.3.2            fansi_0.4.1        
## [40] nlme_3.1-145        MASS_7.3-51.5       xml2_1.2.2         
## [43] tools_3.6.2         hms_0.5.3           lifecycle_0.1.0    
## [46] munsell_0.5.0       reprex_0.3.0        compiler_3.6.2     
## [49] rlang_0.4.5         grid_3.6.2          nloptr_1.2.1       
## [52] rstudioapi_0.11     labeling_0.3        rmarkdown_2.1      
## [55] lmerTest_3.1-1      gtable_0.3.0        DBI_1.1.0          
## [58] reshape2_1.4.3      R6_2.4.1            lubridate_1.7.4    
## [61] insight_0.8.1       stringi_1.4.6       Rcpp_1.0.3         
## [64] vctrs_0.2.3         dbplyr_1.4.2        tidyselect_1.0.0   
## [67] xfun_0.12           coda_0.19-3</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-mixed-effects-models-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalized-linear-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/19-linear_mixed_effects_models3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"search": false
});
});
</script>

</body>

</html>
