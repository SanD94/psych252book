[
["probability-and-causality.html", "Chapter 6 Probability and causality 6.1 Learning objectives 6.2 Load packages 6.3 Counting 6.4 Flipping a coin many times 6.5 Clue guide to probability 6.6 Probability operations 6.7 Bayesian reasoning example 6.8 Bayesian networks 6.9 Additional resources", " Chapter 6 Probability and causality 6.1 Learning objectives Refresh our understanding of probability theory. Conditional probability. Independence. Joint probability. Law of Total Probability. Bayes’ rule. Appreciate different interpretations of probability. Basic understanding of Bayesian networks and common patterns of inference. Causal Bayesian networks: Difference between observation and intervention. 6.2 Load packages Let’s first load the packages that we need for this chapter (just use install.packages() to install any packages you don’t have yet). library(&quot;knitr&quot;) # for rendering the RMarkdown file library(&quot;kableExtra&quot;) # for nicely formatted tables library(&quot;arrangements&quot;) # fast generators and iterators for permutations, combinations and partitions library(&quot;DiagrammeR&quot;) # for drawing diagrams library(&quot;tidyverse&quot;) # for data wrangling opts_chunk$set( comment = &quot;&quot;, results = &quot;hold&quot;, fig.show = &quot;hold&quot; ) 6.3 Counting Imagine that there are three balls in an urn. The balls are labeled 1, 2, and 3. Let’s consider a few possible situations. balls = 1:3 # number of balls in urn ndraws = 2 # number of draws # order matters, without replacement permutations(balls, ndraws) # order matters, with replacement permutations(balls, ndraws, replace = T) # order doesn&#39;t matter, with replacement combinations(balls, ndraws, replace = T) # order doesn&#39;t matter, without replacement combinations(balls, ndraws) [,1] [,2] [1,] 1 2 [2,] 1 3 [3,] 2 1 [4,] 2 3 [5,] 3 1 [6,] 3 2 [,1] [,2] [1,] 1 1 [2,] 1 2 [3,] 1 3 [4,] 2 1 [5,] 2 2 [6,] 2 3 [7,] 3 1 [8,] 3 2 [9,] 3 3 [,1] [,2] [1,] 1 1 [2,] 1 2 [3,] 1 3 [4,] 2 2 [5,] 2 3 [6,] 3 3 [,1] [,2] [1,] 1 2 [2,] 1 3 [3,] 2 3 I’ve generated the figures below using the DiagrammeR package. It’s a powerful package for drawing diagrams in R. See information on how to use the DiagrammeR package here. Figure 6.1: Drawing two marbles out of an urn with replacement. Figure 6.2: Drawing two marbles out of an urn without replacement. 6.4 Flipping a coin many times # Example taken from here: http://statsthinking21.org/probability.html#empirical-frequency set.seed(1) # set the seed so that the outcome is consistent nsamples = 50000 # how many flips do we want to make? # create some random coin flips using the rbinom() function with # a true probability of 0.5 df.samples = tibble( trial_number = seq(nsamples), outcomes = rbinom(nsamples, 1, 0.5)) %&gt;% mutate(mean_probability = cumsum(outcomes) / seq_along(outcomes)) %&gt;% filter(trial_number &gt;= 10) # start with a minimum sample of 10 flips ggplot(data = df.samples, mapping = aes(x = trial_number, y = mean_probability)) + geom_hline(yintercept = 0.5, color = &quot;gray&quot;, linetype = &quot;dashed&quot;) + geom_line() + labs( x = &quot;Number of trials&quot;, y = &quot;Estimated probability of heads&quot; )+ theme_classic()+ theme(text = element_text(size = 20)) Figure 6.3: A demonstration of the law of large numbers. 6.5 Clue guide to probability who = c(&quot;ms_scarlet&quot;, &quot;col_mustard&quot;, &quot;mrs_white&quot;, &quot;mr_green&quot;, &quot;mrs_peacock&quot;, &quot;prof_plum&quot;) what = c(&quot;candlestick&quot;, &quot;knife&quot;, &quot;lead_pipe&quot;, &quot;revolver&quot;, &quot;rope&quot;, &quot;wrench&quot;) where = c(&quot;study&quot;, &quot;kitchen&quot;, &quot;conservatory&quot;, &quot;lounge&quot;, &quot;billiard_room&quot;, &quot;hall&quot;, &quot;dining_room&quot;, &quot;ballroom&quot;, &quot;library&quot;) df.clue = expand.grid(who = who, what = what, where = where) %&gt;% as_tibble() df.suspects = df.clue %&gt;% distinct(who) %&gt;% mutate(gender = ifelse( test = who %in% c(&quot;ms_scarlet&quot;, &quot;mrs_white&quot;, &quot;mrs_peacock&quot;), yes = &quot;female&quot;, no = &quot;male&quot;) ) df.suspects %&gt;% arrange(desc(gender)) %&gt;% kable() %&gt;% kable_styling(&quot;striped&quot;, full_width = F) who gender col_mustard male mr_green male prof_plum male ms_scarlet female mrs_white female mrs_peacock female 6.5.1 Conditional probability # conditional probability (via rules of probability) df.suspects %&gt;% summarize(p_prof_plum_given_male = sum(gender == &quot;male&quot; &amp; who == &quot;prof_plum&quot;) / sum(gender == &quot;male&quot;)) # A tibble: 1 x 1 p_prof_plum_given_male &lt;dbl&gt; 1 0.333 # conditional probability (via rejection) df.suspects %&gt;% filter(gender == &quot;male&quot;) %&gt;% summarize(p_prof_plum_given_male = sum(who == &quot;prof_plum&quot;) / n()) # A tibble: 1 x 1 p_prof_plum_given_male &lt;dbl&gt; 1 0.333 6.5.2 Law of total probability 6.6 Probability operations # Make a deck of cards df.cards = tibble( suit = rep(c(&quot;Clubs&quot;, &quot;Spades&quot;, &quot;Hearts&quot;, &quot;Diamonds&quot;), each = 8), value = rep(c(&quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;Jack&quot;, &quot;Queen&quot;, &quot;King&quot;, &quot;Ace&quot;), 4) ) # conditional probability: p(Hearts | Queen) (via rules of probability) df.cards %&gt;% summarize(p_hearts_given_queen = sum(suit == &quot;Hearts&quot; &amp; value == &quot;Queen&quot;) / sum(value == &quot;Queen&quot;)) # A tibble: 1 x 1 p_hearts_given_queen &lt;dbl&gt; 1 0.25 # conditional probability: p(Hearts | Queen) (via rejection) df.cards %&gt;% filter(value == &quot;Queen&quot;) %&gt;% summarize(p_hearts_given_queen = sum(suit == &quot;Hearts&quot;)/n()) # A tibble: 1 x 1 p_hearts_given_queen &lt;dbl&gt; 1 0.25 6.7 Bayesian reasoning example 6.8 Bayesian networks 6.8.1 Sprinkler example # cloudy df.cloudy = tibble( `p(C)` = 0.5 ) df.cloudy %&gt;% kable() %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F, font_size = 20) # sprinkler given cloudy df.sprinkler_given_cloudy = tibble( C = c(&quot;F&quot;, &quot;T&quot;), `p(S)`= c(0.5, 0.1) ) df.sprinkler_given_cloudy %&gt;% kable() %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F, font_size = 20) # rain given cloudy df.rain_given_cloudy = tibble( C = c(&quot;F&quot;, &quot;T&quot;), `p(R)`= c(0.2, 0.8) ) df.rain_given_cloudy %&gt;% kable() %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F, font_size = 20) # wet given sprinkler and rain df.rain_given_sprinkler_and_rain = tibble( S = rep(c(&quot;F&quot;, &quot;T&quot;), 2), R = rep(c(&quot;F&quot;, &quot;T&quot;), each = 2), `p(W)`= c(0, 0.9, 0.9, 0.99) ) df.rain_given_sprinkler_and_rain %&gt;% kable() %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F, font_size = 20) p(C) 0.5 C p(S) F 0.5 T 0.1 C p(R) F 0.2 T 0.8 S R p(W) F F 0.00 T F 0.90 F T 0.90 T T 0.99 6.9 Additional resources 6.9.1 Cheatsheets Probability cheatsheet 6.9.2 Books and chapters Probability and Statistics with examples using R Learning statistics with R: Chapter 9 Introduction to probability 6.9.3 Misc Statistics 110: Probability; course at Harvard "]
]
