<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Mediation &amp; Moderation | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Mediation &amp; Moderation | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Mediation &amp; Moderation | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2020-03-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="power-analysis.html"/>
<link rel="next" href="model-comparison.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.5/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a><ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="visualization-1.html"><a href="visualization-1.html#how-not-to-visualize-data"><i class="fa fa-check"></i><b>2.3.1</b> How <em>not</em> to visualize data</a></li>
<li class="chapter" data-level="2.3.2" data-path="visualization-1.html"><a href="visualization-1.html#how-to-make-it-better"><i class="fa fa-check"></i><b>2.3.2</b> How to make it better</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.5</b> Getting help</a></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization-using-ggplot2"><i class="fa fa-check"></i><b>2.6</b> Data visualization using <code>ggplot2</code></a><ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.6.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.6.2</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.6.3</b> Scatter plot</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.6.4</b> Line plot</a></li>
<li class="chapter" data-level="2.6.5" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.6.5</b> Adding error bars</a></li>
<li class="chapter" data-level="2.6.6" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.6.6</b> Grouping data</a></li>
<li class="chapter" data-level="2.6.7" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.6.7</b> Making facets</a></li>
<li class="chapter" data-level="2.6.8" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.6.8</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.7</b> Additional resources</a><ul>
<li class="chapter" data-level="2.7.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.7.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.7.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.7.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.7.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.7.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a><ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a><ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a><ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a><ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a><ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-2"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#install-packages"><i class="fa fa-check"></i><b>4.2</b> Install packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.3</b> Load packages</a></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.4</b> Some R basics</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.4.1</b> Modes</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.4.2</b> Data types</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.4.3</b> Operators</a></li>
<li class="chapter" data-level="4.4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.4.4</b> Control flow</a></li>
<li class="chapter" data-level="4.4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.4.5</b> Functions</a></li>
<li class="chapter" data-level="4.4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.4.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a><ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
<li class="chapter" data-level="4.5.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.5.7</b> A quick note on naming things</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a><ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.4</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.5</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.7</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a><ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="4.7.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#misc-2"><i class="fa fa-check"></i><b>4.7.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a><ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-3"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.3</b> Wrangling data (continued)</a><ul>
<li class="chapter" data-level="5.3.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.3.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.3.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.3.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.3.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.3.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.4</b> Reading in data</a><ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.4.1</b> csv</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.4.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.5</b> Saving data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.6</b> Additional resources</a><ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.6.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.6.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.6.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.6.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a><ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#learning-goals-4"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#install-and-load-packages-load-data-set-theme-1"><i class="fa fa-check"></i><b>6.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.3</b> Counting</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.5</b> The random secretary</a></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.6</b> Clue guide to probability</a><ul>
<li class="chapter" data-level="6.6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.6.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.6.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.7</b> Probability operations</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.8</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-networks"><i class="fa fa-check"></i><b>6.9</b> Bayesian networks</a><ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#sprinkler-example"><i class="fa fa-check"></i><b>6.9.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a><ul>
<li class="chapter" data-level="6.10.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.10.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.10.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-3"><i class="fa fa-check"></i><b>6.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a><ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#learning-goals-5"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.3</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.5</b> Computing probabilities</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a><ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#working-with-samples"><i class="fa fa-check"></i><b>7.5</b> Working with samples</a><ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.5.1</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="simulation-1.html"><a href="simulation-1.html#the-quantile-function"><i class="fa fa-check"></i><b>7.5.2</b> The <code>quantile()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#comparing-probability-distributions"><i class="fa fa-check"></i><b>7.6</b> Comparing probability distributions</a></li>
<li class="chapter" data-level="7.7" data-path="simulation-1.html"><a href="simulation-1.html#relationship-between-probability-and-likelihood"><i class="fa fa-check"></i><b>7.7</b> Relationship between probability and likelihood</a></li>
<li class="chapter" data-level="7.8" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.8</b> Additional resources</a><ul>
<li class="chapter" data-level="7.8.1" data-path="simulation-1.html"><a href="simulation-1.html#cheatsheets-5"><i class="fa fa-check"></i><b>7.8.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="7.8.2" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.8.2</b> Datacamp</a></li>
<li class="chapter" data-level="7.8.3" data-path="simulation-1.html"><a href="simulation-1.html#tutorials-1"><i class="fa fa-check"></i><b>7.8.3</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a><ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#learning-goals-6"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>8.3</b> The central limit theorem</a><ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.3.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.3.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.3.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.3.3</b> The sampling distribution</a></li>
<li class="chapter" data-level="8.3.4" data-path="simulation-2.html"><a href="simulation-2.html#exploring-the-clt"><i class="fa fa-check"></i><b>8.3.4</b> Exploring the CLT</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.4</b> Understanding p-values</a><ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.4.1</b> Permutation test</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.5</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.6</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a><ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#learning-goals-7"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.3</b> Modeling data</a><ul>
<li class="chapter" data-level="9.3.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.3.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.3.2" data-path="modeling-data.html"><a href="modeling-data.html#error-definitions-and-best-estimators"><i class="fa fa-check"></i><b>9.3.2</b> Error definitions and best estimators</a></li>
<li class="chapter" data-level="9.3.3" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.3.3</b> Sampling distributions for median and mean</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.4</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.5</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6</b> Additional resources</a><ul>
<li class="chapter" data-level="9.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.6.1</b> Reading</a></li>
<li class="chapter" data-level="9.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-1"><i class="fa fa-check"></i><b>9.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-7"><i class="fa fa-check"></i><b>9.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a><ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#learning-goals-8"><i class="fa fa-check"></i><b>10.1</b> Learning goals</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.3</b> Correlation</a></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.4</b> Regression</a><ul>
<li class="chapter" data-level="10.4.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.4.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.4.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.4.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.5</b> Credit example</a></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.6</b> Additional resources</a><ul>
<li class="chapter" data-level="10.6.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-2"><i class="fa fa-check"></i><b>10.6.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.6.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-4"><i class="fa fa-check"></i><b>10.6.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-8"><i class="fa fa-check"></i><b>10.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a><ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-9"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a><ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a><ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a><ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a><ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a><ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-3"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-5"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-9"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a><ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-10"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a><ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
<li class="chapter" data-level="12.5.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.5.5</b> Two-way ANOVA (with interaction)</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>12.6</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.7</b> Additional resources</a><ul>
<li class="chapter" data-level="12.7.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-4"><i class="fa fa-check"></i><b>12.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.7.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-6"><i class="fa fa-check"></i><b>12.7.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-10"><i class="fa fa-check"></i><b>12.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a><ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#learning-goals-11"><i class="fa fa-check"></i><b>13.1</b> Learning goals</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.3</b> Load data sets</a></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#planned-contrasts"><i class="fa fa-check"></i><b>13.4</b> Planned contrasts</a><ul>
<li class="chapter" data-level="13.4.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.4.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.4.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.4.2</b> Visualization</a></li>
<li class="chapter" data-level="13.4.3" data-path="linear-model-4.html"><a href="linear-model-4.html#constrasts"><i class="fa fa-check"></i><b>13.4.3</b> Constrasts</a></li>
<li class="chapter" data-level="13.4.4" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.4.4</b> Post-hoc tests</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-11"><i class="fa fa-check"></i><b>13.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a><ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-12"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a><ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#eta-squared-and-partial-eta-squared"><i class="fa fa-check"></i><b>14.5.1</b> eta-squared and partial eta-squared</a></li>
<li class="chapter" data-level="14.5.2" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.2</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a><ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-via-simulation"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis via simulation</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-11"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a><ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-5"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-6"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-7"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-12"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mediation-moderation.html"><a href="mediation-moderation.html"><i class="fa fa-check"></i><b>15</b> Mediation &amp; Moderation</a><ul>
<li class="chapter" data-level="15.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#learning-goals-13"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#recommended-reading"><i class="fa fa-check"></i><b>15.2</b> Recommended reading</a></li>
<li class="chapter" data-level="15.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#controlling-for-variables"><i class="fa fa-check"></i><b>15.4</b> Controlling for variables</a><ul>
<li class="chapter" data-level="15.4.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>15.4.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="15.4.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#good-controls"><i class="fa fa-check"></i><b>15.4.2</b> Good controls</a></li>
<li class="chapter" data-level="15.4.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#bad-controls"><i class="fa fa-check"></i><b>15.4.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mediation-moderation.html"><a href="mediation-moderation.html#mediation"><i class="fa fa-check"></i><b>15.5</b> Mediation</a><ul>
<li class="chapter" data-level="15.5.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data"><i class="fa fa-check"></i><b>15.5.1</b> Generate data</a></li>
<li class="chapter" data-level="15.5.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>15.5.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="15.5.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>15.5.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="15.5.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>15.5.4</b> Method 3: Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation"><i class="fa fa-check"></i><b>15.6</b> Moderation</a><ul>
<li class="chapter" data-level="15.6.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data-1"><i class="fa fa-check"></i><b>15.6.1</b> Generate data</a></li>
<li class="chapter" data-level="15.6.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation-analysis"><i class="fa fa-check"></i><b>15.6.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="mediation-moderation.html"><a href="mediation-moderation.html#additional-resources-12"><i class="fa fa-check"></i><b>15.7</b> Additional resources</a><ul>
<li class="chapter" data-level="15.7.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#books"><i class="fa fa-check"></i><b>15.7.1</b> Books</a></li>
<li class="chapter" data-level="15.7.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#tutorials-2"><i class="fa fa-check"></i><b>15.7.2</b> Tutorials</a></li>
<li class="chapter" data-level="15.7.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#misc-8"><i class="fa fa-check"></i><b>15.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="mediation-moderation.html"><a href="mediation-moderation.html#session-info-13"><i class="fa fa-check"></i><b>15.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>16</b> Model comparison</a><ul>
<li class="chapter" data-level="16.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-14"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="model-comparison.html"><a href="model-comparison.html#determining-sample-size-1"><i class="fa fa-check"></i><b>16.3</b> Determining sample size</a><ul>
<li class="chapter" data-level="16.3.1" data-path="model-comparison.html"><a href="model-comparison.html#pwr-package-1"><i class="fa fa-check"></i><b>16.3.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="16.3.2" data-path="model-comparison.html"><a href="model-comparison.html#map"><i class="fa fa-check"></i><b>16.3.2</b> <code>map()</code></a></li>
<li class="chapter" data-level="16.3.3" data-path="model-comparison.html"><a href="model-comparison.html#via-simulation"><i class="fa fa-check"></i><b>16.3.3</b> via simulation</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>16.4</b> Model comparison</a><ul>
<li class="chapter" data-level="16.4.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>16.4.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="16.4.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>16.4.2</b> F-test</a></li>
<li class="chapter" data-level="16.4.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>16.4.3</b> Cross-validation</a></li>
<li class="chapter" data-level="16.4.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>16.4.4</b> Bootstrap</a></li>
<li class="chapter" data-level="16.4.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>16.4.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>16.5</b> Additional resources</a><ul>
<li class="chapter" data-level="16.5.1" data-path="model-comparison.html"><a href="model-comparison.html#cheatsheet"><i class="fa fa-check"></i><b>16.5.1</b> Cheatsheet</a></li>
<li class="chapter" data-level="16.5.2" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>16.5.2</b> Datacamp course</a></li>
<li class="chapter" data-level="16.5.3" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>16.5.3</b> Reading</a></li>
<li class="chapter" data-level="16.5.4" data-path="model-comparison.html"><a href="model-comparison.html#misc-9"><i class="fa fa-check"></i><b>16.5.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="model-comparison.html"><a href="model-comparison.html#session-info-14"><i class="fa fa-check"></i><b>16.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a><ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-15"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#things-that-came-up-in-class"><i class="fa fa-check"></i><b>17.3</b> Things that came up in class</a><ul>
<li class="chapter" data-level="17.3.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#comparing-t-test-with-f-test-in-lm"><i class="fa fa-check"></i><b>17.3.1</b> Comparing t-test with F-test in <code>lm()</code></a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.4</b> Dependence</a></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.5</b> Additional resources</a><ul>
<li class="chapter" data-level="17.5.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.5.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-15"><i class="fa fa-check"></i><b>17.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a><ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-16"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#things-that-came-up-in-class-1"><i class="fa fa-check"></i><b>18.3</b> Things that came up in class</a><ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#difference-between-replicate-and-map"><i class="fa fa-check"></i><b>18.3.1</b> Difference between <code>replicate()</code> and <code>map()</code></a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>18.4</b> Simulating a linear mixed effects model</a></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.5</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.6</b> Different slopes</a></li>
<li class="chapter" data-level="18.7" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.7</b> Simpson’s paradox</a></li>
<li class="chapter" data-level="18.8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.8</b> Additional resources</a><ul>
<li class="chapter" data-level="18.8.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.8.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.9" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-16"><i class="fa fa-check"></i><b>18.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a><ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-17"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-set"><i class="fa fa-check"></i><b>19.3</b> Load data set</a></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#things-that-came-up-in-class-2"><i class="fa fa-check"></i><b>19.4</b> Things that came up in class</a><ul>
<li class="chapter" data-level="19.4.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#one-tailed-vs.-two-tailed-tests"><i class="fa fa-check"></i><b>19.4.1</b> One-tailed vs. two-tailed tests</a></li>
<li class="chapter" data-level="19.4.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixtures-of-participants"><i class="fa fa-check"></i><b>19.4.2</b> Mixtures of participants</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#pooling-and-shrinkage"><i class="fa fa-check"></i><b>19.5</b> Pooling and shrinkage</a><ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#complete-pooling"><i class="fa fa-check"></i><b>19.5.1</b> Complete pooling</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#no-pooling"><i class="fa fa-check"></i><b>19.5.2</b> No pooling</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#partial-pooling"><i class="fa fa-check"></i><b>19.5.3</b> Partial pooling</a></li>
<li class="chapter" data-level="19.5.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#compare-results"><i class="fa fa-check"></i><b>19.5.4</b> Compare results</a></li>
<li class="chapter" data-level="19.5.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#coefficients"><i class="fa fa-check"></i><b>19.5.5</b> Coefficients</a></li>
<li class="chapter" data-level="19.5.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#shrinkage"><i class="fa fa-check"></i><b>19.5.6</b> Shrinkage</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#bootstrapping"><i class="fa fa-check"></i><b>19.6</b> Bootstrapping</a><ul>
<li class="chapter" data-level="19.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#linear-model"><i class="fa fa-check"></i><b>19.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#getting-p-values"><i class="fa fa-check"></i><b>19.7</b> Getting p-values</a></li>
<li class="chapter" data-level="19.8" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.8</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-17"><i class="fa fa-check"></i><b>19.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>20</b> Generalized linear model</a><ul>
<li class="chapter" data-level="20.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-18"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set-1"><i class="fa fa-check"></i><b>20.3</b> Load data set</a></li>
<li class="chapter" data-level="20.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>20.4</b> Logistic regression</a><ul>
<li class="chapter" data-level="20.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>20.4.1</b> Interpreting the parameters</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>20.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="20.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>20.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="20.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>20.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="20.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>20.8</b> Additional information</a><ul>
<li class="chapter" data-level="20.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-6"><i class="fa fa-check"></i><b>20.8.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-18"><i class="fa fa-check"></i><b>20.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html"><i class="fa fa-check"></i><b>21</b> Bayesian data analysis 1</a><ul>
<li class="chapter" data-level="21.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#learning-goals-19"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#things-that-came-up"><i class="fa fa-check"></i><b>21.3</b> Things that came up</a><ul>
<li class="chapter" data-level="21.3.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bias-in-cosyne-2019-conference-admission"><i class="fa fa-check"></i><b>21.3.1</b> Bias in Cosyne 2019 conference admission?</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#session-info-19"><i class="fa fa-check"></i><b>21.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 2</a><ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-20"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>22.3</b> Doing Bayesian inference “by hand”</a><ul>
<li class="chapter" data-level="22.3.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#coin-flip-example"><i class="fa fa-check"></i><b>22.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="22.3.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>22.3.3</b> Bayesian inference by discretization</a></li>
<li class="chapter" data-level="22.3.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-prior"><i class="fa fa-check"></i><b>22.3.4</b> Effect of the prior</a></li>
<li class="chapter" data-level="22.3.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-likelihood"><i class="fa fa-check"></i><b>22.3.5</b> Effect of the likelihood</a></li>
<li class="chapter" data-level="22.3.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#effect-of-the-sample-size"><i class="fa fa-check"></i><b>22.3.6</b> Effect of the sample size</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#distributions"><i class="fa fa-check"></i><b>22.4</b> Distributions</a><ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#normal-vs-student-t-distribution"><i class="fa fa-check"></i><b>22.4.1</b> Normal vs Student-t distribution</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#beta-distributions"><i class="fa fa-check"></i><b>22.4.2</b> Beta distributions</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#normal-distributions"><i class="fa fa-check"></i><b>22.4.3</b> Normal distributions</a></li>
<li class="chapter" data-level="22.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#distributions-for-non-negative-parameters"><i class="fa fa-check"></i><b>22.4.4</b> Distributions for non-negative parameters</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#inference-via-sampling"><i class="fa fa-check"></i><b>22.5</b> Inference via sampling</a></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#greta"><i class="fa fa-check"></i><b>22.6</b> Greta</a><ul>
<li class="chapter" data-level="22.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#attitude-data-set"><i class="fa fa-check"></i><b>22.6.1</b> Attitude data set</a></li>
<li class="chapter" data-level="22.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#frequentist-analysis"><i class="fa fa-check"></i><b>22.6.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="22.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#bayesian-regression"><i class="fa fa-check"></i><b>22.6.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-20"><i class="fa fa-check"></i><b>22.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 3</a><ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-21"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-data-set-2"><i class="fa fa-check"></i><b>23.3</b> Load data set</a></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#poker"><i class="fa fa-check"></i><b>23.4</b> Poker</a><ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualization-7"><i class="fa fa-check"></i><b>23.4.1</b> Visualization</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#linear-model-5"><i class="fa fa-check"></i><b>23.4.2</b> Linear model</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-model"><i class="fa fa-check"></i><b>23.4.3</b> Bayesian model</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>23.5</b> Dealing with heteroscedasticity</a></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>23.6</b> Ordinal regression</a></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-16"><i class="fa fa-check"></i><b>23.7</b> Additional resources</a></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-21"><i class="fa fa-check"></i><b>23.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>24</b> Reporting statistics</a><ul>
<li class="chapter" data-level="24.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>24.1</b> General advice</a><ul>
<li class="chapter" data-level="24.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>24.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="24.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>24.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="24.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>24.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="24.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>24.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="24.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>24.1.5</b> Frequentist statistics</a></li>
<li class="chapter" data-level="24.1.6" data-path="reporting-statistics.html"><a href="reporting-statistics.html#bayesian-statistics"><i class="fa fa-check"></i><b>24.1.6</b> Bayesian statistics –&gt;</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-22"><i class="fa fa-check"></i><b>24.2</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html"><i class="fa fa-check"></i><b>25</b> Cheatsheets</a><ul>
<li class="chapter" data-level="25.1" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#statistics"><i class="fa fa-check"></i><b>25.1</b> Statistics</a></li>
<li class="chapter" data-level="25.2" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#r"><i class="fa fa-check"></i><b>25.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mediation-moderation" class="section level1">
<h1><span class="header-section-number">Chapter 15</span> Mediation &amp; Moderation</h1>
<p>These notes are adapted from this tutorial: <a href="https://ademos.people.uic.edu/Chapter14.html">Mediation and moderation</a></p>
<blockquote>
<p><em>Mediation analysis</em> tests a hypothetical causal chain where one variable <strong>X</strong> affects a second variable <strong>M</strong> and, in turn, that variable affects a third variable <strong>Y</strong>. Mediators describe the how or why of a (typically well-established) relationship between two other variables and are sometimes called intermediary variables since they often describe the process through which an effect occurs. This is also sometimes called an indirect effect. For instance, people with higher incomes tend to live longer but this effect is explained by the mediating influence of having access to better health care.</p>
</blockquote>
<div id="learning-goals-13" class="section level2">
<h2><span class="header-section-number">15.1</span> Learning goals</h2>
<ul>
<li>Simulating a mediation analysis.</li>
<li>Baron and Kenny’s (1986) steps for mediation.</li>
<li>Testing the significance of a mediation.
<ul>
<li>Sobel test.</li>
<li>Bootstrapping.</li>
<li>Bayesian approach.</li>
</ul></li>
<li>Limitations of mediation analysis.</li>
<li>Simulating a moderator effect.</li>
</ul>
</div>
<div id="recommended-reading" class="section level2">
<h2><span class="header-section-number">15.2</span> Recommended reading</h2>
<ul>
<li><span class="citation">Fiedler, Schott, and Meiser (<a href="#ref-fiedler2011mediation" role="doc-biblioref">2011</a>)</span></li>
<li><span class="citation">MacKinnon, Fairchild, and Fritz (<a href="#ref-mackinnon2007mediationa" role="doc-biblioref">2007</a>)</span></li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-8" class="section level2">
<h2><span class="header-section-number">15.3</span> Load packages and set plotting theme</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(<span class="st">&quot;knitr&quot;</span>)         <span class="co"># for knitting RMarkdown </span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>)    <span class="co"># for making nice tables</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(<span class="st">&quot;janitor&quot;</span>)       <span class="co"># for cleaning column names</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(<span class="st">&quot;mediation&quot;</span>)     <span class="co"># for mediation and moderation analysis </span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(<span class="st">&quot;multilevel&quot;</span>)    <span class="co"># Sobel test</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>)         <span class="co"># tidying up regression results</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(<span class="st">&quot;DiagrammeR&quot;</span>)    <span class="co"># for drawing diagrams</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(<span class="st">&quot;DiagrammeRsvg&quot;</span>) <span class="co"># for exporting pdfs of graphs </span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">library</span>(<span class="st">&quot;rsvg&quot;</span>)          <span class="co"># for exporting pdfs of graphs </span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)     <span class="co"># for wrangling, plotting, etc. </span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">theme_set</span>(<span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="co">#set the theme </span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">            </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></a></code></pre></div>
</div>
<div id="controlling-for-variables" class="section level2">
<h2><span class="header-section-number">15.4</span> Controlling for variables</h2>
<div id="illustration-of-the-d-separation-algorithm" class="section level3">
<h3><span class="header-section-number">15.4.1</span> Illustration of the d-separation algorithm</h3>
<ul>
<li>Question: Are D and E independent?</li>
</ul>
<div id="full-dag" class="section level4">
<h4><span class="header-section-number">15.4.1.1</span> Full DAG</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st">digraph neato {</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="st">  a [label = &#39;A&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="st">  b [label = &#39;B&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="st">  c [label = &#39;C&#39; pos = &#39;1,-1!&#39;]</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="st">  d [label = &#39;D&#39; pos = &#39;0,-2!&#39;]</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="st">  e [label = &#39;E&#39; pos = &#39;2,-2!&#39;]</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="st">  f [label = &#39;F&#39; pos = &#39;1,-3!&#39;]</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="st">  g [label = &#39;G&#39; pos = &#39;0,-4!&#39;]</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="st">  </span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="st">  a -&gt; c</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="st">  b -&gt; c</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="st">  c -&gt; {d e}</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="st">  d -&gt; f</span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="st">  f -&gt; g</span></a>
<a class="sourceLine" id="cb3-33" title="33"></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="st">}</span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="st">&quot;</span>) </a>
<a class="sourceLine" id="cb3-38" title="38"></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co"># export as pdf </span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb3-42" title="42"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="co">#   rsvg_pdf(&quot;figures/dag.pdf&quot;)</span></a>
<a class="sourceLine" id="cb3-44" title="44"></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb3-46" title="46">g</a></code></pre></div>
<div id="htmlwidget-74b82635e2e9a4a9399b" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-74b82635e2e9a4a9399b">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  a [label = \"A\" pos = \"0,0!\"]\n  b [label = \"B\"  pos = \"2,0!\"]\n  c [label = \"C\" pos = \"1,-1!\"]\n  d [label = \"D\" pos = \"0,-2!\"]\n  e [label = \"E\" pos = \"2,-2!\"]\n  f [label = \"F\" pos = \"1,-3!\"]\n  g [label = \"G\" pos = \"0,-4!\"]\n  \n  # edges between nodes\n  edge [color = black]\n  a -> c\n  b -> c\n  c -> {d e}\n  d -> f\n  f -> g\n\n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="draw-the-ancestral-graph" class="section level4">
<h4><span class="header-section-number">15.4.1.2</span> Draw the ancestral graph</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">digraph neato {</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="st">  a [label = &#39;A&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="st">  b [label = &#39;B&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="st">  c [label = &#39;C&#39; pos = &#39;1,-1!&#39;]</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="st">  d [label = &#39;D&#39; pos = &#39;0,-2!&#39;]</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="st">  e [label = &#39;E&#39; pos = &#39;2,-2!&#39;]</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="st">  </span></a>
<a class="sourceLine" id="cb4-24" title="24"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="st">  a -&gt; c</span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="st">  b -&gt; c</span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="st">  c -&gt; {d e}</span></a>
<a class="sourceLine" id="cb4-29" title="29"></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb4-32" title="32"><span class="st">}</span></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="st">&quot;</span>) </a>
<a class="sourceLine" id="cb4-34" title="34"></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co"># export as pdf </span></a>
<a class="sourceLine" id="cb4-36" title="36"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb4-37" title="37"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb4-38" title="38"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb4-39" title="39"><span class="co">#   rsvg_pdf(&quot;figures/ancestral_graph.pdf&quot;)</span></a>
<a class="sourceLine" id="cb4-40" title="40"></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb4-42" title="42">g</a></code></pre></div>
<div id="htmlwidget-158406e65ca4c7eea1bc" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-158406e65ca4c7eea1bc">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  a [label = \"A\" pos = \"0,0!\"]\n  b [label = \"B\"  pos = \"2,0!\"]\n  c [label = \"C\" pos = \"1,-1!\"]\n  d [label = \"D\" pos = \"0,-2!\"]\n  e [label = \"E\" pos = \"2,-2!\"]\n  \n  # edges between nodes\n  edge [color = black]\n  a -> c\n  b -> c\n  c -> {d e}\n\n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="moralize-the-ancestral-graph-by-marrying-any-parents-and-disorient-by-replacing-arrows-with-edges" class="section level4">
<h4><span class="header-section-number">15.4.1.3</span> “Moralize” the ancestral graph by “marrying” any parents, and disorient by replacing arrows with edges</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">graph neato {</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="st">  a [label = &#39;A&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="st">  b [label = &#39;B&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="st">  c [label = &#39;C&#39; pos = &#39;1,-1!&#39;]</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="st">  d [label = &#39;D&#39; pos = &#39;0,-2!&#39;]</span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="st">  e [label = &#39;E&#39; pos = &#39;2,-2!&#39;]</span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="st">  </span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="st">  a -- c</span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="st">  b -- c</span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="st">  c -- {d e}</span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="st">  </span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="st">  a -- b</span></a>
<a class="sourceLine" id="cb5-32" title="32"></a>
<a class="sourceLine" id="cb5-33" title="33"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="st">}</span></a>
<a class="sourceLine" id="cb5-36" title="36"><span class="st">&quot;</span>) </a>
<a class="sourceLine" id="cb5-37" title="37"></a>
<a class="sourceLine" id="cb5-38" title="38"><span class="co"># export as pdf </span></a>
<a class="sourceLine" id="cb5-39" title="39"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb5-40" title="40"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb5-41" title="41"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb5-42" title="42"><span class="co">#   rsvg_pdf(&quot;figures/moralize_and_disorient.pdf&quot;)</span></a>
<a class="sourceLine" id="cb5-43" title="43"></a>
<a class="sourceLine" id="cb5-44" title="44"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb5-45" title="45">g</a></code></pre></div>
<div id="htmlwidget-e0559c11a751650b505a" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-e0559c11a751650b505a">{"x":{"diagram":"\ngraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  a [label = \"A\" pos = \"0,0!\"]\n  b [label = \"B\"  pos = \"2,0!\"]\n  c [label = \"C\" pos = \"1,-1!\"]\n  d [label = \"D\" pos = \"0,-2!\"]\n  e [label = \"E\" pos = \"2,-2!\"]\n  \n  # edges between nodes\n  edge [color = black]\n  a -- c\n  b -- c\n  c -- {d e}\n  \n  edge [color = black]\n  a -- b\n\n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<ul>
<li>For the case in which we check whether D and E are independent conditioned on C</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">graph neato {</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="st">  a [label = &#39;A&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="st">  b [label = &#39;B&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="st">  d [label = &#39;D&#39; pos = &#39;0,-2!&#39;]</span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="st">  e [label = &#39;E&#39; pos = &#39;2,-2!&#39;]</span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="st">  </span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb6-24" title="24"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb6-25" title="25"></a>
<a class="sourceLine" id="cb6-26" title="26"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb6-27" title="27"><span class="st">  a -- b</span></a>
<a class="sourceLine" id="cb6-28" title="28"></a>
<a class="sourceLine" id="cb6-29" title="29"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb6-30" title="30"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb6-31" title="31"><span class="st">}</span></a>
<a class="sourceLine" id="cb6-32" title="32"><span class="st">&quot;</span>) </a>
<a class="sourceLine" id="cb6-33" title="33"></a>
<a class="sourceLine" id="cb6-34" title="34"><span class="co">## export as pdf </span></a>
<a class="sourceLine" id="cb6-35" title="35"><span class="co">#g %&gt;% </span></a>
<a class="sourceLine" id="cb6-36" title="36"><span class="co">#  export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb6-37" title="37"><span class="co">#  charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb6-38" title="38"><span class="co">#  rsvg_pdf(&quot;figures/moralize_and_disorient2.pdf&quot;)</span></a>
<a class="sourceLine" id="cb6-39" title="39"></a>
<a class="sourceLine" id="cb6-40" title="40"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb6-41" title="41">g</a></code></pre></div>
<div id="htmlwidget-0acf92d39db333433282" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-0acf92d39db333433282">{"x":{"diagram":"\ngraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  a [label = \"A\" pos = \"0,0!\"]\n  b [label = \"B\"  pos = \"2,0!\"]\n  d [label = \"D\" pos = \"0,-2!\"]\n  e [label = \"E\" pos = \"2,-2!\"]\n  \n  # edges between nodes\n  edge [color = black]\n\n  edge [color = black]\n  a -- b\n\n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="good-controls" class="section level3">
<h3><span class="header-section-number">15.4.2</span> Good controls</h3>
<div id="common-cause-with-direct-link-between-x-and-y" class="section level4">
<h4><span class="header-section-number">15.4.2.1</span> Common cause (with direct link between X and Y)</h4>
<div id="dag" class="section level5">
<h5><span class="header-section-number">15.4.2.1.1</span> DAG</h5>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">digraph neato {</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="st">  z [label = &#39;Z&#39; pos = &#39;1,1!&#39;, fontcolor = &#39;red&#39;]</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="st">  </span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="st">  x -&gt; y</span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="st">  z -&gt; {x y}</span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="st">  </span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="st">}</span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="st">&quot;</span>) </a>
<a class="sourceLine" id="cb7-31" title="31"></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co"># export as pdf </span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">#   rsvg_pdf(&quot;figures/common_cause1.pdf&quot;)</span></a>
<a class="sourceLine" id="cb7-37" title="37"></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb7-39" title="39">g</a></code></pre></div>
<div id="htmlwidget-53b0e434479032f6601f" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-53b0e434479032f6601f">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1,1!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> y\n  z -> {x y}\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="regression-1" class="section level5">
<h5><span class="header-section-number">15.4.2.1.2</span> Regression</h5>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3">n =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb8-4" title="4">b_zx =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb8-5" title="5">b_xy =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb8-6" title="6">b_zy =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb8-7" title="7">sd =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb8-8" title="8"></a>
<a class="sourceLine" id="cb8-9" title="9">fun_error =<span class="st"> </span><span class="cf">function</span>(n, sd){</a>
<a class="sourceLine" id="cb8-10" title="10">  <span class="kw">rnorm</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb8-11" title="11">        <span class="dt">mean =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb8-12" title="12">        <span class="dt">sd =</span> sd)</a>
<a class="sourceLine" id="cb8-13" title="13">}</a>
<a class="sourceLine" id="cb8-14" title="14"></a>
<a class="sourceLine" id="cb8-15" title="15">df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">z =</span> <span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb8-16" title="16">            <span class="dt">x =</span> b_zx <span class="op">*</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb8-17" title="17">            <span class="dt">y =</span> b_zy <span class="op">*</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>b_xy <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd))</a>
<a class="sourceLine" id="cb8-18" title="18"></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co"># without control</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb8-21" title="21">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.6011 -0.9270 -0.0506  0.9711  4.0454 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.02449    0.04389   0.558    0.577    
## x            2.82092    0.01890 149.225   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.388 on 998 degrees of freedom
## Multiple R-squared:  0.9571, Adjusted R-squared:  0.9571 
## F-statistic: 2.227e+04 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># with control</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z,</a>
<a class="sourceLine" id="cb10-3" title="3">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + z, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.6151 -0.6564 -0.0223  0.6815  2.8132 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.01624    0.03260   0.498    0.618    
## x            2.02202    0.03135  64.489   &lt;2e-16 ***
## z            2.00501    0.07036  28.497   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.031 on 997 degrees of freedom
## Multiple R-squared:  0.9764, Adjusted R-squared:  0.9763 
## F-statistic: 2.059e+04 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="moralize-and-disorient-the-ancestral-graph" class="section level5">
<h5><span class="header-section-number">15.4.2.1.3</span> Moralize and disorient the ancestral graph</h5>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">graph neato {</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb12-20" title="20"><span class="st">  z [label = &#39;Z&#39; pos = &#39;1,1!&#39;, fontcolor = &#39;red&#39;]</span></a>
<a class="sourceLine" id="cb12-21" title="21"><span class="st">  </span></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb12-23" title="23"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb12-24" title="24"><span class="st">  x -- y</span></a>
<a class="sourceLine" id="cb12-25" title="25"><span class="st">  z -- {x y}</span></a>
<a class="sourceLine" id="cb12-26" title="26"><span class="st">  </span></a>
<a class="sourceLine" id="cb12-27" title="27"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb12-28" title="28"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb12-29" title="29"><span class="st">}</span></a>
<a class="sourceLine" id="cb12-30" title="30"><span class="st">&quot;</span>) </a>
<a class="sourceLine" id="cb12-31" title="31"></a>
<a class="sourceLine" id="cb12-32" title="32"><span class="co"># export as pdf </span></a>
<a class="sourceLine" id="cb12-33" title="33"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb12-34" title="34"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb12-35" title="35"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb12-36" title="36"><span class="co">#   rsvg_pdf(&quot;figures/common_cause1_undirected.pdf&quot;)</span></a>
<a class="sourceLine" id="cb12-37" title="37"><span class="co">#   # rsvg_pdf(&quot;figures/common_cause1_undirected2.pdf&quot;)</span></a>
<a class="sourceLine" id="cb12-38" title="38"></a>
<a class="sourceLine" id="cb12-39" title="39"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb12-40" title="40">g</a></code></pre></div>
<div id="htmlwidget-1f96bd56447ad826d26b" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1f96bd56447ad826d26b">{"x":{"diagram":"\ngraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1,1!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -- y\n  z -- {x y}\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="common-cause-without-direct-link-between-x-and-y" class="section level4">
<h4><span class="header-section-number">15.4.2.2</span> Common cause (without direct link between X and Y)</h4>
<div id="dag-1" class="section level5">
<h5><span class="header-section-number">15.4.2.2.1</span> DAG</h5>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">digraph neato {</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb13-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb13-18" title="18"><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb13-19" title="19"><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb13-20" title="20"><span class="st">  z [label = &#39;Z&#39; pos = &#39;1,1!&#39;, fontcolor = &#39;red&#39;]</span></a>
<a class="sourceLine" id="cb13-21" title="21"><span class="st">  </span></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb13-23" title="23"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb13-24" title="24"><span class="st">  z -&gt; {x y}</span></a>
<a class="sourceLine" id="cb13-25" title="25"><span class="st">  </span></a>
<a class="sourceLine" id="cb13-26" title="26"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb13-27" title="27"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb13-28" title="28"><span class="st">}</span></a>
<a class="sourceLine" id="cb13-29" title="29"><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb13-30" title="30"></a>
<a class="sourceLine" id="cb13-31" title="31"><span class="co"># export as pdf </span></a>
<a class="sourceLine" id="cb13-32" title="32"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb13-33" title="33"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb13-34" title="34"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb13-35" title="35"><span class="co">#   rsvg_pdf(&quot;figures/common_cause2.pdf&quot;)</span></a>
<a class="sourceLine" id="cb13-36" title="36"></a>
<a class="sourceLine" id="cb13-37" title="37"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb13-38" title="38">g</a></code></pre></div>
<div id="htmlwidget-75558b891e680430c814" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-75558b891e680430c814">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1,1!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  z -> {x y}\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="regression-2" class="section level5">
<h5><span class="header-section-number">15.4.2.2.2</span> Regression</h5>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-2" title="2">n =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb14-3" title="3">b_zx =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb14-4" title="4">b_zy =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb14-5" title="5">sd =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb14-6" title="6"></a>
<a class="sourceLine" id="cb14-7" title="7">fun_error =<span class="st"> </span><span class="cf">function</span>(n, sd){</a>
<a class="sourceLine" id="cb14-8" title="8">  <span class="kw">rnorm</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb14-9" title="9">        <span class="dt">mean =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb14-10" title="10">        <span class="dt">sd =</span> sd)</a>
<a class="sourceLine" id="cb14-11" title="11">}</a>
<a class="sourceLine" id="cb14-12" title="12"></a>
<a class="sourceLine" id="cb14-13" title="13">df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">z =</span> <span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb14-14" title="14">            <span class="dt">x =</span> b_zx <span class="op">*</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb14-15" title="15">            <span class="dt">y =</span> b_zy <span class="op">*</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd))</a>
<a class="sourceLine" id="cb14-16" title="16"></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="co"># without control</span></a>
<a class="sourceLine" id="cb14-18" title="18"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb14-19" title="19">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-20" title="20"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.6011 -0.9270 -0.0506  0.9711  4.0454 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.02449    0.04389   0.558    0.577    
## x            0.82092    0.01890  43.426   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.388 on 998 degrees of freedom
## Multiple R-squared:  0.6539, Adjusted R-squared:  0.6536 
## F-statistic:  1886 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># with control</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z,</a>
<a class="sourceLine" id="cb16-3" title="3">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + z, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.6151 -0.6564 -0.0223  0.6815  2.8132 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.01624    0.03260   0.498    0.618    
## x            0.02202    0.03135   0.702    0.483    
## z            2.00501    0.07036  28.497   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.031 on 997 degrees of freedom
## Multiple R-squared:  0.8093, Adjusted R-squared:  0.8089 
## F-statistic:  2115 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="bad-controls" class="section level3">
<h3><span class="header-section-number">15.4.3</span> Bad controls</h3>
<div id="common-effect-with-direct-link" class="section level4">
<h4><span class="header-section-number">15.4.3.1</span> Common effect (with direct link)</h4>
<div id="dag-2" class="section level5">
<h5><span class="header-section-number">15.4.3.1.1</span> DAG</h5>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">digraph neato {</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="st">  z [label = &#39;Z&#39; pos = &#39;1,-1!&#39;, fontcolor = &#39;red&#39;]</span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="st">  </span></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb18-23" title="23"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb18-24" title="24"><span class="st">  x -&gt; y</span></a>
<a class="sourceLine" id="cb18-25" title="25"><span class="st">  x -&gt; z</span></a>
<a class="sourceLine" id="cb18-26" title="26"><span class="st">  y -&gt; z</span></a>
<a class="sourceLine" id="cb18-27" title="27"><span class="st">  </span></a>
<a class="sourceLine" id="cb18-28" title="28"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb18-29" title="29"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb18-30" title="30"><span class="st">}</span></a>
<a class="sourceLine" id="cb18-31" title="31"><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb18-32" title="32"></a>
<a class="sourceLine" id="cb18-33" title="33"><span class="co"># export as pdf </span></a>
<a class="sourceLine" id="cb18-34" title="34"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb18-35" title="35"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb18-36" title="36"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb18-37" title="37"><span class="co">#   rsvg_pdf(&quot;figures/common_effect_with_direct_link.pdf&quot;)</span></a>
<a class="sourceLine" id="cb18-38" title="38"></a>
<a class="sourceLine" id="cb18-39" title="39"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb18-40" title="40">g</a></code></pre></div>
<div id="htmlwidget-ee93495de126a718e619" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-ee93495de126a718e619">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1,-1!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> y\n  x -> z\n  y -> z\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="regression-3" class="section level5">
<h5><span class="header-section-number">15.4.3.1.2</span> Regression</h5>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">set.seed</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-2" title="2">n =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb19-3" title="3">b_xy =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb19-4" title="4">b_xz =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb19-5" title="5">b_yz =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb19-6" title="6">sd =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb19-7" title="7"></a>
<a class="sourceLine" id="cb19-8" title="8">fun_error =<span class="st"> </span><span class="cf">function</span>(n, sd){</a>
<a class="sourceLine" id="cb19-9" title="9">  <span class="kw">rnorm</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb19-10" title="10">        <span class="dt">mean =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb19-11" title="11">        <span class="dt">sd =</span> sd)</a>
<a class="sourceLine" id="cb19-12" title="12">}</a>
<a class="sourceLine" id="cb19-13" title="13"></a>
<a class="sourceLine" id="cb19-14" title="14">df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb19-15" title="15">            <span class="dt">y =</span> x <span class="op">*</span><span class="st"> </span>b_xy <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb19-16" title="16">            <span class="dt">z =</span> x <span class="op">*</span><span class="st"> </span>b_xz <span class="op">+</span><span class="st"> </span>y <span class="op">*</span><span class="st"> </span>b_yz <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd))</a>
<a class="sourceLine" id="cb19-17" title="17"></a>
<a class="sourceLine" id="cb19-18" title="18"><span class="co"># without control</span></a>
<a class="sourceLine" id="cb19-19" title="19"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb19-20" title="20">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-21" title="21"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.1496 -0.8196  0.1370  0.7195  2.0560 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.02777    0.09892   0.281     0.78    
## x            1.95290    0.08566  22.798   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9888 on 98 degrees of freedom
## Multiple R-squared:  0.8414, Adjusted R-squared:  0.8397 
## F-statistic: 519.8 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># with control</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z,</a>
<a class="sourceLine" id="cb21-3" title="3">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + z, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.21227 -0.28384  0.01043  0.26406  1.35276 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.04969    0.04783  -1.039   0.3014    
## x           -0.35095    0.13417  -2.616   0.0103 *  
## z            0.39211    0.02173  18.045   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4762 on 97 degrees of freedom
## Multiple R-squared:  0.9636, Adjusted R-squared:  0.9628 
## F-statistic:  1284 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="moralize-and-disorient-the-ancestral-graph-1" class="section level5">
<h5><span class="header-section-number">15.4.3.1.3</span> Moralize and disorient the ancestral graph</h5>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="st">graph neato {</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb23-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb23-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb23-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb23-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb23-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb23-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb23-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb23-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb23-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb23-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb23-18" title="18"><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb23-19" title="19"><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb23-20" title="20"><span class="st">  z [label = &#39;Z&#39; pos = &#39;1,-1!&#39;, fontcolor = &#39;red&#39;]</span></a>
<a class="sourceLine" id="cb23-21" title="21"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-22" title="22"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb23-23" title="23"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb23-24" title="24"><span class="st">  x -- y</span></a>
<a class="sourceLine" id="cb23-25" title="25"><span class="st">  x -- z</span></a>
<a class="sourceLine" id="cb23-26" title="26"><span class="st">  y -- z</span></a>
<a class="sourceLine" id="cb23-27" title="27"><span class="st">  </span></a>
<a class="sourceLine" id="cb23-28" title="28"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb23-29" title="29"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb23-30" title="30"><span class="st">}</span></a>
<a class="sourceLine" id="cb23-31" title="31"><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb23-32" title="32"></a>
<a class="sourceLine" id="cb23-33" title="33"><span class="co"># export as pdf </span></a>
<a class="sourceLine" id="cb23-34" title="34"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb23-35" title="35"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb23-36" title="36"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb23-37" title="37"><span class="co">#   rsvg_pdf(&quot;figures/common_effect_with_direct_link_undirected1.pdf&quot;)</span></a>
<a class="sourceLine" id="cb23-38" title="38"><span class="co">#   # rsvg_pdf(&quot;figures/common_effect_with_direct_link_undirected2.pdf&quot;)</span></a>
<a class="sourceLine" id="cb23-39" title="39"></a>
<a class="sourceLine" id="cb23-40" title="40"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb23-41" title="41">g</a></code></pre></div>
<div id="htmlwidget-b453099d6c8dbaaa1192" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-b453099d6c8dbaaa1192">{"x":{"diagram":"\ngraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1,-1!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -- y\n  x -- z\n  y -- z\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="causal-chain-1" class="section level4">
<h4><span class="header-section-number">15.4.3.2</span> Causal chain 1</h4>
<div id="dag-3" class="section level5">
<h5><span class="header-section-number">15.4.3.2.1</span> DAG</h5>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="st">digraph neato {</span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb24-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb24-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb24-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb24-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb24-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb24-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb24-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb24-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb24-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb24-18" title="18"><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb24-19" title="19"><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb24-20" title="20"><span class="st">  z [label = &#39;Z&#39; pos = &#39;1, 0!&#39;, fontcolor = &#39;red&#39;]</span></a>
<a class="sourceLine" id="cb24-21" title="21"><span class="st">  </span></a>
<a class="sourceLine" id="cb24-22" title="22"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb24-23" title="23"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb24-24" title="24"><span class="st">  x -&gt; z</span></a>
<a class="sourceLine" id="cb24-25" title="25"><span class="st">  z -&gt; y</span></a>
<a class="sourceLine" id="cb24-26" title="26"><span class="st">  </span></a>
<a class="sourceLine" id="cb24-27" title="27"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb24-28" title="28"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb24-29" title="29"><span class="st">}</span></a>
<a class="sourceLine" id="cb24-30" title="30"><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb24-31" title="31"></a>
<a class="sourceLine" id="cb24-32" title="32"><span class="co"># # export as pdf </span></a>
<a class="sourceLine" id="cb24-33" title="33"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb24-34" title="34"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb24-35" title="35"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb24-36" title="36"><span class="co">#   rsvg_pdf(&quot;figures/causal_chain.pdf&quot;)</span></a>
<a class="sourceLine" id="cb24-37" title="37"></a>
<a class="sourceLine" id="cb24-38" title="38"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb24-39" title="39">g</a></code></pre></div>
<div id="htmlwidget-fd11da0708061dc635d0" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-fd11da0708061dc635d0">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"1, 0!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> z\n  z -> y\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="regression-4" class="section level5">
<h5><span class="header-section-number">15.4.3.2.2</span> Regression</h5>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb25-2" title="2">n =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb25-3" title="3">b_xz =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb25-4" title="4">b_zy =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb25-5" title="5">sd =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb25-6" title="6"></a>
<a class="sourceLine" id="cb25-7" title="7">fun_error =<span class="st"> </span><span class="cf">function</span>(n, sd){</a>
<a class="sourceLine" id="cb25-8" title="8">  <span class="kw">rnorm</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb25-9" title="9">        <span class="dt">mean =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb25-10" title="10">        <span class="dt">sd =</span> sd)</a>
<a class="sourceLine" id="cb25-11" title="11">}</a>
<a class="sourceLine" id="cb25-12" title="12"></a>
<a class="sourceLine" id="cb25-13" title="13">df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb25-14" title="14">            <span class="dt">z =</span> x <span class="op">*</span><span class="st"> </span>b_xz <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb25-15" title="15">            <span class="dt">y =</span> z <span class="op">*</span><span class="st"> </span>b_zy <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd))</a>
<a class="sourceLine" id="cb25-16" title="16"></a>
<a class="sourceLine" id="cb25-17" title="17"><span class="co"># without control</span></a>
<a class="sourceLine" id="cb25-18" title="18"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb25-19" title="19">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-20" title="20"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -3.336 -1.208  0.209  1.220  3.189 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.1547     0.3982   0.388    0.702    
## x             3.8488     0.4374   8.799 6.15e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.741 on 18 degrees of freedom
## Multiple R-squared:  0.8114, Adjusted R-squared:  0.8009 
## F-statistic: 77.43 on 1 and 18 DF,  p-value: 6.154e-08</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># with control</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z,</a>
<a class="sourceLine" id="cb27-3" title="3">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + z, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.35959 -0.56643 -0.06193  0.48088  1.80592 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.09559    0.18177   0.526    0.606    
## x            0.64724    0.43278   1.496    0.153    
## z            1.78614    0.21425   8.337 2.07e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7943 on 17 degrees of freedom
## Multiple R-squared:  0.9629, Adjusted R-squared:  0.9586 
## F-statistic: 220.8 on 2 and 17 DF,  p-value: 6.868e-13</code></pre>
</div>
</div>
<div id="causal-chain-2" class="section level4">
<h4><span class="header-section-number">15.4.3.3</span> Causal chain 2</h4>
<div id="dag-4" class="section level5">
<h5><span class="header-section-number">15.4.3.3.1</span> DAG</h5>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="st">digraph neato {</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb29-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb29-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb29-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb29-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb29-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb29-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb29-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb29-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb29-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb29-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb29-18" title="18"><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb29-19" title="19"><span class="st">  y [label = &#39;Y&#39;  pos = &#39;1,0!&#39;]</span></a>
<a class="sourceLine" id="cb29-20" title="20"><span class="st">  z [label = &#39;Z&#39; pos = &#39;2, 0!&#39;, fontcolor = &#39;red&#39;]</span></a>
<a class="sourceLine" id="cb29-21" title="21"><span class="st">  </span></a>
<a class="sourceLine" id="cb29-22" title="22"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb29-23" title="23"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb29-24" title="24"><span class="st">  x -&gt; y</span></a>
<a class="sourceLine" id="cb29-25" title="25"><span class="st">  y -&gt; z</span></a>
<a class="sourceLine" id="cb29-26" title="26"><span class="st">  </span></a>
<a class="sourceLine" id="cb29-27" title="27"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb29-28" title="28"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb29-29" title="29"><span class="st">}</span></a>
<a class="sourceLine" id="cb29-30" title="30"><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb29-31" title="31"></a>
<a class="sourceLine" id="cb29-32" title="32"><span class="co"># # export as pdf </span></a>
<a class="sourceLine" id="cb29-33" title="33"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb29-34" title="34"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb29-35" title="35"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb29-36" title="36"><span class="co">#   rsvg_pdf(&quot;figures/causal_chain2.pdf&quot;)</span></a>
<a class="sourceLine" id="cb29-37" title="37"></a>
<a class="sourceLine" id="cb29-38" title="38"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb29-39" title="39">g</a></code></pre></div>
<div id="htmlwidget-18065f7f86a708479052" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-18065f7f86a708479052">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"1,0!\"]\n  z [label = \"Z\" pos = \"2, 0!\", fontcolor = \"red\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> y\n  y -> z\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="regression-5" class="section level5">
<h5><span class="header-section-number">15.4.3.3.2</span> Regression</h5>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">n =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb30-3" title="3">b_xy =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb30-4" title="4">b_yz =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb30-5" title="5">sd =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb30-6" title="6"></a>
<a class="sourceLine" id="cb30-7" title="7">fun_error =<span class="st"> </span><span class="cf">function</span>(n, sd){</a>
<a class="sourceLine" id="cb30-8" title="8">  <span class="kw">rnorm</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb30-9" title="9">        <span class="dt">mean =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb30-10" title="10">        <span class="dt">sd =</span> sd)</a>
<a class="sourceLine" id="cb30-11" title="11">}</a>
<a class="sourceLine" id="cb30-12" title="12"></a>
<a class="sourceLine" id="cb30-13" title="13">df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb30-14" title="14">            <span class="dt">y =</span> x <span class="op">*</span><span class="st"> </span>b_xy <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb30-15" title="15">            <span class="dt">z =</span> y <span class="op">*</span><span class="st"> </span>b_yz <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd),)</a>
<a class="sourceLine" id="cb30-16" title="16"></a>
<a class="sourceLine" id="cb30-17" title="17"><span class="co"># without control</span></a>
<a class="sourceLine" id="cb30-18" title="18"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb30-19" title="19">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-20" title="20"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.69133 -0.43739 -0.07132  0.68033  1.63937 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.03307    0.19981   0.166     0.87    
## x            1.79245    0.21951   8.166 1.83e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8738 on 18 degrees of freedom
## Multiple R-squared:  0.7874, Adjusted R-squared:  0.7756 
## F-statistic: 66.68 on 1 and 18 DF,  p-value: 1.827e-07</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># with control</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z,</a>
<a class="sourceLine" id="cb32-3" title="3">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + z, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.9023 -0.2316  0.1173  0.2396  0.6319 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.03650    0.09153  -0.399    0.695    
## x            0.06113    0.23056   0.265    0.794    
## z            0.44983    0.05396   8.337 2.07e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3986 on 17 degrees of freedom
## Multiple R-squared:  0.9582, Adjusted R-squared:  0.9533 
## F-statistic:   195 on 2 and 17 DF,  p-value: 1.896e-12</code></pre>
</div>
</div>
<div id="bias-amplification" class="section level4">
<h4><span class="header-section-number">15.4.3.4</span> Bias amplification</h4>
<div id="dag-5" class="section level5">
<h5><span class="header-section-number">15.4.3.4.1</span> DAG</h5>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">g =<span class="st"> </span><span class="kw">grViz</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="st">digraph neato {</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="st">  graph[layout = neato]</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="st">  # general settings for all nodes</span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="st">  node [</span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="st">    shape = circle,</span></a>
<a class="sourceLine" id="cb34-9" title="9"><span class="st">    style = filled,</span></a>
<a class="sourceLine" id="cb34-10" title="10"><span class="st">    color = black,</span></a>
<a class="sourceLine" id="cb34-11" title="11"><span class="st">    label = &#39;&#39;</span></a>
<a class="sourceLine" id="cb34-12" title="12"><span class="st">    fontname = &#39;Helvetica&#39;,</span></a>
<a class="sourceLine" id="cb34-13" title="13"><span class="st">    fontsize = 16,</span></a>
<a class="sourceLine" id="cb34-14" title="14"><span class="st">    fillcolor = lightblue</span></a>
<a class="sourceLine" id="cb34-15" title="15"><span class="st">    ]</span></a>
<a class="sourceLine" id="cb34-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb34-17" title="17"><span class="st">  # labels for each node</span></a>
<a class="sourceLine" id="cb34-18" title="18"><span class="st">  x [label = &#39;X&#39; pos = &#39;0,0!&#39;]</span></a>
<a class="sourceLine" id="cb34-19" title="19"><span class="st">  y [label = &#39;Y&#39;  pos = &#39;2,0!&#39;]</span></a>
<a class="sourceLine" id="cb34-20" title="20"><span class="st">  z [label = &#39;Z&#39; pos = &#39;-1, 1!&#39;, fontcolor = &#39;red&#39;]</span></a>
<a class="sourceLine" id="cb34-21" title="21"><span class="st">  u [label = &#39;U&#39; pos = &#39;1, 1!&#39;, fillcolor = &#39;white&#39;]</span></a>
<a class="sourceLine" id="cb34-22" title="22"><span class="st">  </span></a>
<a class="sourceLine" id="cb34-23" title="23"><span class="st">  # edges between nodes</span></a>
<a class="sourceLine" id="cb34-24" title="24"><span class="st">  edge [color = black]</span></a>
<a class="sourceLine" id="cb34-25" title="25"><span class="st">  x -&gt; y</span></a>
<a class="sourceLine" id="cb34-26" title="26"><span class="st">  z -&gt; x</span></a>
<a class="sourceLine" id="cb34-27" title="27"><span class="st">  u -&gt; {x y}</span></a>
<a class="sourceLine" id="cb34-28" title="28"><span class="st">  </span></a>
<a class="sourceLine" id="cb34-29" title="29"><span class="st">  # direction in which arrows are drawn (from left to right)</span></a>
<a class="sourceLine" id="cb34-30" title="30"><span class="st">  rankdir = LR</span></a>
<a class="sourceLine" id="cb34-31" title="31"><span class="st">}</span></a>
<a class="sourceLine" id="cb34-32" title="32"><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb34-33" title="33"></a>
<a class="sourceLine" id="cb34-34" title="34"><span class="co"># # export as pdf </span></a>
<a class="sourceLine" id="cb34-35" title="35"><span class="co"># g %&gt;% </span></a>
<a class="sourceLine" id="cb34-36" title="36"><span class="co">#   export_svg %&gt;% </span></a>
<a class="sourceLine" id="cb34-37" title="37"><span class="co">#   charToRaw %&gt;% </span></a>
<a class="sourceLine" id="cb34-38" title="38"><span class="co">#   rsvg_pdf(&quot;figures/bias_amplification.pdf&quot;)</span></a>
<a class="sourceLine" id="cb34-39" title="39"></a>
<a class="sourceLine" id="cb34-40" title="40"><span class="co"># show plot</span></a>
<a class="sourceLine" id="cb34-41" title="41">g</a></code></pre></div>
<div id="htmlwidget-fad8e2ad89555140adc5" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-fad8e2ad89555140adc5">{"x":{"diagram":"\ndigraph neato {\n  \n  graph[layout = neato]\n  \n  # general settings for all nodes\n  node [\n    shape = circle,\n    style = filled,\n    color = black,\n    label = \"\"\n    fontname = \"Helvetica\",\n    fontsize = 16,\n    fillcolor = lightblue\n    ]\n  \n  # labels for each node\n  x [label = \"X\" pos = \"0,0!\"]\n  y [label = \"Y\"  pos = \"2,0!\"]\n  z [label = \"Z\" pos = \"-1, 1!\", fontcolor = \"red\"]\n  u [label = \"U\" pos = \"1, 1!\", fillcolor = \"white\"]\n  \n  # edges between nodes\n  edge [color = black]\n  x -> y\n  z -> x\n  u -> {x y}\n  \n  # direction in which arrows are drawn (from left to right)\n  rankdir = LR\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="regression-6" class="section level4">
<h4><span class="header-section-number">15.4.3.5</span> Regression</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb35-2" title="2">n =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb35-3" title="3">b_xy =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb35-4" title="4">b_ux =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb35-5" title="5">b_uy =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb35-6" title="6">b_zx =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb35-7" title="7">sd =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb35-8" title="8"></a>
<a class="sourceLine" id="cb35-9" title="9">fun_error =<span class="st"> </span><span class="cf">function</span>(n, sd){</a>
<a class="sourceLine" id="cb35-10" title="10">  <span class="kw">rnorm</span>(<span class="dt">n =</span> n,</a>
<a class="sourceLine" id="cb35-11" title="11">        <span class="dt">mean =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb35-12" title="12">        <span class="dt">sd =</span> sd)</a>
<a class="sourceLine" id="cb35-13" title="13">}</a>
<a class="sourceLine" id="cb35-14" title="14"></a>
<a class="sourceLine" id="cb35-15" title="15">df =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">u =</span> <span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb35-16" title="16">            <span class="dt">z =</span> <span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb35-17" title="17">            <span class="dt">x =</span> u <span class="op">*</span><span class="st"> </span>b_ux <span class="op">+</span><span class="st"> </span>z <span class="op">*</span><span class="st"> </span>b_zx <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd),</a>
<a class="sourceLine" id="cb35-18" title="18">            <span class="dt">y =</span> u <span class="op">*</span><span class="st"> </span>b_uy <span class="op">+</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>b_xy <span class="op">+</span><span class="st"> </span><span class="kw">fun_error</span>(n, sd))</a>
<a class="sourceLine" id="cb35-19" title="19"></a>
<a class="sourceLine" id="cb35-20" title="20"><span class="co"># without control</span></a>
<a class="sourceLine" id="cb35-21" title="21"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb35-22" title="22">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-23" title="23"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.2838 -0.8662 -0.2281  0.7201  3.1619 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.1903     0.3282    0.58    0.569    
## x             2.5771     0.1375   18.74 2.96e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.434 on 18 degrees of freedom
## Multiple R-squared:  0.9512, Adjusted R-squared:  0.9485 
## F-statistic: 351.1 on 1 and 18 DF,  p-value: 2.961e-13</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># with control</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z,</a>
<a class="sourceLine" id="cb37-3" title="3">   <span class="dt">data =</span> df) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + z, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9114 -0.4876 -0.1044  0.6333  1.8935 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.07431    0.24564   0.303  0.76594    
## x            2.78984    0.11553  24.147 1.35e-14 ***
## z           -1.25270    0.31719  -3.949  0.00103 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.066 on 17 degrees of freedom
## Multiple R-squared:  0.9746, Adjusted R-squared:  0.9716 
## F-statistic: 325.7 on 2 and 17 DF,  p-value: 2.793e-14</code></pre>
</div>
</div>
</div>
<div id="mediation" class="section level2">
<h2><span class="header-section-number">15.5</span> Mediation</h2>
<div class="figure"><span id="fig:mediation-moderation-22"></span>
<img src="figures/mediation.png" alt="__Basic mediation model__. c = the total effect of X on Y; c = c’ + ab; c’ = the direct effect of X on Y after controlling for M; c’ = c - ab; ab = indirect effect of X on Y." width="75%" />
<p class="caption">
Figure 15.1: <strong>Basic mediation model</strong>. c = the total effect of X on Y; c = c’ + ab; c’ = the direct effect of X on Y after controlling for M; c’ = c - ab; ab = indirect effect of X on Y.
</p>
</div>
<p>Mediation tests whether the effects of <strong>X</strong> (the independent variable) on <strong>Y</strong> (the dependent variable) operate through a third variable, <strong>M</strong> (the mediator). In this way, mediators explain the causal relationship between two variables or “how” the relationship works, making it a very popular method in psychological research.</p>
<p>Figure <a href="mediation-moderation.html#fig:mediation-moderation-22">15.1</a> shows the standard mediation model. Perfect mediation occurs when the effect of <strong>X</strong> on <strong>Y</strong> decreases to 0 with <strong>M</strong> in the model. Partial mediation occurs when the effect of <strong>X</strong> on <strong>Y</strong> decreases by a nontrivial amount (the actual amount is up for debate) with <strong>M</strong> in the model.</p>
<p><strong>Important</strong>: Both mediation and moderation assume that the DV <strong>did not CAUSE the mediator/moderator</strong>.</p>
<div id="generate-data" class="section level3">
<h3><span class="header-section-number">15.5.1</span> Generate data</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co"># make example reproducible</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb39-3" title="3"></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="co"># number of participants</span></a>
<a class="sourceLine" id="cb39-5" title="5">n =<span class="st"> </span><span class="dv">100</span> </a>
<a class="sourceLine" id="cb39-6" title="6"></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="co"># generate data</span></a>
<a class="sourceLine" id="cb39-8" title="8">df.mediation =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">rnorm</span>(n, <span class="dv">75</span>, <span class="dv">7</span>), <span class="co"># grades</span></a>
<a class="sourceLine" id="cb39-9" title="9">  <span class="dt">m =</span> <span class="fl">0.7</span> <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>), <span class="co"># self-esteem</span></a>
<a class="sourceLine" id="cb39-10" title="10">  <span class="dt">y =</span> <span class="fl">0.4</span> <span class="op">*</span><span class="st"> </span>m <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)) <span class="co"># happiness</span></a></code></pre></div>
</div>
<div id="method-1-baron-kennys-1986-indirect-effect-method" class="section level3">
<h3><span class="header-section-number">15.5.2</span> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</h3>
<p>The <span class="citation">Baron and Kenny (<a href="#ref-baron1986moderator" role="doc-biblioref">1986</a>)</span> method is among the original methods for testing for mediation but tends to have low statistical power. It is covered in this chapter because it provides a very clear approach to establishing relationships between variables and is still occassionally requested by reviewers.</p>
<p><strong>The three steps</strong>:</p>
<ol style="list-style-type: decimal">
<li><p>Estimate the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (hours since dawn on degree of wakefulness). Path “c” must be significantly different from 0; must have a total effect between the IV &amp; DV.</p></li>
<li><p>Estimate the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(M\)</span> (hours since dawn on coffee consumption). Path “a” must be significantly different from 0; IV and mediator must be related.</p></li>
<li><p>Estimate the relationship between <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> controlling for <span class="math inline">\(X\)</span> (coffee consumption on wakefulness, controlling for hours since dawn). Path “b” must be significantly different from 0; mediator and DV must be related. The effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> decreases with the inclusion of <span class="math inline">\(M\)</span> in the model.</p></li>
</ol>
<div id="total-effect" class="section level4">
<h4><span class="header-section-number">15.5.2.1</span> Total effect</h4>
<p>Total effect of X on Y (not controlling for M).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co"># fit the model</span></a>
<a class="sourceLine" id="cb40-2" title="2">fit.y_x =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb40-3" title="3">            <span class="dt">data =</span> df.mediation)</a>
<a class="sourceLine" id="cb40-4" title="4"></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="co"># summarize the results</span></a>
<a class="sourceLine" id="cb40-6" title="6">fit.y_x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x, data = df.mediation)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.917  -3.738  -0.259   2.910  12.540 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  8.78300    6.16002   1.426   0.1571  
## x            0.16899    0.08116   2.082   0.0399 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.16 on 98 degrees of freedom
## Multiple R-squared:  0.04237,    Adjusted R-squared:  0.0326 
## F-statistic: 4.336 on 1 and 98 DF,  p-value: 0.03993</code></pre>
</div>
<div id="path-a" class="section level4">
<h4><span class="header-section-number">15.5.2.2</span> Path a</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">fit.m_x =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> m <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb42-2" title="2">            <span class="dt">data =</span> df.mediation)</a>
<a class="sourceLine" id="cb42-3" title="3"></a>
<a class="sourceLine" id="cb42-4" title="4">fit.m_x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = m ~ 1 + x, data = df.mediation)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5367 -3.4175 -0.4375  2.9032 16.4520 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.29696    5.79432   0.396    0.693    
## x            0.66252    0.07634   8.678 8.87e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.854 on 98 degrees of freedom
## Multiple R-squared:  0.4346, Adjusted R-squared:  0.4288 
## F-statistic: 75.31 on 1 and 98 DF,  p-value: 8.872e-14</code></pre>
</div>
<div id="path-b-and-c" class="section level4">
<h4><span class="header-section-number">15.5.2.3</span> Path b and c’</h4>
<p>Effect of M on Y controlling for X.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">fit.y_mx =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>m <span class="op">+</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb44-2" title="2">            <span class="dt">data =</span> df.mediation)</a>
<a class="sourceLine" id="cb44-3" title="3"></a>
<a class="sourceLine" id="cb44-4" title="4">fit.y_mx <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + m + x, data = df.mediation)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.3651 -3.3037 -0.6222  3.1068 10.3991 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  7.80952    5.68297   1.374    0.173    
## m            0.42381    0.09899   4.281 4.37e-05 ***
## x           -0.11179    0.09949  -1.124    0.264    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.756 on 97 degrees of freedom
## Multiple R-squared:  0.1946, Adjusted R-squared:  0.1779 
## F-statistic: 11.72 on 2 and 97 DF,  p-value: 2.771e-05</code></pre>
</div>
<div id="interpretation" class="section level4">
<h4><span class="header-section-number">15.5.2.4</span> Interpretation</h4>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">fit.y_x <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-2" title="2"><span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">path =</span> <span class="st">&quot;c&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="st">  </span><span class="kw">bind_rows</span>(fit.m_x <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-5" title="5"><span class="st">              </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="st">              </span><span class="kw">mutate</span>(<span class="dt">path =</span> <span class="st">&quot;a&quot;</span>),</a>
<a class="sourceLine" id="cb46-7" title="7">            fit.y_mx <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-8" title="8"><span class="st">              </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-9" title="9"><span class="st">              </span><span class="kw">mutate</span>(<span class="dt">path =</span> <span class="kw">c</span>(<span class="st">&quot;(Intercept)&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&#39;&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-10" title="10"><span class="st">  </span><span class="kw">filter</span>(term <span class="op">!=</span><span class="st"> &quot;(Intercept)&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">significance =</span> p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">.05</span>,</a>
<a class="sourceLine" id="cb46-12" title="12">         <span class="dt">dv =</span> <span class="kw">ifelse</span>(path <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;c&#39;&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="st">&quot;y&quot;</span>, <span class="st">&quot;m&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-13" title="13"><span class="st">  </span><span class="kw">select</span>(path, <span class="dt">iv =</span> term, dv, estimate, p.value, significance)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 6
##   path  iv    dv    estimate  p.value significance
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt;       
## 1 c     x     m        0.169 3.99e- 2 TRUE        
## 2 a     x     m        0.663 8.87e-14 TRUE        
## 3 b     m     y        0.424 4.37e- 5 TRUE        
## 4 c&#39;    x     y       -0.112 2.64e- 1 FALSE</code></pre>
<p>Here we find that our total effect model shows a significant positive relationship between hours since dawn (X) and wakefulness (Y). Our Path A model shows that hours since down (X) is also positively related to coffee consumption (M). Our Path B model then shows that coffee consumption (M) positively predicts wakefulness (Y) when controlling for hours since dawn (X).</p>
<p>Since the relationship between hours since dawn and wakefulness is no longer significant when controlling for coffee consumption, this suggests that coffee consumption does in fact mediate this relationship. However, this method alone does not allow for a formal test of the indirect effect so we don’t know if the change in this relationship is truly meaningful.</p>
</div>
</div>
<div id="method-2-sobel-test" class="section level3">
<h3><span class="header-section-number">15.5.3</span> Method 2: Sobel Test</h3>
<p>The Sobel Test tests whether the indirect effect from X via M to Y is significant.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># run the sobel test</span></a>
<a class="sourceLine" id="cb48-2" title="2">fit.sobel =<span class="st"> </span><span class="kw">sobel</span>(<span class="dt">pred =</span> df.mediation<span class="op">$</span>x,</a>
<a class="sourceLine" id="cb48-3" title="3">                  <span class="dt">med =</span> df.mediation<span class="op">$</span>m,</a>
<a class="sourceLine" id="cb48-4" title="4">                  <span class="dt">out =</span> df.mediation<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb48-5" title="5"></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="co"># calculate the p-value </span></a>
<a class="sourceLine" id="cb48-7" title="7">(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(fit.sobel<span class="op">$</span>z.value))<span class="op">*</span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] 0.0001233403</code></pre>
<p>The relationship between “hours since dawn” and “wakefulness” is significantly mediated by “coffee consumption”.</p>
<p>The Sobel Test is largely considered an outdated method since it assumes that the indirect effect (ab) is normally distributed and tends to only have adequate power with large sample sizes. Thus, again, it is highly recommended to use the mediation bootstrapping method instead.</p>
</div>
<div id="method-3-bootstrapping" class="section level3">
<h3><span class="header-section-number">15.5.4</span> Method 3: Bootstrapping</h3>
<p>The “mediation” packages uses the more recent bootstrapping method of <span class="citation">Preacher and Hayes (<a href="#ref-preacher2004spss" role="doc-biblioref">2004</a>)</span> to address the power limitations of the Sobel Test.</p>
<p>This method does not require that the data are normally distributed, and is particularly suitable for small sample sizes.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">library</span>(<span class="st">&quot;mediation&quot;</span>)</a>
<a class="sourceLine" id="cb50-2" title="2"></a>
<a class="sourceLine" id="cb50-3" title="3"><span class="co"># bootstrapped mediation </span></a>
<a class="sourceLine" id="cb50-4" title="4">fit.mediation =<span class="st"> </span><span class="kw">mediate</span>(<span class="dt">model.m =</span> fit.m_x,</a>
<a class="sourceLine" id="cb50-5" title="5">                        <span class="dt">model.y =</span> fit.y_mx,</a>
<a class="sourceLine" id="cb50-6" title="6">                        <span class="dt">treat =</span> <span class="st">&quot;x&quot;</span>,</a>
<a class="sourceLine" id="cb50-7" title="7">                        <span class="dt">mediator =</span> <span class="st">&quot;m&quot;</span>,</a>
<a class="sourceLine" id="cb50-8" title="8">                        <span class="dt">boot =</span> T)</a></code></pre></div>
<pre><code>## Running nonparametric bootstrap</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># summarize results</span></a>
<a class="sourceLine" id="cb52-2" title="2">fit.mediation <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value    
## ACME            0.28078      0.14133         0.43  &lt;2e-16 ***
## ADE            -0.11179     -0.30293         0.11   0.274    
## Total Effect    0.16899     -0.00539         0.35   0.056 .  
## Prop. Mediated  1.66151     -1.91644        10.16   0.056 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 100 
## 
## 
## Simulations: 1000</code></pre>
<ul>
<li>ACME = Average causal mediation effect</li>
<li>ADE = Average direct effect</li>
<li>Total effect = ACME + ADE</li>
</ul>
<p>Plot the results:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">fit.mediation <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="psych252_files/figure-html/mediation-moderation-30-1.png" width="672" /></p>
<div id="interpretation-1" class="section level4">
<h4><span class="header-section-number">15.5.4.1</span> Interpretation</h4>
<p>The <code>mediate()</code> function gives us our Average Causal Mediation Effects (ACME), our Average Direct Effects (ADE), our combined indirect and direct effects (Total Effect), and the ratio of these estimates (Prop. Mediated). The ACME here is the indirect effect of M (total effect - direct effect) and thus this value tells us if our mediation effect is significant.</p>
</div>
</div>
</div>
<div id="moderation" class="section level2">
<h2><span class="header-section-number">15.6</span> Moderation</h2>
<div class="figure"><span id="fig:mediation-moderation-31"></span>
<img src="figures/moderation.png" alt="__Basic moderation model__." width="75%" />
<p class="caption">
Figure 15.2: <strong>Basic moderation model</strong>.
</p>
</div>
<p>Moderation can be tested by looking for significant interactions between the moderating variable (Z) and the IV (X). Notably, it is important to mean center both your moderator and your IV to reduce multicolinearity and make interpretation easier.</p>
<div id="generate-data-1" class="section level3">
<h3><span class="header-section-number">15.6.1</span> Generate data</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="co"># make example reproducible </span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb55-3" title="3"></a>
<a class="sourceLine" id="cb55-4" title="4"><span class="co"># number of participants</span></a>
<a class="sourceLine" id="cb55-5" title="5">n  =<span class="st"> </span><span class="dv">100</span> </a>
<a class="sourceLine" id="cb55-6" title="6"></a>
<a class="sourceLine" id="cb55-7" title="7">df.moderation =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x  =</span> <span class="kw">abs</span>(<span class="kw">rnorm</span>(n, <span class="dv">6</span>, <span class="dv">4</span>)), <span class="co"># hours of sleep</span></a>
<a class="sourceLine" id="cb55-8" title="8">                       <span class="dt">x1 =</span> <span class="kw">abs</span>(<span class="kw">rnorm</span>(n, <span class="dv">60</span>, <span class="dv">30</span>)), <span class="co"># adding some systematic variance to our DV</span></a>
<a class="sourceLine" id="cb55-9" title="9">                       <span class="dt">z  =</span> <span class="kw">rnorm</span>(n, <span class="dv">30</span>, <span class="dv">8</span>), <span class="co"># ounces of coffee consumed</span></a>
<a class="sourceLine" id="cb55-10" title="10">                       <span class="dt">y  =</span> <span class="kw">abs</span>((<span class="op">-</span><span class="fl">0.8</span> <span class="op">*</span><span class="st"> </span>x) <span class="op">*</span><span class="st"> </span>(<span class="fl">0.2</span> <span class="op">*</span><span class="st"> </span>z) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="fl">0.4</span> <span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-11" title="11"><span class="st">                                  </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3</span>))) <span class="co"># attention Paid</span></a></code></pre></div>
</div>
<div id="moderation-analysis" class="section level3">
<h3><span class="header-section-number">15.6.2</span> Moderation analysis</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co"># scale the predictors </span></a>
<a class="sourceLine" id="cb56-2" title="2">df.moderation =<span class="st"> </span>df.moderation <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb56-3" title="3"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(x, z), <span class="op">~</span><span class="st"> </span><span class="kw">scale</span>(.)[,])</a>
<a class="sourceLine" id="cb56-4" title="4"></a>
<a class="sourceLine" id="cb56-5" title="5"><span class="co"># run regression model with interaction </span></a>
<a class="sourceLine" id="cb56-6" title="6">fit.moderation =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>z,</a>
<a class="sourceLine" id="cb56-7" title="7">                    <span class="dt">data =</span> df.moderation)</a>
<a class="sourceLine" id="cb56-8" title="8"></a>
<a class="sourceLine" id="cb56-9" title="9"><span class="co"># summarize result </span></a>
<a class="sourceLine" id="cb56-10" title="10">fit.moderation <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-11" title="11"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x * z, data = df.moderation)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -21.466  -8.972  -0.233   6.180  38.051 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   48.544      1.173  41.390  &lt; 2e-16 ***
## x             17.863      1.196  14.936  &lt; 2e-16 ***
## z              8.393      1.181   7.108 2.08e-10 ***
## x:z            6.094      1.077   5.656 1.59e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11.65 on 96 degrees of freedom
## Multiple R-squared:  0.7661, Adjusted R-squared:  0.7587 
## F-statistic: 104.8 on 3 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
<div id="visualize-result" class="section level4">
<h4><span class="header-section-number">15.6.2.1</span> Visualize result</h4>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># generate data grid with three levels of the moderator </span></a>
<a class="sourceLine" id="cb58-2" title="2">df.newdata =<span class="st"> </span>df.moderation <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-3" title="3"><span class="st">  </span><span class="kw">expand</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="kw">min</span>(x), </a>
<a class="sourceLine" id="cb58-4" title="4">               <span class="kw">max</span>(x)), </a>
<a class="sourceLine" id="cb58-5" title="5">         <span class="dt">z =</span> <span class="kw">c</span>(<span class="kw">mean</span>(z) <span class="op">-</span><span class="st"> </span><span class="kw">sd</span>(z),</a>
<a class="sourceLine" id="cb58-6" title="6">               <span class="kw">mean</span>(z),</a>
<a class="sourceLine" id="cb58-7" title="7">               <span class="kw">mean</span>(z) <span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(z))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">moderator =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;average&quot;</span>, <span class="st">&quot;high&quot;</span>), <span class="kw">nrow</span>(.)<span class="op">/</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb58-9" title="9"></a>
<a class="sourceLine" id="cb58-10" title="10"><span class="co"># predictions for the three levels of the moderator </span></a>
<a class="sourceLine" id="cb58-11" title="11">df.prediction =<span class="st"> </span>fit.moderation <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-12" title="12"><span class="st">  </span><span class="kw">augment</span>(<span class="dt">newdata =</span> df.newdata) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-13" title="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">moderator =</span> <span class="kw">factor</span>(moderator, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;high&quot;</span>, <span class="st">&quot;average&quot;</span>, <span class="st">&quot;low&quot;</span>)))</a>
<a class="sourceLine" id="cb58-14" title="14"></a>
<a class="sourceLine" id="cb58-15" title="15"><span class="co"># visualize the result </span></a>
<a class="sourceLine" id="cb58-16" title="16">df.moderation <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-17" title="17"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x,</a>
<a class="sourceLine" id="cb58-18" title="18">             <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-19" title="19"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-20" title="20"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df.prediction,</a>
<a class="sourceLine" id="cb58-21" title="21">            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> .fitted,</a>
<a class="sourceLine" id="cb58-22" title="22">                          <span class="dt">group =</span> moderator,</a>
<a class="sourceLine" id="cb58-23" title="23">                          <span class="dt">color =</span> moderator),</a>
<a class="sourceLine" id="cb58-24" title="24">            <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-25" title="25"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;hours of sleep (z-scored)&quot;</span>,</a>
<a class="sourceLine" id="cb58-26" title="26">       <span class="dt">y =</span> <span class="st">&quot;attention paid&quot;</span>,</a>
<a class="sourceLine" id="cb58-27" title="27">       <span class="dt">color =</span> <span class="st">&quot;coffee consumed&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-28" title="28"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)</a></code></pre></div>
<p><img src="psych252_files/figure-html/mediation-moderation-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">df.prediction <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="st">  </span><span class="kw">head</span>(<span class="dv">9</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="st">  </span><span class="kw">kable</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</a>
<a class="sourceLine" id="cb59-5" title="5">              <span class="dt">full_width =</span> F)</a></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
z
</th>
<th style="text-align:left;">
moderator
</th>
<th style="text-align:right;">
.fitted
</th>
<th style="text-align:right;">
.se.fit
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-1.83
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
18.58
</td>
<td style="text-align:right;">
3.75
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.83
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
average
</td>
<td style="text-align:right;">
15.80
</td>
<td style="text-align:right;">
2.51
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.83
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
13.02
</td>
<td style="text-align:right;">
2.99
</td>
</tr>
<tr>
<td style="text-align:right;">
2.41
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
68.52
</td>
<td style="text-align:right;">
4.32
</td>
</tr>
<tr>
<td style="text-align:right;">
2.41
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
average
</td>
<td style="text-align:right;">
91.60
</td>
<td style="text-align:right;">
3.09
</td>
</tr>
<tr>
<td style="text-align:right;">
2.41
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
114.68
</td>
<td style="text-align:right;">
4.12
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="additional-resources-12" class="section level2">
<h2><span class="header-section-number">15.7</span> Additional resources</h2>
<div id="books" class="section level3">
<h3><span class="header-section-number">15.7.1</span> Books</h3>
<ul>
<li><a href="https://www.guilford.com/books/Introduction-to-Mediation-Moderation-and-Conditional-Process-Analysis/Andrew-Hayes/9781462534654">Introduction to Mediation, Moderation, and Conditional Process Analysis (Second Edition): A Regression-Based Approach</a>
<ul>
<li><a href="https://bookdown.org/connect/#/apps/1523/access">Recoded with BRMS and Tidyverse</a></li>
</ul></li>
</ul>
</div>
<div id="tutorials-2" class="section level3">
<h3><span class="header-section-number">15.7.2</span> Tutorials</h3>
<ul>
<li><a href="https://ademos.people.uic.edu/Chapter14.html">R tutorial on mediation and moderation</a></li>
<li><a href="https://ademos.people.uic.edu/Chapter15.html">R tutorial on moderated mediation</a></li>
<li><a href="http://www.imachordata.com/bayesian-sem-with-brms/">Path analysis with brms</a></li>
<li><a href="http://web.mit.edu/jmn/www/6.034/d-separation.pdf">Understanding d-separation</a></li>
</ul>
</div>
<div id="misc-8" class="section level3">
<h3><span class="header-section-number">15.7.3</span> Misc</h3>
<ul>
<li><a href="http://causality.cs.ucla.edu/blog/index.php/2019/08/14/a-crash-course-in-good-and-bad-control/">Judea Pearl on good, bad, and neutral controls</a></li>
<li><a href="http://babieslearninglanguage.blogspot.com/2019/10/confounds-and-covariates.html">Mike Frank on covariates vs. confounds</a></li>
</ul>
</div>
</div>
<div id="session-info-13" class="section level2">
<h2><span class="header-section-number">15.8</span> Session info</h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Mojave 10.14.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] forcats_0.5.0     stringr_1.4.0     dplyr_0.8.4       purrr_0.3.3      
##  [5] readr_1.3.1       tidyr_1.0.2       tibble_2.1.3      ggplot2_3.3.0    
##  [9] tidyverse_1.3.0   rsvg_1.3          DiagrammeRsvg_0.1 DiagrammeR_1.0.5 
## [13] broom_0.5.5       multilevel_2.6    nlme_3.1-145      mediation_4.5.0  
## [17] sandwich_2.5-1    mvtnorm_1.1-0     Matrix_1.2-18     MASS_7.3-51.5    
## [21] janitor_1.2.1     kableExtra_1.1.0  knitr_1.28       
## 
## loaded via a namespace (and not attached):
##  [1] fs_1.3.2            lubridate_1.7.4     webshot_0.5.2      
##  [4] RColorBrewer_1.1-2  httr_1.4.1          tools_3.6.2        
##  [7] backports_1.1.5     utf8_1.1.4          R6_2.4.1           
## [10] rpart_4.1-15        Hmisc_4.3-1         DBI_1.1.0          
## [13] colorspace_1.4-1    nnet_7.3-13         withr_2.1.2        
## [16] tidyselect_1.0.0    gridExtra_2.3       curl_4.3           
## [19] compiler_3.6.2      cli_2.0.2           rvest_0.3.5        
## [22] htmlTable_1.13.3    xml2_1.2.2          labeling_0.3       
## [25] bookdown_0.18       scales_1.1.0        checkmate_2.0.0    
## [28] digest_0.6.25       foreign_0.8-76      minqa_1.2.4        
## [31] rmarkdown_2.1       base64enc_0.1-3     jpeg_0.1-8.1       
## [34] pkgconfig_2.0.3     htmltools_0.4.0     lme4_1.1-21        
## [37] highr_0.8           dbplyr_1.4.2        htmlwidgets_1.5.1  
## [40] rlang_0.4.5         readxl_1.3.1        rstudioapi_0.11    
## [43] farver_2.0.3        visNetwork_2.0.9    generics_0.0.2     
## [46] zoo_1.8-7           jsonlite_1.6.1      acepack_1.4.1      
## [49] magrittr_1.5        Formula_1.2-3       fansi_0.4.1        
## [52] Rcpp_1.0.3          munsell_0.5.0       lifecycle_0.1.0    
## [55] stringi_1.4.6       yaml_2.2.1          grid_3.6.2         
## [58] crayon_1.3.4        lattice_0.20-40     haven_2.2.0        
## [61] splines_3.6.2       hms_0.5.3           pillar_1.4.3       
## [64] boot_1.3-24         lpSolve_5.6.15      reprex_0.3.0       
## [67] glue_1.3.1          evaluate_0.14       V8_3.0.1           
## [70] latticeExtra_0.6-29 data.table_1.12.8   modelr_0.1.6       
## [73] png_0.1-7           vctrs_0.2.3         nloptr_1.2.1       
## [76] cellranger_1.1.0    gtable_0.3.0        assertthat_0.2.1   
## [79] xfun_0.12           survival_3.1-8      viridisLite_0.3.0  
## [82] cluster_2.1.0</code></pre>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-baron1986moderator">
<p>Baron, Reuben M, and David A Kenny. 1986. “The Moderator–Mediator Variable Distinction in Social Psychological Research: Conceptual, Strategic, and Statistical Considerations.” <em>Journal of Personality and Social Psychology</em> 51 (6): 1173–82.</p>
</div>
<div id="ref-fiedler2011mediation">
<p>Fiedler, Klaus, Malte Schott, and Thorsten Meiser. 2011. “What Mediation Analysis Can (Not) Do.” <em>Journal of Experimental Social Psychology</em> 47 (6): 1231–6.</p>
</div>
<div id="ref-mackinnon2007mediationa">
<p>MacKinnon, David P., Amanda J. Fairchild, and Matthew S. Fritz. 2007. “Mediation Analysis.” <em>Annual Review of Psychology</em> 58 (1): 593–614. <a href="https://doi.org/10.1146/annurev.psych.58.110405.085542">https://doi.org/10.1146/annurev.psych.58.110405.085542</a>.</p>
</div>
<div id="ref-preacher2004spss">
<p>Preacher, Kristopher J, and Andrew F Hayes. 2004. “SPSS and Sas Procedures for Estimating Indirect Effects in Simple Mediation Models.” <em>Behavior Research Methods, Instruments &amp; Computers</em> 36 (4): 717–31.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="power-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-comparison.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/15-mediation_moderation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
